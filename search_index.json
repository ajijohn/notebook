[
["journal.html", "Chapter 8 Journal 8.1 4-12-2018 8.2 4-13-2018 8.3 4-20-2008 8.4 4-23-2008 8.5 4-29-2008 8.6 5-21-2018 8.7 7-26-2018 8.8 8-7-2018 8.9 8-17-2018 8.10 8-23-2018 8.11 8-24-2018 8.12 9-23-2018 8.13 10-1-2018 8.14 Next steps 8.15 10-2-2018 8.16 10-17-2018 8.17 Open to-dos 8.18 10-04-2018 8.19 11-04-2018 8.20 11-19-2018 8.21 12-17-2018 8.22 12-21-2018 8.23 1-3-2019 8.24 1-9-2019 8.25 1-10-2019 8.26 1-11-2019 8.27 1-12-2019 8.28 1-15-2019 8.29 1-16-2019 8.30 1-17-2019 8.31 1-24-2019 8.32 1-29-2019 8.33 2-03-2019 8.34 2-04-2019 8.35 2-05-2019 8.36 2-23-2019 8.37 2-26-2019 8.38 2-27-2019 8.39 3-1-2019 8.40 3-3-2019 8.41 3-9-2019 8.42 3-10-2019 8.43 3-12-2019 8.44 3-21-2019", " Chapter 8 Journal Daily lab notes library(ggplot2) ## Registered S3 methods overwritten by &#39;ggplot2&#39;: ## method from ## [.quosures rlang ## c.quosures rlang ## print.quosures rlang library(tidyverse) ## ── Attaching packages ───────────────────────────────────────────────────────────────────────────── tidyverse 1.2.1 ── ## ✔ tibble 2.1.1 ✔ purrr 0.3.2 ## ✔ tidyr 0.8.3 ✔ dplyr 0.8.1 ## ✔ readr 1.3.1 ✔ stringr 1.4.0 ## ✔ tibble 2.1.1 ✔ forcats 0.4.0 ## ── Conflicts ──────────────────────────────────────────────────────────────────────────────── tidyverse_conflicts() ── ## ✖ dplyr::filter() masks stats::filter() ## ✖ dplyr::lag() masks stats::lag() library(lubridate) ## ## Attaching package: &#39;lubridate&#39; ## The following object is masked from &#39;package:base&#39;: ## ## date library(sp) library(leaflet) library(plotly) ## ## Attaching package: &#39;plotly&#39; ## The following object is masked from &#39;package:ggplot2&#39;: ## ## last_plot ## The following object is masked from &#39;package:stats&#39;: ## ## filter ## The following object is masked from &#39;package:graphics&#39;: ## ## layout library(scales) ## ## Attaching package: &#39;scales&#39; ## The following object is masked from &#39;package:purrr&#39;: ## ## discard ## The following object is masked from &#39;package:readr&#39;: ## ## col_factor library(ggpubr) ## Loading required package: magrittr ## ## Attaching package: &#39;magrittr&#39; ## The following object is masked from &#39;package:purrr&#39;: ## ## set_names ## The following object is masked from &#39;package:tidyr&#39;: ## ## extract 8.1 4-12-2018 8.1.1 ekoseminar Urban ecosystems are undergoing evolution at a much faster pace than one would imagine. Thinking about mutation which introduce allele frequency key to heritable diversity ? 8.1.2 meeting with jhrl Certain species do flower early - confirmed by JHRL. The poster we presented does make sense. 8.1.3 ekoclimate The energy budget of the area increases if the type of the cover changes, i.e if it changes from deciduous forest to crop/grassland then the net Long Wave radiation(flux?) increases. Long wave is the one that is reflected, so the area with a grass will absorb more heat through the day , and emilt radiation during the night? (More cooling ?). So, should we see more diurnal variation in crop/grasslands than forests ?. How should one charaterize the total energy flux on grasslands vs forests? Shortware is the incoming radiation - i.e having a shorter wavelength, and when is reflected, it becomes long wave radiation. The longwave radiation emitted out is calculated by multipying Stephan Boltzman constant multiplied by epsilion(emissivity) and Temperature^4(Temperature of the object). 8.1.4 trenchR Thermal conductance wrt to animals define the amount of heat which can escape out of animals. It depends on the difference between the animal and the outside temperature and you multipy by the thickness(lambda) and a proportion of the surface area(true area exposed to solar radiation). Surace area to calculate the exposure is related to the exposed area - tricky as animals come in all shapes, mostly cylindrical with a sphere head if land based. 8.2 4-13-2018 8.3 4-20-2008 Heat transfer coefficient for Lizards. It is linear with windspeeed, and slope changes when the lizard is parallel or transverse 8.4 4-23-2008 Get diurnal variation across 5 sites at Mt Rainier #Load a file Paradise_2017&lt;- read.csv(&#39;./data/ParadiseWind_5380_feet_2017.csv&#39;) CampMuir_2017&lt;- read.csv(&#39;./data/CampMuir_10110_feet_2017.csv&#39;) Sunriseupper_2017&lt;- read.csv(&#39;./data/SunriseUpper_6880_feet_2017.csv&#39;) Paradise_2017$date &lt;- as.Date(Paradise_2017$Date.Time..PST., &quot;%Y-%m-%d&quot;) Paradise_2017$datect &lt;-as.POSIXct(Paradise_2017$Date.Time..PST., &quot;%Y-%m-%d %H:%M&quot;,tz = &quot;America/Los_Angeles&quot;) #MtRainier_AE10A1_1718$timect &lt;- as.POSIXct(MtRainier_AE10A1_1718$datetime, format=&quot;%m/%d/%y #%I:%M:%S %p&quot;,tz=&quot;America/Los_Angeles&quot;) Paradise_2017$hr &lt;-strftime(Paradise_2017$Date.Time..PST.,&#39;%H&#39;) Paradise_2017$min &lt;-strftime(Paradise_2017$Date.Time..PST.,&#39;%M&#39;) Paradise_2017$month &lt;- strftime(Paradise_2017$Date.Time..PST.,&#39;%m&#39;) Paradise_2017$monthasn &lt;- as.numeric(Paradise_2017$month) Paradise_2017$day &lt;- day(Paradise_2017$datect) Paradise_2017$year &lt;- year(Paradise_2017$datect) Paradise_2017$hour &lt;- hour(Paradise_2017$datect) CampMuir_2017$date &lt;- as.Date(CampMuir_2017$Date.Time..PST., &quot;%Y-%m-%d&quot;) CampMuir_2017$hr &lt;-strftime(CampMuir_2017$Date.Time..PST.,&#39;%H&#39;) CampMuir_2017$min &lt;-strftime(CampMuir_2017$Date.Time..PST.,&#39;%M&#39;) CampMuir_2017$month &lt;-strftime(CampMuir_2017$Date.Time..PST.,&#39;%m&#39;) Sunriseupper_2017$date &lt;- as.Date(Sunriseupper_2017$Date.Time..PST., &quot;%Y-%m-%d&quot;) Sunriseupper_2017$hr &lt;-strftime(Sunriseupper_2017$Date.Time..PST.,&#39;%H&#39;) Sunriseupper_2017$min &lt;-strftime(Sunriseupper_2017$Date.Time..PST.,&#39;%M&#39;) Sunriseupper_2017$month &lt;- strftime(Sunriseupper_2017$Date.Time..PST.,&#39;%m&#39;) str(Paradise_2017) ## &#39;data.frame&#39;: 8760 obs. of 16 variables: ## $ Date.Time..PST. : Factor w/ 8760 levels &quot;2017-01-01 00:00&quot;,..: 8760 8759 8758 8757 8756 8755 8754 8753 8752 8751 ... ## $ Battery.Voltage..v. : num 13 13 12.4 12.9 12.9 ... ## $ Wind.Speed.Minimum..mph.: num 0 0 0 0.71 1.42 2.13 0 0 0 0.71 ... ## $ Wind.Speed.Average..mph.: num 1.68 1.68 1.6 2.23 2.76 ... ## $ Wind.Speed.Maximum..mph.: num 3.55 3.55 3.55 3.55 3.55 4.26 3.55 3.55 4.26 6.39 ... ## $ Wind.Direction..deg.. : num 21.04 6.89 19.41 26.65 16.74 ... ## $ Solar.Pyranometer..W.m2.: num 0 0 0 0 0 ... ## $ date : Date, format: &quot;2017-12-31&quot; &quot;2017-12-31&quot; ... ## $ datect : POSIXct, format: &quot;2017-12-31 23:00:00&quot; &quot;2017-12-31 22:00:00&quot; ... ## $ hr : chr &quot;00&quot; &quot;00&quot; &quot;00&quot; &quot;00&quot; ... ## $ min : chr &quot;00&quot; &quot;00&quot; &quot;00&quot; &quot;00&quot; ... ## $ month : chr &quot;12&quot; &quot;12&quot; &quot;12&quot; &quot;12&quot; ... ## $ monthasn : num 12 12 12 12 12 12 12 12 12 12 ... ## $ day : int 31 31 31 31 31 31 31 31 31 31 ... ## $ year : num 2017 2017 2017 2017 2017 ... ## $ hour : int 23 22 21 20 19 18 17 16 15 14 ... Paradise_2017 %&gt;% ggplot(aes(date,Solar.Pyranometer..W.m2.)) +geom_point() + stat_smooth(se = TRUE) + ggtitle(&quot;Solar Radiation at Paradise(5380 ft)&quot;)+ xlab(&quot;Date&quot;) + ylab(&quot;Solar Irradiance(W/m^2)&quot;) ## `geom_smooth()` using method = &#39;gam&#39; and formula &#39;y ~ s(x, bs = &quot;cs&quot;)&#39; CampMuir_2017 %&gt;% ggplot(aes(date,Solar.Pyranometer..W.m2.)) + geom_point() + stat_smooth(se = TRUE) + ggtitle(&quot;Solar Radiation at CampMuir(10110 ft)&quot;)+ xlab(&quot;Date&quot;) + ylab(&quot;Solar Irradiance(W/m^2)&quot;) ## `geom_smooth()` using method = &#39;gam&#39; and formula &#39;y ~ s(x, bs = &quot;cs&quot;)&#39; Sunriseupper_2017 %&gt;% ggplot(aes(date,Solar.Pyranometer..W.m2.)) + geom_point() + stat_smooth(se = TRUE) + ggtitle(&quot;Solar Radiation at Sunrise-Upper(6880 ft)&quot;)+ xlab(&quot;Date&quot;) + ylab(&quot;Solar Irradiance(W/m^2)&quot;) ## `geom_smooth()` using method = &#39;gam&#39; and formula &#39;y ~ s(x, bs = &quot;cs&quot;)&#39; Feedback Better to do it houry so that daily patterns do confound it. So, now we have hourly solar radiation across all the sites. ## 4-28-2008 # ggplot(Paradise_2017, aes(hr,Solar.Pyranometer..W.m2.))+ stat_boxplot( aes(hr,Solar.Pyranometer..W.m2.), geom=&#39;errorbar&#39;, linetype=1, width=0.5)+ #whiskers geom_boxplot( aes(hr,Solar.Pyranometer..W.m2.),outlier.shape=1) + stat_summary(fun.y=mean, geom=&quot;point&quot;, size=2) + stat_summary(fun.data = mean_se, geom = &quot;errorbar&quot;) annotate(&quot;text&quot;,x=20,y=55,label=&quot;wassup!&quot; , family=&quot;xkcd&quot; ) ## mapping: x = ~x, y = ~y ## geom_text: na.rm = FALSE ## stat_identity: na.rm = FALSE ## position_identity ## 4-28-2008 # ggplot(CampMuir_2017, aes(hr,Solar.Pyranometer..W.m2.))+ stat_boxplot( aes(hr,Solar.Pyranometer..W.m2.), geom=&#39;errorbar&#39;, linetype=1, width=0.5)+ #whiskers geom_boxplot( aes(hr,Solar.Pyranometer..W.m2.),outlier.shape=1) + stat_summary(fun.y=mean, geom=&quot;point&quot;, size=2) + stat_summary(fun.data = mean_se, geom = &quot;errorbar&quot;) It does confirm that higher the sites, the solar radiation is slightly higher. 8.5 4-29-2008 Lets assume that solar radiation is infact more relevant at higher elevations, so snowmelt would be at a faster rate at higher elevations. Is snowmelt even at all the elevations ? Intuitively no as we often see that peaks hold-on to snow longer. (Just aside discussion). Here, the goal is to see if there is a difference in radiation recieved at the sites. Reasoning being if the solar radiation recorded is different, that would mean differemt growing degree days. Lets look for June, July and August(JJA Summer). Summer solstice - June 21st. ## 4-29-2008 library(gridExtra) ## ## Attaching package: &#39;gridExtra&#39; ## The following object is masked from &#39;package:dplyr&#39;: ## ## combine # g1 &lt;- Paradise_2017 %&gt;% filter(month %in% c(&#39;06&#39;,&#39;07&#39;,&#39;08&#39;)) %&gt;% ggplot( aes(hr,Solar.Pyranometer..W.m2.)) + geom_boxplot() + stat_summary(colour = &quot;red&quot;,size=0.5) + theme_classic() +theme(axis.text.x = element_text(angle = 90, hjust = 1)) + xlab(&quot;Hour&quot;) + ggtitle(&quot;Paradise(5k ft) &quot;) g2 &lt;- CampMuir_2017 %&gt;% filter(month %in% c(&#39;06&#39;,&#39;07&#39;,&#39;08&#39;)) %&gt;% ggplot( aes(hr,Solar.Pyranometer..W.m2.)) + geom_boxplot() + stat_summary(colour = &quot;red&quot;,size=0.5) + theme_classic() +theme(axis.text.x = element_text(angle = 90, hjust = 1)) + xlab(&quot;Hour&quot;) + ggtitle(&quot;Camp Muir(10k ft) &quot;) grid.arrange(g1, g2,ncol=2, top = &quot;JJA - Mean Hourly Solar Radiation at 2 elevations&quot;) ## No summary function supplied, defaulting to `mean_se() ## No summary function supplied, defaulting to `mean_se() ## 4-29-2008 library(gridExtra) # g3 &lt;- Paradise_2017 %&gt;% filter(month %in% c(&#39;06&#39;)) %&gt;% ggplot( aes(hr,Solar.Pyranometer..W.m2.)) + geom_boxplot() + theme_classic() +theme(axis.text.x = element_text(angle = 90, hjust = 1)) + xlab(&quot;Hour&quot;) + ggtitle(&quot;Paradise(5k ft) &quot;) g4 &lt;- CampMuir_2017 %&gt;% filter(month %in% c(&#39;06&#39;)) %&gt;% ggplot( aes(hr,Solar.Pyranometer..W.m2.)) + geom_boxplot() + theme_classic() +theme(axis.text.x = element_text(angle = 90, hjust = 1)) + xlab(&quot;Hour&quot;) + ggtitle(&quot;Camp Muir(10k ft) &quot;) grid.arrange(g3, g4,ncol=2, top = &quot;June - Max Hourly Solar Radiation at 2 elevations&quot;) #ggplotly() Lets check the daily max for each day in summer(JJA) ## 4-29-2008 library(gridExtra) # g5 &lt;- Paradise_2017 %&gt;% filter(month %in% c(&#39;06&#39;,&#39;07&#39;,&#39;08&#39;)) %&gt;% dplyr::group_by(date) %&gt;% dplyr::summarise(maxSol = max(Solar.Pyranometer..W.m2.)) %&gt;% ggplot( aes(date,maxSol)) + geom_point() + geom_line() + theme_classic() +theme(axis.text.x = element_text(angle = 90, hjust = 1)) + xlab(&quot;Date&quot;) + ggtitle(&quot;Paradise(5k ft) &quot;) g6 &lt;- CampMuir_2017 %&gt;% filter(month %in% c(&#39;06&#39;,&#39;07&#39;,&#39;08&#39;)) %&gt;% dplyr::group_by(date) %&gt;% dplyr::summarise(maxSol = max(Solar.Pyranometer..W.m2.)) %&gt;% ggplot( aes(date,maxSol)) + geom_point() + geom_line() + theme_classic() +theme(axis.text.x = element_text(angle = 90, hjust = 1)) + xlab(&quot;Date&quot;) + ggtitle(&quot;Camp Muir(10k ft) &quot;) grid.arrange(g5, g6,ncol=2, top = &quot;JJA - Daily Max Solar Radiation at 2 elevations&quot;) #ggplotly() Compare wind and solar at two sites ## 4-29-2008 library(gridExtra) # g5 &lt;- Paradise_2017 %&gt;% filter(month %in% c(&#39;06&#39;,&#39;07&#39;,&#39;08&#39;)) %&gt;% dplyr::group_by(date) %&gt;% dplyr::summarise(maxSol = max(Solar.Pyranometer..W.m2.),maxWind = max(Wind.Speed.Average..mph.)) %&gt;% ggplot() + geom_line(aes(date,log(maxSol),color=&#39;log Solar(W/m^2)&#39;) ) + geom_line(aes(date,maxWind,color=&#39;Wind(m/h)&#39;)) + theme_classic() +theme(axis.text.x = element_text(angle = 90, hjust = 1)) + xlab(&quot;Date&quot;) + ylab(&quot;&quot;) + ggtitle(&quot;Paradise(5k ft) &quot;) + scale_color_discrete(name=&quot;Variable&quot;) g6 &lt;- CampMuir_2017 %&gt;% filter(month %in% c(&#39;06&#39;,&#39;07&#39;,&#39;08&#39;)) %&gt;% dplyr::group_by(date) %&gt;% dplyr::summarise(maxSol = max(Solar.Pyranometer..W.m2.),maxWind = max(Wind.Speed.Average..mph.)) %&gt;% ggplot() + geom_line(aes(date,log(maxSol),color=&#39;log Solar(W/m^2)&#39;) ) + geom_line(aes(date,maxWind,color=&#39;Wind(m/h)&#39;)) + theme_classic() +theme(axis.text.x = element_text(angle = 90, hjust = 1)) + xlab(&quot;Date&quot;) + ylab(&quot;&quot;) + ggtitle(&quot;Camp Muir(10k ft) &quot;) + scale_color_discrete(name=&quot;Variable&quot;) grid.arrange(g5, g6,ncol=2, top = &quot;JJA - Daily Max Solar and Max Wind(Avg) at 2 elevations&quot;) #ggplotly() 8.6 5-21-2018 Wrangle the microclimate data ## 5-21-2018 mclim_2018&lt;- read.csv(&#39;./data/DATALOG.5.15.2018.csv&#39;) #ggplotly() Look at the data ## 5-21-2018 str(mclim_2018) ## &#39;data.frame&#39;: 326489 obs. of 4 variables: ## $ X2018.5.8.16.35.01: Factor w/ 73277 levels &quot;2018/5/10 0:00:03&quot;,..: 60336 60336 60336 60336 60336 60337 60338 60338 60338 60338 ... ## $ X28CF6F0400008059 : Factor w/ 6 levels &quot;287F5B04000080C5&quot;,..: 1 5 6 4 3 2 1 5 6 4 ... ## $ X14.31 : num 14.8 14.4 14.8 14.3 14.1 ... ## $ X4.14 : num 4.14 4.14 4.14 4.14 4.14 4.14 4.14 4.14 4.14 4.14 ... names(mclim_2018) &lt;- c(&#39;time&#39;,&#39;nodeid&#39;,&#39;temp&#39;,&#39;batt&#39;) mclim_2018$time &lt;- as.POSIXct(mclim_2018$time, &quot;%Y/%m/%d %H:%M:%S&quot;) Add Hour, month and day ## 5-21-2018 mclim_2018$hr &lt;- hour(mclim_2018$time) mclim_2018$day &lt;- day(mclim_2018$time) mclim_2018$month&lt;- month(mclim_2018$time) Basic plot (May 10th) ## 5-21-2018 mclim_2018 %&gt;% filter(day(time) %in% &#39;10&#39;) %&gt;% ggplot( aes(time,temp,color = nodeid)) + geom_line() + theme_minimal() #ggplotly() Whole week ## 5-21-2018 mclim_2018 %&gt;% ggplot( aes(time,temp,color = nodeid)) + geom_line() #ggplotly() Add heights (Roghly .25 m apart) mclim_2018$height &lt;- 0 mclim_2018[mclim_2018$nodeid==&#39;28FF80E24316043F&#39; ,]$height &lt;- 0.25 mclim_2018[mclim_2018$nodeid==&#39;28FF7331441603A7&#39; ,]$height &lt;- 0.5 mclim_2018[mclim_2018$nodeid==&#39;287F5B04000080C5&#39; ,]$height &lt;- 0.75 mclim_2018[mclim_2018$nodeid==&#39;28FFB1C2501604A8&#39; ,]$height &lt;- 1 mclim_2018[mclim_2018$nodeid==&#39;28CF6F0400008059&#39; ,]$height &lt;-1.25 mclim_2018[mclim_2018$nodeid==&#39;28FF5B69501604F2&#39; ,]$height &lt;- 1.5 Basic plot (May 10th) - By height ## 5-21-2018 mclim_2018 %&gt;% filter(day(time) %in% &#39;10&#39;) %&gt;% ggplot( aes(time,temp,color = factor(height))) + geom_line() + theme_minimal() #ggplotly() Add simulated wind profile mclim_2018$ws &lt;- 0 mclim_2018[mclim_2018$nodeid==&#39;287F5B04000080C5&#39;,]$ws &lt;- 4.34 mclim_2018[mclim_2018$nodeid==&#39;28FF80E24316043F&#39; ,]$ws &lt;- 2.02 mclim_2018[mclim_2018$nodeid==&#39;28FFB1C2501604A8&#39; ,]$ws &lt;- 5.20 mclim_2018[mclim_2018$nodeid==&#39;28FF7331441603A7&#39; ,]$ws &lt;- 3.45 mclim_2018[mclim_2018$nodeid==&#39;28FF5B69501604F2&#39; ,]$ws &lt;- 7.56 mclim_2018[mclim_2018$nodeid==&#39;28CF6F0400008059&#39; ,]$ws &lt;-6.54 Redo the plot by height ## 5-21-2018 mclim_2018 %&gt;% filter(day(time) %in% &#39;10&#39;, height %in% c(0.25,1)) %&gt;% ggplot( aes(time,temp,color = factor(height))) + geom_line() + theme_minimal() Redo the plot by height for Wind Speed ## 5-21-2018 mclim_2018 %&gt;% filter(day(time) %in% &#39;10&#39;, height %in% c(0.25,0.5,0.75,1)) %&gt;% ggplot( aes(time,ws,color = factor(height))) + geom_line() + theme_minimal() Calculate (Wind speed at any height = U_star/K*log(Z/Z0)) Calculate zero plane displcement #TODO - Do by each hour zeroDM&lt;- lm(log(mclim_2018$height) ~ mclim_2018$ws) zD &lt;- exp(zeroDM$coeff[1]) #.16 Calculate roughness and Z* #With zero plane dispacement sRM&lt;- lm(mclim_2018$ws ~ log(mclim_2018$height-zD)) srIntercept &lt;- sRM$coeff[1] srSlope &lt;- sRM$coeff[2] K=0.4 # Von Karman constant z0&lt;- exp(-srIntercept/srSlope) #0.04 U_star&lt;- srSlope*K Repeat this for each site ## 7-21-2018 #With zero plane dispacement library(rgdal) #this package is necessary to import the .asc file in R. ## rgdal: version: 1.4-3, (SVN revision 828) ## Geospatial Data Abstraction Library extensions to R successfully loaded ## Loaded GDAL runtime: GDAL 2.1.3, released 2017/20/01 ## Path to GDAL shared files: /Library/Frameworks/R.framework/Versions/3.6/Resources/library/rgdal/gdal ## GDAL binary built with GEOS: FALSE ## Loaded PROJ.4 runtime: Rel. 4.9.3, 15 August 2016, [PJ_VERSION: 493] ## Path to PROJ.4 shared files: /Library/Frameworks/R.framework/Versions/3.6/Resources/library/rgdal/proj ## Linking to sp version: 1.3-1 library(rasterVis) #this package has the function which allows the 3D plotting. ## Loading required package: raster ## ## Attaching package: &#39;raster&#39; ## The following object is masked from &#39;package:ggpubr&#39;: ## ## rotate ## The following object is masked from &#39;package:magrittr&#39;: ## ## extract ## The following object is masked from &#39;package:plotly&#39;: ## ## select ## The following object is masked from &#39;package:dplyr&#39;: ## ## select ## The following object is masked from &#39;package:tidyr&#39;: ## ## extract ## Loading required package: lattice ## Loading required package: latticeExtra ## Loading required package: RColorBrewer ## ## Attaching package: &#39;latticeExtra&#39; ## The following object is masked from &#39;package:ggplot2&#39;: ## ## layer #set the path where the file is, and import it into R. r= raster(paste(&quot;./data/rainier_2012_dtm_5_hs.tif&quot;, sep=&quot;&quot;)) #visualize the raster in 3D plot(r,lit=TRUE) Combining multiple rasters into one single file. fs &lt;- list.files(path=&quot;./data&quot;, pattern = &quot;rainier_2007_*&quot;, full.names = TRUE) library(raster) r1 &lt;- raster(fs[1]) r2 &lt;- raster(fs[2]) r3 &lt;- raster(fs[3]) r4 &lt;- raster(fs[4]) r5 &lt;- raster(fs[5]) r6 &lt;- raster(fs[6]) r7 &lt;- raster(fs[7]) r8 &lt;- raster(fs[8]) r9 &lt;- raster(fs[9]) r10 &lt;- raster(fs[10]) r11 &lt;- raster(fs[11]) r12 &lt;- raster(fs[12]) r13 &lt;- raster(fs[13]) r14 &lt;- raster(fs[14]) r15 &lt;- raster(fs[15]) r16 &lt;- raster(fs[16]) r17 &lt;- raster(fs[17]) # if you have a list of Raster objects, you can use do.call x &lt;- list(r1, r2, r3,r4,r5,r6,r7,r8,r9,r10,r11,r12,r13,r14,r15,r16,r17) names(x)[1:2] &lt;- c(&#39;x&#39;, &#39;y&#39;) x$fun &lt;- mean x$na.rm &lt;- TRUE #y &lt;- do.call(mosaic, x) #writeRaster(y, &quot;./data/combined_mtr.TIF&quot;) ##7-25-2018 Check the diurnal variation for summer, using Paradise as a proxy Paradise_2017 %&gt;% group_by(date,month,hr) %&gt;% ggplot(aes(month,Solar.Pyranometer..W.m2.)) + geom_point() #.16 Use SNOTEL data from Paradise(Latitude: 46.78 Longitude: -121.74) Check the diurnal variation for summer, using Paradise as a proxy Paradise_Snotel_2013&lt;- read.csv(&#39;./data/679_STAND_WATERYEAR=2013.csv&#39;) Paradise_Snotel_2013$date &lt;- as.Date(Paradise_Snotel_2013$Date, &quot;%Y-%m-%d&quot;) Paradise_Snotel_2013$month &lt;- strftime(Paradise_Snotel_2013$Date,&#39;%m&#39;) Paradise_Snotel_2012&lt;- read.csv(&#39;./data/679_STAND_WATERYEAR=2012.csv&#39;) Paradise_Snotel_2012$date &lt;- as.Date(Paradise_Snotel_2012$Date, &quot;%Y-%m-%d&quot;) Paradise_Snotel_2012$month &lt;- strftime(Paradise_Snotel_2012$Date,&#39;%m&#39;) Paradise_Snotel_2011&lt;- read.csv(&#39;./data/679_STAND_WATERYEAR=2011.csv&#39;) Paradise_Snotel_2011$date &lt;- as.Date(Paradise_Snotel_2011$Date, &quot;%Y-%m-%d&quot;) Paradise_Snotel_2011$month &lt;- strftime(Paradise_Snotel_2011$Date,&#39;%m&#39;) Paradise_Snotel_2013 %&gt;% group_by(date,month) %&gt;% mutate(diva=TMAX.D.1..degC.-TMIN.D.1..degC.)%&gt;% ggplot() + geom_line(aes(date,TMIN.D.1..degC.,colour=&#39;min&#39;)) +geom_line(aes(date,TMAX.D.1..degC.,colour=&#39;max&#39;)) +geom_line(aes(date,diva,colour=&#39;diurnal variation&#39;))+ theme_minimal() #.16 Only Summer Paradise_Snotel_2013 %&gt;% group_by(date,month) %&gt;% filter(as.numeric(month) %in% c(6,7,8)) %&gt;% mutate(diva=TMAX.D.1..degC.-TMIN.D.1..degC.)%&gt;% ggplot() + geom_line(aes(date,TMIN.D.1..degC.,colour=&#39;min&#39;)) +geom_line(aes(date,TMAX.D.1..degC.,colour=&#39;max&#39;))+geom_line(aes(date,TAVG.D.1..degC.,colour=&#39;avg&#39;)) +geom_line(aes(date,diva,colour=&#39;diurnal variation&#39;))+ theme_minimal() +xlab(&quot;Date&quot;) + ylab(&quot;&quot;) + ggtitle(&quot;Snotel Paradise - Water year 2013 &quot;) + scale_color_discrete(name=&quot;Metric&quot;) #.16 For 2012 Paradise_Snotel_2012 %&gt;% group_by(date,month) %&gt;% filter(as.numeric(month) %in% c(6,7,8) &amp; TMIN.D.1..degC. != -99.9) %&gt;% mutate(diva=TMAX.D.1..degC.-TMIN.D.1..degC.)%&gt;% ggplot() + geom_line(aes(date,TMIN.D.1..degC.,colour=&#39;min&#39;)) +geom_line(aes(date,TMAX.D.1..degC.,colour=&#39;max&#39;))+geom_line(aes(date,TAVG.D.1..degC.,colour=&#39;avg&#39;)) +geom_line(aes(date,diva,colour=&#39;diurnal variation&#39;))+ theme_minimal() +xlab(&quot;Date&quot;) + ylab(&quot;&quot;) + ggtitle(&quot;Snotel Paradise - Water year 2012 &quot;) + scale_color_discrete(name=&quot;Metric&quot;) #.16 For 2011 Paradise_Snotel_2011 %&gt;% group_by(date,month) %&gt;% filter(as.numeric(month) %in% c(6,7,8)) %&gt;% mutate(diva=TMAX.D.1..degC.-TMIN.D.1..degC.)%&gt;% ggplot() + geom_line(aes(date,TMIN.D.1..degC.,colour=&#39;min&#39;)) +geom_line(aes(date,TMAX.D.1..degC.,colour=&#39;max&#39;))+geom_line(aes(date,TAVG.D.1..degC.,colour=&#39;avg&#39;)) +geom_line(aes(date,diva,colour=&#39;diurnal variation&#39;))+ theme_minimal() +xlab(&quot;Date&quot;) + ylab(&quot;&quot;) + ggtitle(&quot;Snotel Paradise - Water year 2011 &quot;) + scale_color_discrete(name=&quot;Metric&quot;) #.16 8.7 7-26-2018 Lets look at the diurnal variation for three months, need to switch to NWAC as Snotel does not provide hourly breakdown Paradise_5400_2017&lt;- read.csv(&#39;./data/Paradise_5400_feet_2017.csv&#39;) Paradise_5400_2016&lt;- read.csv(&#39;./data/Paradise_5400_feet_2016.csv&#39;) Paradise_5400_2015&lt;- read.csv(&#39;./data/Paradise_5400_feet_2015.csv&#39;) Paradise_5400_2017$date &lt;- as.Date(Paradise_5400_2017$Date.Time..PST., &quot;%Y-%m-%d&quot;) Paradise_5400_2017$datetime &lt;- as.Date(Paradise_5400_2017$Date.Time..PST., &quot;%Y-%m-%d %H:%M&quot;) library(lubridate) library(gridExtra) Paradise_5400_2017$hr &lt;-lubridate::hour(lubridate::as_datetime(Paradise_5400_2017$Date.Time..PST.)) Paradise_5400_2017$year &lt;-lubridate::year(lubridate::as_datetime(Paradise_5400_2017$Date.Time..PST.)) Paradise_5400_2017$mnth &lt;-lubridate::month(lubridate::as_datetime(Paradise_5400_2017$Date.Time..PST.)) Paradise_5400_2017$min &lt;-lubridate::minute(lubridate::as_datetime(Paradise_5400_2017$Date.Time..PST.)) Paradise_5400_2017$month &lt;- strftime(Paradise_5400_2017$Date.Time..PST.,&#39;%m&#39;) Paradise_5400_2017$day &lt;-strftime(Paradise_5400_2017$Date.Time..PST.,&#39;%d&#39;) Paradise9&lt;- Paradise_5400_2017 %&gt;% group_by(date,month,day,hr) %&gt;% filter(as.numeric(month) %in% c(7,8,9) &amp; as.numeric(day) %in% c(9) ) %&gt;% ggplot() + geom_line(aes(as.numeric(hr),Temperature..deg.F.,group=month,color=month)) + theme_minimal() +xlab(&quot;Hour&quot;) + ylab(&quot;Temperature&quot;) + ggtitle(&quot;Paradise 5400 NWAC - Calendar year 2017 - 9th day&quot;) + scale_color_discrete(name=&quot;Month&quot;) Paradise16&lt;- Paradise_5400_2017 %&gt;% group_by(date,month,day,hr) %&gt;% filter(as.numeric(month) %in% c(7,8,9) &amp; as.numeric(day) %in% c(16) ) %&gt;% ggplot() + geom_line(aes(as.numeric(hr),Temperature..deg.F.,group=month,color=month)) + theme_minimal() +xlab(&quot;Hour&quot;) + ylab(&quot;Temperature&quot;) + ggtitle(&quot;Paradise 5400 NWAC - Calendar year 2017 - 16th day&quot;) + scale_color_discrete(name=&quot;Month&quot;) Paradise23&lt;- Paradise_5400_2017 %&gt;% group_by(date,month,day,hr) %&gt;% filter(as.numeric(month) %in% c(7,8,9) &amp; as.numeric(day) %in% c(23) ) %&gt;% ggplot() + geom_line(aes(as.numeric(hr),Temperature..deg.F.,group=month,color=month)) + theme_minimal() +xlab(&quot;Hour&quot;) + ylab(&quot;Temperature&quot;) + ggtitle(&quot;Paradise 5400 NWAC - Calendar year 2017 - 23rd day&quot;) + scale_color_discrete(name=&quot;Month&quot;) grid.arrange(Paradise9,Paradise16,Paradise23) Days overlapping eath other Paradise_5400_2017 %&gt;% group_by(date,month,day,hr) %&gt;% filter(as.numeric(month) %in% c(7,8,9) &amp; as.numeric(day) %in% c(15,16,17,18,19,20) ) %&gt;% ggplot() + geom_point(aes(as.numeric(hr),Temperature..deg.F.,shape=day,group=7,color=month)) + theme_minimal() +xlab(&quot;Hour&quot;) + ylab(&quot;Temperature&quot;) + ggtitle(&quot;Paradise 5400 NWAC - Calendar year 2017 - Days(15-20) &quot;) + scale_color_discrete(name=&quot;Month&quot;) Removing symbols, each line representing different day of the month Paradise_5400_2017 %&gt;% group_by(date,month,day,hr) %&gt;% filter(as.numeric(month) %in% c(7,8,9) &amp; as.numeric(day) %in% c(15,16,17,18,19,20) ) %&gt;% ggplot(aes(x = hr, y = Temperature..deg.F.,color=month)) + geom_line(data = subset(Paradise_5400_2017,month %in% c(&quot;07&quot;) &amp; day %in% c(&quot;15&quot;) ))+ geom_line(data = subset(Paradise_5400_2017,month %in% c(&quot;08&quot;) &amp; day %in% c(&quot;15&quot;) ))+ geom_line(data = subset(Paradise_5400_2017,month %in% c(&quot;09&quot;) &amp; day %in% c(&quot;15&quot;) )) + geom_line(data = subset(Paradise_5400_2017,month %in% c(&quot;07&quot;) &amp; day %in% c(&quot;16&quot;) ))+ geom_line(data = subset(Paradise_5400_2017,month %in% c(&quot;08&quot;) &amp; day %in% c(&quot;16&quot;) ))+ geom_line(data = subset(Paradise_5400_2017,month %in% c(&quot;09&quot;) &amp; day %in% c(&quot;16&quot;) )) + geom_line(data = subset(Paradise_5400_2017,month %in% c(&quot;07&quot;) &amp; day %in% c(&quot;17&quot;) ))+ geom_line(data = subset(Paradise_5400_2017,month %in% c(&quot;08&quot;) &amp; day %in% c(&quot;17&quot;) ))+ geom_line(data = subset(Paradise_5400_2017,month %in% c(&quot;09&quot;) &amp; day %in% c(&quot;17&quot;) )) + geom_line(data = subset(Paradise_5400_2017,month %in% c(&quot;07&quot;) &amp; day %in% c(&quot;18&quot;) ))+ geom_line(data = subset(Paradise_5400_2017,month %in% c(&quot;08&quot;) &amp; day %in% c(&quot;18&quot;) ))+ geom_line(data = subset(Paradise_5400_2017,month %in% c(&quot;09&quot;) &amp; day %in% c(&quot;18&quot;) )) + geom_line(data = subset(Paradise_5400_2017,month %in% c(&quot;07&quot;) &amp; day %in% c(&quot;19&quot;) ))+ geom_line(data = subset(Paradise_5400_2017,month %in% c(&quot;08&quot;) &amp; day %in% c(&quot;19&quot;) ))+ geom_line(data = subset(Paradise_5400_2017,month %in% c(&quot;09&quot;) &amp; day %in% c(&quot;19&quot;) )) + geom_line(data = subset(Paradise_5400_2017,month %in% c(&quot;07&quot;) &amp; day %in% c(&quot;20&quot;) ))+ geom_line(data = subset(Paradise_5400_2017,month %in% c(&quot;08&quot;) &amp; day %in% c(&quot;20&quot;) ))+ geom_line(data = subset(Paradise_5400_2017,month %in% c(&quot;09&quot;) &amp; day %in% c(&quot;20&quot;) )) + theme_minimal() + xlab(&quot;Hour&quot;) + ylab(&quot;Temperature&quot;) + ggtitle(&quot;Paradise 5400 NWAC - Calendar year 2017 - Days(15-18) &quot;) + scale_color_discrete(name=&quot;Month&quot;)+geom_jitter() Removing symbols, point plot Paradise_5400_2017 %&gt;% group_by(date,month,day,hr) %&gt;% filter(as.numeric(month) %in% c(7,8,9) &amp; as.numeric(day) %in% c(15,16,17,18,19,20) ) %&gt;% ggplot(aes(x = hr, y = Temperature..deg.F.,color=month)) + geom_point(data = subset(Paradise_5400_2017,month %in% c(&quot;07&quot;) &amp; day %in% c(&quot;15&quot;,&quot;16&quot;,&quot;17&quot;,&quot;18&quot;,&quot;19&quot;,&quot;20&quot;)))+ geom_point(data = subset(Paradise_5400_2017,month %in% c(&quot;08&quot;) &amp; day %in% c(&quot;15&quot;,&quot;16&quot;,&quot;17&quot;,&quot;18&quot;,&quot;19&quot;,&quot;20&quot;) ))+ geom_point(data = subset(Paradise_5400_2017,month %in% c(&quot;09&quot;) &amp; day %in% c(&quot;15&quot;,&quot;16&quot;,&quot;17&quot;,&quot;18&quot;,&quot;19&quot;,&quot;20&quot;) )) +theme_minimal() +xlab(&quot;Hour&quot;) + ylab(&quot;Temperature&quot;) + ggtitle(&quot;Paradise 5400 NWAC - Calendar year 2017 - Days(15-18) &quot;) + scale_color_discrete(name=&quot;Month&quot;) 8.8 8-7-2018 One of the arguments in the boundary layer relevance is that at different heights temperature profile varies. So, the vertically the temperature variation differs, and that is bound to influence physiology of organisms living in that strata. To highlight the point, we could look at microclimate profiled data Canopy and surface 3 cm vs 103cm Load the required files decombined &lt;- read.csv(&#39;./data/decombined-1981.csv&#39;) library(dplyr) decombined %&gt;% filter(year(datec) %in% c(1981) &amp; month(datec) %in% c(01) &amp; day(datec) &gt; 12 &amp; day(datec) &lt; 20 ) %&gt;% dplyr::group_by(month,day,hr) %&gt;% dplyr::summarise(meanST = mean(Tsurface),meanCT = mean(TAH)) %&gt;% dplyr::group_by(hr) %&gt;% dplyr::summarise(meanST = mean(meanST),meanCT = mean(meanCT)) %&gt;% ggplot() + geom_line(aes(hr,meanST-273.5,color=&#39;Surface&#39;),se=F)+ geom_line(aes(hr,meanCT-273.5,color=&#39;Canopy&#39;),se=F)+ scale_colour_manual(&quot;Temperature at&quot;, breaks = c(&quot;Surface&quot;, &quot;Canopy&quot;), values = c(&quot;blue&quot;,&quot;red&quot;)) + theme_minimal() + ggtitle(&quot;Variation in temperature at different heights&quot;) + xlab(&quot;Hour&quot;) + ylab(&quot;Temperature(C)&quot;) + labs(colour = &quot;Hour&quot;, subtitle=&quot;Microclimate impacts at two different heights&quot;,caption=&quot;Data Source : http://www.microclim.org&quot;) Seasonal temperatures at two heights library(dplyr) decombined %&gt;% filter(year(datec) %in% c(1981) &amp; month(datec) %in% c(06,07,08) ) %&gt;% dplyr::group_by(month,day,hr) %&gt;% dplyr::summarise(meanST = mean(Tsurface),meanCT = mean(TAH)) %&gt;% group_by(hr) %&gt;% dplyr::summarise(meanST = mean(meanST),meanCT = mean(meanCT)) %&gt;% ggplot() + geom_line(aes(hr,meanST-273.5,color=&#39;Surface&#39;),se=F)+ geom_line(aes(hr,meanCT-273.5,color=&#39;Canopy&#39;),se=F)+ scale_colour_manual(&quot;Temperature at&quot;, breaks = c(&quot;Surface&quot;, &quot;Canopy&quot;), values = c(&quot;blue&quot;,&quot;red&quot;)) + theme_minimal() + ggtitle(&quot;Seasonal variation in temperature at different heights&quot;) + xlab(&quot;Hour&quot;) + ylab(&quot;Temperature (°C)&quot;) + labs(colour = &quot;Hour&quot;, subtitle=&quot;Microclimate differences at two different heights&quot;,caption=&quot;Data Source : http://www.microclim.org&quot;) Seasonal difference during peak solar time is phonenomenal, there is almost 10 degree difference. 8.9 8-17-2018 Feedback - Ideal would be to show multiple days plotted on the hourly x-axis to show the variation. Typical weekly summer variation decombined %&gt;% filter(year(datec) %in% c(1981) &amp; month(datec) %in% c(01) &amp; day(datec) &gt; 12 &amp; day(datec) &lt; 20 ) %&gt;% group_by(month,day,hr) %&gt;% ggplot() + geom_line(aes(hr,Tsurface-273.5,group=day,color=&#39;Surface&#39;),se=F)+ geom_line(aes(hr,TAH-273.5,group=day ,color=&#39;Canopy&#39;),se=F)+ scale_colour_manual(&quot;Temperature at&quot;, breaks = c(&quot;Surface&quot;, &quot;Canopy&quot;), values = c(&quot;blue&quot;,&quot;red&quot;)) + theme_minimal() + ggtitle(&quot;Variation in temperature at two different heights&quot;) + xlab(&quot;Hour&quot;) + ylab(&quot;Temperature (°C)&quot;) + labs(colour = &quot;Hour&quot;, subtitle=&quot;1/13/81 - 1/19/81&quot;,caption=&quot;Data Source : http://www.microclim.org&quot;) Seasonal temperatures at two heights decombined %&gt;% filter(year(datec) %in% c(1981) &amp; month(datec) %in% c(06,07,08) ) %&gt;% group_by(month,day,hr) %&gt;% ggplot() + geom_line(aes(hr,Tsurface-273.5,group=day,color=&#39;Surface&#39;),se=F)+ geom_line(aes(hr,TAH-273.5,group=day,color=&#39;Canopy&#39;),se=F)+ scale_colour_manual(&quot;Temperature at&quot;, breaks = c(&quot;Surface&quot;, &quot;Canopy&quot;), values = c(&quot;blue&quot;,&quot;red&quot;)) + theme_minimal() + ggtitle(&quot;Seasonal variation in temperature at different heights&quot;) + xlab(&quot;Hour&quot;) + ylab(&quot;Temperature (°C)&quot;) + labs(colour = &quot;Hour&quot;, subtitle=&quot;Microclimate differences at two different heights&quot;,caption=&quot;Data Source : http://www.microclim.org&quot;) 8.10 8-23-2018 Objectives for the day was to have a functional code for CN(Complete Node) and TN(Temperature only node). KX and AX are here to help me out, just awesome! We installed one CN with Anemometers, and tested it. The code needed some work, but we were able to bring-up one with four anemometers. We had three objectives as we were putting the nodes up. ** Have a reliable real-time clock ** Mount the solar radiation sensor on a firm base(there is a bubble to help stablize) ** Have a status indicator to check the activity 8.11 8-24-2018 Few issues overnight. DS1802B runs on 1-Wire, and on the same bus you can use umpteen number of them. By design, it should have worked, but we had problems with connecting more than four 8.12 9-23-2018 Analysis of data from the first field experiment. Mt Rainier deployment in the forest canopies. av06_mm &lt;- read_csv(&#39;./data/DATALOG-av06-cn.csv&#39;) ## Parsed with column specification: ## cols( ## date = col_character(), ## temp1 = col_double(), ## temp2 = col_double(), ## temp3 = col_double(), ## temp4 = col_double(), ## windspeed1 = col_double(), ## windspeed2 = col_double(), ## windspeed3 = col_double(), ## windspeed4 = col_double(), ## winddirection1 = col_double(), ## winddirection2 = col_double(), ## winddirection3 = col_double(), ## winddirection4 = col_double(), ## solar = col_double(), ## battery = col_double() ## ) str(av06_mm) ## Classes &#39;spec_tbl_df&#39;, &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 6252 obs. of 15 variables: ## $ date : chr &quot;9/2/18 9:44:7&quot; &quot;9/2/18 9:47:9&quot; &quot;9/2/18 9:50:11&quot; &quot;9/2/18 9:53:12&quot; ... ## $ temp1 : num 20.9 20.9 20.8 20.8 20.7 ... ## $ temp2 : num 21.1 21.1 21.1 21.1 20.9 ... ## $ temp3 : num 21.5 21.4 21.1 21.2 21.2 ... ## $ temp4 : num 20.8 20.8 20.8 20.8 20.8 ... ## $ windspeed1 : num 0 0 0 0 0 0 0 0 0 0 ... ## $ windspeed2 : num 0 0 0 0 0 0 0 0 0 0 ... ## $ windspeed3 : num 0 0 0 0 0 0 0 0 0 0 ... ## $ windspeed4 : num 0 0 0 0 0 0 0 0 0 0 ... ## $ winddirection1: num 1007 1009 1006 1010 1012 ... ## $ winddirection2: num 953 953 955 953 957 958 953 959 957 959 ... ## $ winddirection3: num 1004 1007 1004 1007 1008 ... ## $ winddirection4: num 979 975 976 974 977 976 979 974 973 973 ... ## $ solar : num 1022 1022 1021 1022 1023 ... ## $ battery : num 4.18 4.18 4.18 4.18 4.18 4.18 4.18 4.18 4.18 4.18 ... ## - attr(*, &quot;spec&quot;)= ## .. cols( ## .. date = col_character(), ## .. temp1 = col_double(), ## .. temp2 = col_double(), ## .. temp3 = col_double(), ## .. temp4 = col_double(), ## .. windspeed1 = col_double(), ## .. windspeed2 = col_double(), ## .. windspeed3 = col_double(), ## .. windspeed4 = col_double(), ## .. winddirection1 = col_double(), ## .. winddirection2 = col_double(), ## .. winddirection3 = col_double(), ## .. winddirection4 = col_double(), ## .. solar = col_double(), ## .. battery = col_double() ## .. ) Plot four temperatures tp &lt;- av06_mm %&gt;% dplyr::mutate(row_no= row_number()) %&gt;% ggplot() + geom_line(aes(row_no,temp1,color=&#39;red&#39;)) + geom_line(aes(row_no,temp2,color=&#39;blue&#39;)) + geom_line(aes(row_no,temp3,color=&#39;green&#39;)) + geom_line(aes(row_no,temp4,color=&#39;purple&#39;)) Plot four wind av06_mm %&gt;% dplyr::mutate(row_no= row_number()) %&gt;% ggplot() + geom_point(aes(row_no,windspeed1,color=&#39;windspeed1&#39;)) + geom_point(aes(row_no,windspeed2,color=&#39;windspeed2&#39;)) + geom_point(aes(row_no,windspeed3,color=&#39;windspeed3&#39;)) + geom_point(aes(row_no,windspeed4,color=&#39;windspeed4&#39;)) #ggplotly() Plot solar av06_mm %&gt;% dplyr::mutate(row_no= row_number()) %&gt;% ggplot() + geom_line(aes(row_no,solar,color=&#39;solar&#39;)) #ggplotly() Hourly temperature and precipitation (Pardise 5800) (vs Longmire station which is 2760 ft) #Load a file Paradise_2018&lt;- read.csv(&#39;./data/Paradise_5400_feet_2018.csv&#39;) Paradise_2018$date &lt;- as.Date(Paradise_2018$Date.Time..PST., &quot;%Y-%m-%d&quot;) Paradise_2018$hr &lt;-strftime(Paradise_2018$Date.Time..PST.,&#39;%H&#39;) Paradise_2018$min &lt;-strftime(Paradise_2018$Date.Time..PST.,&#39;%M&#39;) Paradise_2018$month &lt;- strftime(Paradise_2018$Date.Time..PST.,&#39;%m&#39;) Paradise_2018$Temperature..deg.C. &lt;- (Paradise_2018$Temperature..deg.F. - 32) * (5/9) Paradise_2018 %&gt;% filter(month %in% c(&quot;09&quot;)) %&gt;% ggplot(aes(date,Temperature..deg.C.)) +geom_point() + ggtitle(&quot;NWAC Temperature at Paradise(5400 ft)&quot;)+ xlab(&quot;Date&quot;) + ylab(&quot;Temp(Deg C)&quot;) Extracting diurnal pattern for a day Plot four wind along with other parameters dp1&lt;- av06_mm %&gt;% dplyr::mutate(row_no= row_number()) %&gt;% filter(row_no &gt; 2292 &amp; row_no &lt; 2714) %&gt;% ggplot() + geom_point(aes(row_no,windspeed1,color=&#39;windspeed1&#39;)) + geom_point(aes(row_no,windspeed2,color=&#39;windspeed2&#39;)) + geom_point(aes(row_no,windspeed3,color=&#39;windspeed3&#39;)) + geom_point(aes(row_no,windspeed4,color=&#39;windspeed4&#39;)) + geom_line(aes(row_no,log10(temp4),color=&#39;temp 4&#39;)) + geom_line(aes(row_no,log10(temp3),color=&#39;temp 3&#39;)) + geom_line(aes(row_no,log10(temp2),color=&#39;temp 2&#39;)) + geom_line(aes(row_no,log10(temp1),color=&#39;temp 1&#39;)) + geom_line(aes(row_no,log10(solar),color=&#39;solar&#39;)) Trying smoothing to see the pattern sp&lt;- av06_mm %&gt;% dplyr::mutate(row_no= row_number()) %&gt;% filter(row_no &gt; 2292 &amp; row_no &lt; 2714) %&gt;% ggplot() + geom_point(aes(row_no,windspeed1,color=&#39;windspeed1&#39;)) + geom_smooth(aes(row_no,windspeed1),method=&#39;lm&#39;, se = FALSE) + geom_point(aes(row_no,windspeed2,color=&#39;windspeed2&#39;)) + geom_smooth(aes(row_no,windspeed2),method=&#39;lm&#39;, se = FALSE) + geom_smooth(aes(row_no,windspeed3,color=&#39;windspeed3&#39;)) + geom_smooth(aes(row_no,windspeed3),method=&#39;lm&#39;, se = FALSE) + geom_smooth(aes(row_no,windspeed4,color=&#39;windspeed4&#39;)) + geom_smooth(aes(row_no,windspeed4),method=&#39;lm&#39;, se = FALSE) + theme_classic() #ggplotly(sp) #api_create(sp, filename = &quot;wind-profile-smoothed&quot;) 8.13 10-1-2018 With respect to microclimate measurements, forest canopy seems to be quite choppy(wind). Intuition says that there is so much buffering that a strong wind that has originated elsewhere when makes into canopies dissipates much quicker. Feedback: a) not descernible wind profile, so quite hard to interpolate. b) temperature seems to be too low c) the temperatures at different heights should track each other. 8.14 Next steps – Extract similiar segments and compare – How would a diurnation curve look like in the canopies at different heights ? – In open, my understanding so far, the temp closer to ground is warmer(much ?) in early hours of the day, but as the day warms, it flips i.e. the temp closer to ground is not that warm compared to higher heights(vertically). The air is much warmer at higher heights around solar max. Is this true ? Verify. Now, there could be exceptions, like inversion or cold air pooling. 8.15 10-2-2018 Microclim manuscript update. Feedback : a) Show 2-3 days instead of whole week. b) The raster plot - it is still not clear on what is the difference ? c) remove the seasonal plot as daily variation should be sufficient. Reflection: 8.16 10-17-2018 Feedback - Ideal would be to show multiple days plotted on the hourly x-axis to show the variation. Typical weekly summer variation decombined %&gt;% filter(year(datec) %in% c(1981) &amp; month(datec) %in% c(01) &amp; day(datec) &gt; 15 &amp; day(datec) &lt; 19) %&gt;% group_by(month,day,hr) %&gt;% ggplot() + geom_line(aes(hr,Tsurface-273.5,group=day,color=as.factor(day),linetype = &#39;Surface&#39;),se=F)+ geom_line(aes(hr,TAH-273.5,group=day ,color=as.factor(day),linetype = &#39;Canopy&#39;),se=F)+ scale_colour_manual(&quot;Temperature on day&quot;, breaks = c(&quot;16&quot;, &quot;17&quot;,&quot;18&quot;), values = c(&quot;blue&quot;,&quot;red&quot;,&quot;green&quot;)) + scale_linetype_manual(&quot;Height&quot;,values=c(&quot;Surface&quot;=2,&quot;Canopy&quot;=1)) + theme_minimal() + ggtitle(&quot;Variation in temperature at two different heights&quot;) + xlab(&quot;Hour&quot;) + ylab(&quot;Temperature (°C)&quot;) + labs(colour = &quot;Hour&quot;, subtitle=&quot;1/16/81 - 1/18/81&quot;,caption=&quot;Data Source : http://www.microclim.org&quot;) 8.17 Open to-dos – Take out the grid Taking a shot at seasonal aspect of microclimate. decombined %&gt;% filter(year(datec) %in% c(1981) &amp; month(datec) %in% c(06,07,08) ) %&gt;% group_by(month,day,hr) %&gt;% summarise(minST = min(Tsurface),minCT = min(TAH),maxST = max(Tsurface),maxCT = max(TAH)) %&gt;% group_by(hr) %&gt;% summarise(minST = mean(minST),minCT = mean(minCT),maxST = mean(maxST),maxCT = mean(maxCT)) %&gt;% ggplot() + geom_line(aes(hr,minST-273.5,color=&#39;Surface Min&#39;),linetype=1,se=F)+ geom_line(aes(hr,minCT-273.5,color=&#39;Canopy Min&#39;),se=F)+ geom_line(aes(hr,maxST-273.5,color=&#39;Surface Max&#39;),se=F)+ geom_line(aes(hr,maxCT-273.5,color=&#39;Canopy Max&#39;),se=F)+ scale_colour_manual(&quot;Temperature at&quot;, breaks = c(&quot;Surface Min&quot;, &quot;Canopy Min&quot;,&quot;Surface Max&quot;, &quot;Canopy Max&quot;), values = c(&quot;blue&quot;,&quot;red&quot;,&quot;green&quot;,&quot;pink&quot;)) + theme_minimal() + ggtitle(&quot;Summer trend of minimum temperature at different heights&quot;) + xlab(&quot;Hour&quot;) + ylab(&quot;Temperature (°C)&quot;) + labs(colour = &quot;Hour&quot;, subtitle=&quot;Microclimate differences at two different heights&quot;,caption=&quot;Data Source : http://www.microclim.org&quot;) 8.18 10-04-2018 Plot solar av06_mm %&gt;% mutate(row_no= row_number(),solarinunits= solar*1.76) %&gt;% ggplot() + geom_line(aes(row_no,solarinunits,color=&#39;solar&#39;)) ggplotly() 8.19 11-04-2018 Analysis of first set of data from the field. Need to look at the hourly variation, we expect the ground to be cooler depending on the time of the day. Lets look at one site library(lubridate) library(tidyverse) mclim_AE10_TN01_2018&lt;- read.csv(&#39;./data/DATALOG-AE10-TN01.CSV&#39;) names(mclim_AE10_TN01_2018) &lt;- c(&#39;time&#39;,&#39;nodeid&#39;,&#39;temp&#39;,&#39;batt&#39;) mclim_AE10_TN01_2018$time &lt;- as.POSIXct(mclim_AE10_TN01_2018$time, &quot;%Y/%m/%d %H:%M:%S&quot;) #Add hour month and day ## 11-05-2018 mclim_AE10_TN01_2018$hr &lt;- hour(mclim_AE10_TN01_2018$time) mclim_AE10_TN01_2018$minute&lt;- minute(mclim_AE10_TN01_2018$time) mclim_AE10_TN01_2018$day &lt;- day(mclim_AE10_TN01_2018$time) mclim_AE10_TN01_2018$month&lt;- month(mclim_AE10_TN01_2018$time) #Roughly one feet apart mclim_AE10_TN01_2018$height &lt;- 0 mclim_AE10_TN01_2018[mclim_AE10_TN01_2018$nodeid==&#39;28244877910B0291&#39; ,]$height &lt;- 0.3 mclim_AE10_TN01_2018[mclim_AE10_TN01_2018$nodeid==&#39;28A225779104022C&#39; ,]$height &lt;- 0.9 mclim_AE10_TN01_2018[mclim_AE10_TN01_2018$nodeid==&#39;281D877791100268&#39; ,]$height &lt;- 0.6 mclim_AE10_TN01_2018[mclim_AE10_TN01_2018$nodeid==&#39;282324779104023C&#39; ,]$height &lt;- 1.2 ## Day plot , Representive day mclim_AE10_TN01_2018 %&gt;% filter(day(time) %in% &#39;14&#39; &amp; !nodeid %in% c(&#39;282324779104023C&#39;)) %&gt;% ggplot( aes(time,temp,color = factor(height))) + geom_line() + theme_minimal() + ggtitle(&quot;Variation in temperature at AE10 - Open&quot;) + xlab(&quot;Date&quot;) + ylab(&quot;Temperature (°C)&quot;) + labs(colour = &quot;Height(m)&quot;, subtitle=&quot;9/17/2018&quot;,caption=&quot;Data Source : http://nanoclimate.org&quot;) Do detailed variation ## Day plot , Representive day mclim_AE10_TN01_2018 %&gt;% filter(day(time) %in% &#39;14&#39; &amp; !nodeid %in% c(&#39;282324779104023C&#39;)) %&gt;% ggplot( aes(time,temp,color = factor(height))) + geom_line() + theme_minimal() + ggtitle(&quot;Variation in temperature at AE10 - Open - TN01&quot;) + xlab(&quot;Date&quot;) + ylab(&quot;Temperature (°C)&quot;) + labs(colour = &quot;Height(m)&quot;, subtitle=&quot;9/17/2018&quot;,caption=&quot;Data Source : http://nanoclimate.org&quot;) By minute labelsx &lt;- c( &quot;0&quot;,&quot;12&quot;, &quot;24&quot;, &quot;36&quot;, &quot;48&quot; , &quot;1&quot;,&quot;12&quot;, &quot;24&quot;, &quot;36&quot;, &quot;48&quot;, &quot;2&quot; , &quot;12&quot;, &quot;24&quot;, &quot;36&quot;, &quot;48&quot;, &quot;3&quot;, &quot;12&quot;, &quot;24&quot;, &quot;36&quot;, &quot;48&quot;, &quot;4&quot;, &quot;12&quot;, &quot;24&quot;, &quot;36&quot;, &quot;48&quot;, &quot;5&quot;, &quot;12&quot;, &quot;24&quot;, &quot;36&quot;, &quot;48&quot;, &quot;6&quot;, &quot;12&quot;, &quot;24&quot;, &quot;36&quot;, &quot;48&quot;, &quot;7&quot;, &quot;12&quot;, &quot;24&quot;, &quot;36&quot;, &quot;48&quot;, &quot;8&quot;, &quot;12&quot;, &quot;24&quot;, &quot;36&quot;, &quot;48&quot;, &quot;9&quot;, &quot;12&quot;, &quot;24&quot;, &quot;36&quot;, &quot;48&quot;, &quot;10&quot;, &quot;12&quot;, &quot;24&quot;, &quot;36&quot;, &quot;48&quot;, &quot;11&quot;, &quot;12&quot;, &quot;24&quot;, &quot;36&quot;, &quot;48&quot;, &quot;12&quot;, &quot;12&quot;, &quot;24&quot;, &quot;36&quot;, &quot;48&quot;, &quot;13&quot;, &quot;12&quot;, &quot;24&quot;, &quot;36&quot;, &quot;48&quot;, &quot;14&quot;, &quot;12&quot;, &quot;24&quot;, &quot;36&quot;, &quot;48&quot;, &quot;15&quot;, &quot;12&quot;, &quot;24&quot;, &quot;36&quot;, &quot;48&quot;, &quot;16&quot;, &quot;12&quot;, &quot;24&quot;, &quot;36&quot;, &quot;48&quot;, &quot;17&quot;, &quot;12&quot;, &quot;24&quot;, &quot;36&quot;, &quot;48&quot;, &quot;18&quot;, &quot;12&quot;, &quot;24&quot;, &quot;36&quot;, &quot;48&quot;, &quot;19&quot;, &quot;12&quot;, &quot;24&quot;, &quot;36&quot;, &quot;48&quot;, &quot;20&quot;, &quot;12&quot;, &quot;24&quot;, &quot;36&quot;, &quot;48&quot;, &quot;21&quot;, &quot;12&quot;, &quot;24&quot;, &quot;36&quot;, &quot;48&quot;, &quot;22&quot;, &quot;12&quot;, &quot;24&quot;, &quot;36&quot;, &quot;48&quot;, &quot;23&quot;, &quot;12&quot;, &quot;24&quot;, &quot;36&quot;, &quot;48&quot;) ## Day plot , Representive day mclim_AE10_TN01_2018 %&gt;% filter(day(time) %in% &#39;14&#39; &amp; !height %in% c(1.2) ) %&gt;% group_by(height,hr,minute) %&gt;% summarise(tempatmin = mean(temp)) %&gt;% group_by(b = gl(ceiling(n()/4), 4, n())) %&gt;% group_by(height,hr,b) %&gt;% summarize(heights = levels(as.factor(height)), meantemp = mean(tempatmin), sd = sd(tempatmin)) %&gt;% mutate(newx= as.numeric(paste(hr,b,sep=&quot;&quot;))) %&gt;% #select(newx) %&gt;% distinct(newx) group_by(height) %&gt;% mutate(index=1:n()) %&gt;% ggplot() + geom_line(aes(index,meantemp,col=as.factor(height))) + #geom_line(data=paradise[paradise$day==14,], aes(hour,temp,col=&#39;Reference&#39;)) + labs(x=&quot;Hour&quot;, y=&quot;Temperature (°C)&quot;, tag=&quot;(g)&quot;,colour = &quot;Height (m)&quot;) + theme_minimal() + scale_x_continuous(breaks = seq(0,119,by=1), limits = c(0,120),labels = labelsx) + theme( panel.grid.major = element_blank(), legend.position = c(.2,.9), legend.title=element_text(size=9), legend.text=element_text(size=8), legend.background = element_rect(color = &quot;grey90&quot;, size = .5, linetype = &quot;dashed&quot;), axis.text.x=element_text(angle=90, hjust=0)) + theme(strip.text.x = element_text(face=&quot;bold&quot;, size=4)) + theme(strip.text.y = element_text(face=&quot;bold&quot;, size=8)) Lets look at a closed site mclim_AE10_TN02_2018&lt;- read.csv(&#39;./data/DATALOG-AE10-TN02.CSV&#39;) names(mclim_AE10_TN02_2018) &lt;- c(&#39;time&#39;,&#39;nodeid&#39;,&#39;temp&#39;,&#39;batt&#39;) mclim_AE10_TN02_2018$time &lt;- as.POSIXct(mclim_AE10_TN02_2018$time, &quot;%Y/%m/%d %H:%M:%S&quot;) #Add hour month and day ## 11-05-2018 mclim_AE10_TN02_2018$hr &lt;- hour(mclim_AE10_TN02_2018$time) mclim_AE10_TN02_2018$minute &lt;- minute(mclim_AE10_TN02_2018$time) mclim_AE10_TN02_2018$day &lt;- day(mclim_AE10_TN02_2018$time) mclim_AE10_TN02_2018$month&lt;- month(mclim_AE10_TN02_2018$time) #Roughly one feet apart mclim_AE10_TN02_2018$height &lt;- 0 mclim_AE10_TN02_2018[mclim_AE10_TN02_2018$nodeid==&#39;2862367791040281&#39; ,]$height &lt;- 1.2 mclim_AE10_TN02_2018[mclim_AE10_TN02_2018$nodeid==&#39;286E9D77910802F2&#39; ,]$height &lt;- 0.6 mclim_AE10_TN02_2018[mclim_AE10_TN02_2018$nodeid==&#39;28A91B7791060263&#39; ,]$height &lt;- 0.3 mclim_AE10_TN02_2018[mclim_AE10_TN02_2018$nodeid==&#39;280704779106023F&#39; ,]$height &lt;- 0.9 ## Day plot , Representive day mclim_AE10_TN02_2018 %&gt;% filter(day(time) %in% &#39;14&#39; ) %&gt;% ggplot( aes(time,temp,color = factor(height))) + geom_line() + theme_minimal() + ggtitle(&quot;Variation in temperature at AE10 - Closed - TN02&quot;) + xlab(&quot;Date&quot;) + ylab(&quot;Temperature (°C)&quot;) + labs(colour = &quot;Height(m)&quot;, subtitle=&quot;9/14/2018&quot;,caption=&quot;Data Source : http://nanoclimate.org&quot;) Lets look at another site mclim_AE10_TN03_2018&lt;- read.csv(&#39;./data/DATALOG-AE10-TN03.CSV&#39;) names(mclim_AE10_TN03_2018) &lt;- c(&#39;time&#39;,&#39;nodeid&#39;,&#39;temp&#39;,&#39;batt&#39;) mclim_AE10_TN03_2018$time &lt;- as.POSIXct(mclim_AE10_TN03_2018$time, &quot;%Y/%m/%d %H:%M:%S&quot;) #Add hour month and day ## 11-05-2018 mclim_AE10_TN03_2018$hr &lt;- hour(mclim_AE10_TN03_2018$time) mclim_AE10_TN03_2018$day &lt;- day(mclim_AE10_TN03_2018$time) mclim_AE10_TN03_2018$month&lt;- month(mclim_AE10_TN03_2018$time) mclim_AE10_TN03_2018$minute&lt;- minute(mclim_AE10_TN03_2018$time) #Roughly one feet apart mclim_AE10_TN03_2018$height &lt;- 0 mclim_AE10_TN03_2018[mclim_AE10_TN03_2018$nodeid==&#39;28BF3D77910B0267&#39; ,]$height &lt;- 1.2 mclim_AE10_TN03_2018[mclim_AE10_TN03_2018$nodeid==&#39;28CCF877910A0292&#39; ,]$height &lt;- 0.6 mclim_AE10_TN03_2018[mclim_AE10_TN03_2018$nodeid==&#39;283C8E7791080280&#39; ,]$height &lt;- 0.3 mclim_AE10_TN03_2018[mclim_AE10_TN03_2018$nodeid==&#39;28E210779104020F&#39; ,]$height &lt;- 0.9 ## Day plot , Representive day mclim_AE10_TN03_2018 %&gt;% filter(day(time) %in% &#39;14&#39; ) %&gt;% ggplot( aes(time,temp,color = factor(height))) + geom_line() + theme_minimal() + ggtitle(&quot;Variation in temperature at AE10 - Closed - TN03&quot;) + xlab(&quot;Date&quot;) + ylab(&quot;Temperature (°C)&quot;) + labs(colour = &quot;Height(m)&quot;, subtitle=&quot;9/14/2018&quot;,caption=&quot;Data Source : http://nanoclimate.org&quot;) Lets look at the Anemometer site mclim_AE10_CN01_2018&lt;-read_csv(&#39;./data/DATALOG-AE10-CN01.CSV&#39;) ## Parsed with column specification: ## cols( ## date = col_character(), ## temp1 = col_double(), ## temp2 = col_double(), ## temp3 = col_double(), ## temp4 = col_double(), ## windspeed1 = col_double(), ## windspeed2 = col_double(), ## windspeed3 = col_double(), ## windspeed4 = col_double(), ## winddirection1 = col_double(), ## winddirection2 = col_double(), ## winddirection3 = col_double(), ## winddirection4 = col_double(), ## solar = col_double(), ## battery = col_double() ## ) #mclim_AE10_CN01_2018&lt;- read.csv(&#39;./data/DATALOG-AE10-CN01.CSV&#39;,stringsAsFactors = T) names(mclim_AE10_CN01_2018) ## [1] &quot;date&quot; &quot;temp1&quot; &quot;temp2&quot; &quot;temp3&quot; ## [5] &quot;temp4&quot; &quot;windspeed1&quot; &quot;windspeed2&quot; &quot;windspeed3&quot; ## [9] &quot;windspeed4&quot; &quot;winddirection1&quot; &quot;winddirection2&quot; &quot;winddirection3&quot; ## [13] &quot;winddirection4&quot; &quot;solar&quot; &quot;battery&quot; mclim_AE10_CN01_2018$time &lt;- as_datetime(mclim_AE10_CN01_2018$date, format=&quot;%m/%d/%y %H:%M:%S&quot;,tz=&quot;America/Los_Angeles&quot;) mclim_AE10_CN01_2018$time &lt;-as.POSIXct(mclim_AE10_CN01_2018$time) #Add hour month and day ## 11-05-2018 mclim_AE10_CN01_2018$hr &lt;- hour(mclim_AE10_CN01_2018$time) mclim_AE10_CN01_2018$day &lt;- day(mclim_AE10_CN01_2018$time) mclim_AE10_CN01_2018$month&lt;- month(mclim_AE10_CN01_2018$time) #Roughly one feet apart mclim_AE10_CN01_2018$height &lt;- 0 #therm1,28782877910A0217 - 0.6 #therm2,284CCE7791090235 - 1.2 #therm3,286C7A7791080217 - 0.9 #therm4,280A2577910A020D - 0.3 # mclim_AE10_CN01_2018[mclim_AE10_CN01_2018$nodeid==&#39;2862367791040281&#39; ,]$height &lt;- 1.2 # mclim_AE10_CN01_2018[mclim_AE10_CN01_2018$nodeid==&#39;286E9D77910802F2&#39; ,]$height &lt;- 0.6 # mclim_AE10_CN01_2018[mclim_AE10_CN01_2018$nodeid==&#39;28A91B7791060263&#39; ,]$height &lt;- 0.3 # mclim_AE10_CN01_2018[mclim_AE10_CN01_2018$nodeid==&#39;280704779106023F&#39; ,]$height &lt;- 0.9 ## Day plot , Representive day mclim_AE10_CN01_2018 %&gt;% filter(month %in% c(9) &amp; day(time) %in% &#39;14&#39; ) %&gt;% ggplot() + geom_line( aes(time,temp1,color = &#39;0.6&#39;)) + geom_line( aes(time,temp2,color = &#39;1.2&#39;)) + geom_line( aes(time,temp3,color = &#39;0.9&#39;)) + geom_line( aes(time,temp4,color = &#39;0.3&#39;)) + theme_classic() + ggtitle(&quot;Variation in temperature at AE10 w/Wind - Open&quot;) + xlab(&quot;Date&quot;) + ylab(&quot;Temperature (°C)&quot;) + labs(colour = &quot;Height(m)&quot;, subtitle=&quot;9/14/2018&quot;,caption=&quot;Data Source : http://nanoclimate.org&quot;) By day with wind mclim_AE10_CN01_2018 %&gt;% filter(month %in% c(9) ) %&gt;% ggplot() + geom_line( aes(time,temp1,color = &#39;0.6&#39;)) + geom_line( aes(time,temp2,color = &#39;1.2&#39;)) + geom_line( aes(time,temp3,color = &#39;0.9&#39;)) + geom_line( aes(time,temp4,color = &#39;0.3&#39;)) + theme_minimal() + ggtitle(&quot;Variation in temperature at AE10 w/Wind - Open&quot;) + xlab(&quot;Date&quot;) + ylab(&quot;Temperature (°C)&quot;) + labs(colour = &quot;Height(m)&quot;, subtitle=&quot;Microclimate profiles&quot;,caption=&quot;Data Source : http://nanoclimate.org&quot;) By day with wind mclim_AE10_TN01_2018 %&gt;% filter(!nodeid %in% c(&#39;282324779104023C&#39;) &amp; temp &gt;0 ) %&gt;% ggplot( aes(time,temp,color = factor(height))) + geom_line() + theme_minimal() + ggtitle(&quot;Variation in temperature at AE10 - Open&quot;) + xlab(&quot;Date&quot;) + ylab(&quot;Temperature (°C)&quot;) + labs(colour = &quot;Height(m)&quot;, subtitle=&quot;Microclimate profiles&quot;,caption=&quot;Data Source : http://nanoclimate.org&quot;) Wind ptrofiles mclim_AE10_CN01_2018&lt;-read_csv(&#39;./data/DATALOG-AE10-CN01.CSV&#39;) ## Parsed with column specification: ## cols( ## date = col_character(), ## temp1 = col_double(), ## temp2 = col_double(), ## temp3 = col_double(), ## temp4 = col_double(), ## windspeed1 = col_double(), ## windspeed2 = col_double(), ## windspeed3 = col_double(), ## windspeed4 = col_double(), ## winddirection1 = col_double(), ## winddirection2 = col_double(), ## winddirection3 = col_double(), ## winddirection4 = col_double(), ## solar = col_double(), ## battery = col_double() ## ) #mclim_AE10_CN01_2018&lt;- read.csv(&#39;./data/DATALOG-AE10-CN01.CSV&#39;,stringsAsFactors = T) names(mclim_AE10_CN01_2018) ## [1] &quot;date&quot; &quot;temp1&quot; &quot;temp2&quot; &quot;temp3&quot; ## [5] &quot;temp4&quot; &quot;windspeed1&quot; &quot;windspeed2&quot; &quot;windspeed3&quot; ## [9] &quot;windspeed4&quot; &quot;winddirection1&quot; &quot;winddirection2&quot; &quot;winddirection3&quot; ## [13] &quot;winddirection4&quot; &quot;solar&quot; &quot;battery&quot; mclim_AE10_CN01_2018$time &lt;- as_datetime(mclim_AE10_CN01_2018$date, format=&quot;%m/%d/%y %H:%M:%S&quot;,tz=&quot;America/Los_Angeles&quot;) mclim_AE10_CN01_2018$time &lt;-as.POSIXct(mclim_AE10_CN01_2018$time) #Add hour month and day ## 11-05-2018 mclim_AE10_CN01_2018$hr &lt;- hour(mclim_AE10_CN01_2018$time) mclim_AE10_CN01_2018$minute &lt;- minute(mclim_AE10_CN01_2018$time) mclim_AE10_CN01_2018$day &lt;- day(mclim_AE10_CN01_2018$time) mclim_AE10_CN01_2018$month&lt;- month(mclim_AE10_CN01_2018$time) #Roughly one feet apart mclim_AE10_CN01_2018$height &lt;- 0 #therm1,28782877910A0217 - 0.6 #therm2,284CCE7791090235 - 1.2 #therm3,286C7A7791080217 - 0.9 #therm4,280A2577910A020D - 0.3 # mclim_AE10_CN01_2018[mclim_AE10_CN01_2018$nodeid==&#39;2862367791040281&#39; ,]$height &lt;- 1.2 # mclim_AE10_CN01_2018[mclim_AE10_CN01_2018$nodeid==&#39;286E9D77910802F2&#39; ,]$height &lt;- 0.6 # mclim_AE10_CN01_2018[mclim_AE10_CN01_2018$nodeid==&#39;28A91B7791060263&#39; ,]$height &lt;- 0.3 # mclim_AE10_CN01_2018[mclim_AE10_CN01_2018$nodeid==&#39;280704779106023F&#39; ,]$height &lt;- 0.9 ## Day plot , Representive day mclim_AE10_CN01_2018 %&gt;% filter(month %in% c(9) &amp; day(time) %in% &#39;14&#39; &amp; hr %in% c(13,14,15,16,17,18,19)) %&gt;% ggplot() + geom_line( aes(time,windspeed1,color = &#39;0.6&#39;)) + geom_line( aes(time,windspeed2,color = &#39;1.2&#39;)) + geom_line( aes(time,windspeed3,color = &#39;0.9&#39;)) + geom_line( aes(time,windspeed4,color = &#39;0.3&#39;)) + theme_minimal() + ggtitle(&quot;Variation in wind at AE10 w/Wind - Open&quot;) + xlab(&quot;Date&quot;) + ylab(&quot;Wind (km/hr)&quot;) + labs(colour = &quot;Height(m)&quot;, subtitle=&quot;9/14/2018&quot;,caption=&quot;Data Source : http://nanoclimate.org&quot;) mclim_AE10_CN01_2018 %&gt;% filter (month %in% c(9) ) %&gt;% group_by(month,day) %&gt;% summarize(maxtemp = max(temp1),mintemp = min(temp1)) %&gt;% ggplot() + geom_line(aes(day,maxtemp,col=&#39;red&#39;)) + geom_line(aes(as.numeric(day),mintemp,col=&#39;blue&#39;)) + theme_classic() + labs(x=&quot;Day&quot;, y=&quot;Temperature(°C) &quot;,subtitle=&quot;Microclimate station - AE10 - 2018/9 &quot;, caption=&quot;Data Source : http://nanoclimate.org&quot;) + geom_hline(aes(yintercept=9),colour=&quot;black&quot;, linetype=&quot;dashed&quot;) + scale_colour_manual(name = &#39;Temperature&#39;, values =c(&#39;red&#39;=&#39;red&#39;,&#39;blue&#39;=&#39;blue&#39;), labels = c(&#39;Max&#39;,&#39;Min&#39;)) Diel mclim_AE10_CN01_2018 %&gt;% filter (month %in% c(9) ) %&gt;% group_by(month,day) %&gt;% summarize(maxtemp = max(temp1),mintemp = min(temp1)) %&gt;% ggplot() + geom_line(aes(as.numeric(day),maxtemp-mintemp,col=&#39;red&#39;)) + theme_classic() + labs(x=&quot;Day&quot;, y=&quot;Temperature(°C) &quot;,subtitle=&quot;Microclimate station - AE10 - 2018/9 &quot;, caption=&quot;Data Source : http://nanoclimate.org&quot;) + geom_hline(aes(yintercept=9),colour=&quot;black&quot;, linetype=&quot;dashed&quot;) + scale_colour_manual(name = &#39;Diel variation&#39;, values =c(&#39;red&#39;=&#39;red&#39;), labels = c(&#39;Diurnal&#39;)) Diel by hour mclim_AE10_CN01_2018 %&gt;% filter (!is.na(mclim_AE10_CN01_2018$minute) &amp; month %in% c(9) ) %&gt;% group_by(month,day,hr) %&gt;% summarize(meantemp1 = mean(temp1),meantemp2 = mean(temp2),meantemp3 = mean(temp3),meantemp4 = mean(temp4)) %&gt;% group_by(hr) %&gt;% ggplot() + geom_smooth(aes(as.numeric(hr),meantemp1,col=&#39;red&#39;),se = F) + geom_smooth(aes(as.numeric(hr),meantemp2,col=&#39;blue&#39;),se = F) + geom_smooth(aes(as.numeric(hr),meantemp3,col=&#39;green&#39;),se = F) + geom_smooth(aes(as.numeric(hr),meantemp4,col=&#39;purple&#39;),se = F) + theme_classic() + labs(x=&quot;Hour&quot;, y=&quot;Temperature(°C) &quot;,subtitle=&quot;Microclimate station - AE10 - 2018/9 &quot;, caption=&quot;Data Source : http://nanoclimate.org&quot;) + geom_hline(aes(yintercept=9),colour=&quot;black&quot;, linetype=&quot;dashed&quot;) + scale_colour_manual(name = &#39;Heights&#39;, values =c(&#39;red&#39;=&#39;red&#39;,&#39;blue&#39;=&#39;blue&#39;,&#39;green&#39;=&#39;green&#39;,&#39;purple&#39;=&#39;purple&#39;), labels = c(&#39;1.2&#39;,&#39;.9&#39;,&#39;.6&#39;,&#39;.3&#39;)) ## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39; ## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39; ## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39; ## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39; Diel does not make sense mclim_AE10_CN01_2018 %&gt;% filter (!is.na(mclim_AE10_CN01_2018$minute) &amp; month %in% c(9) ) %&gt;% group_by(month,day,hr,minute) %&gt;% summarise(m1= mean(temp1),m2= mean(temp2),m3= mean(temp3),m4= mean(temp4)) %&gt;% mutate(dh1 = mean(min(m1) - max(m1)) ,dh2 = mean(min(m2) - max(m2)),dh3 = mean(min(m3) - max(m3)),dh4 = mean(min(m4) - max(m4))) %&gt;% group_by(hr) %&gt;% ggplot() + geom_smooth(aes(as.numeric(hr),dh1,col=&#39;red&#39;),se = F) + geom_smooth(aes(as.numeric(hr),dh2,col=&#39;blue&#39;),se = F) + geom_smooth(aes(as.numeric(hr),dh3,col=&#39;green&#39;),se = F) + geom_smooth(aes(as.numeric(hr),dh4,col=&#39;purple&#39;),se = F) + theme_classic() + labs(x=&quot;Hour&quot;, y=&quot;Temperature(°C) &quot;,subtitle=&quot;Microclimate station - AE10 - 2018/9 &quot;, caption=&quot;Data Source : http://nanoclimate.org&quot;) + geom_hline(aes(yintercept=9),colour=&quot;black&quot;, linetype=&quot;dashed&quot;) + scale_colour_manual(name = &#39;Heights&#39;, values =c(&#39;red&#39;=&#39;red&#39;,&#39;blue&#39;=&#39;blue&#39;,&#39;green&#39;=&#39;green&#39;,&#39;purple&#39;=&#39;purple&#39;), labels = c(&#39;1.2&#39;,&#39;.9&#39;,&#39;.6&#39;,&#39;.3&#39;)) ## `geom_smooth()` using method = &#39;gam&#39; and formula &#39;y ~ s(x, bs = &quot;cs&quot;)&#39; ## `geom_smooth()` using method = &#39;gam&#39; and formula &#39;y ~ s(x, bs = &quot;cs&quot;)&#39; ## `geom_smooth()` using method = &#39;gam&#39; and formula &#39;y ~ s(x, bs = &quot;cs&quot;)&#39; ## `geom_smooth()` using method = &#39;gam&#39; and formula &#39;y ~ s(x, bs = &quot;cs&quot;)&#39; Diel does not make sense mclim_AE10_CN01_2018 %&gt;% filter (!is.na(mclim_AE10_CN01_2018$minute) &amp; month %in% c(9) ) %&gt;% group_by(month,day,hr) %&gt;% summarise(m1= mean(temp1),m2= mean(temp2),m3= mean(temp3),m4= mean(temp4)) %&gt;% group_by(hr) %&gt;% summarise(m1= mean(m1),m2= mean(m2),m3= mean(m3),m4= mean(m4)) %&gt;% ggplot() + geom_line(aes(as.numeric(hr),m1,col=&#39;1&#39;)) + geom_line(aes(as.numeric(hr),m2,col=&#39;2&#39;)) + geom_line(aes(as.numeric(hr),m3,col=&#39;3&#39;)) + geom_line(aes(as.numeric(hr),m4,col=&#39;4&#39;)) + theme_classic() + labs(x=&quot;Hour&quot;, y=&quot;Temperature(°C) &quot;,subtitle=&quot;Microclimate station - AE10 - September 2018 &quot;, caption=&quot;Data Source : http://nanoclimate.org&quot;) + geom_hline(aes(yintercept=9),colour=&quot;black&quot;, linetype=&quot;dashed&quot;) + scale_colour_manual(name = &#39;Diurnal variation at heights (m)&#39;, values =c(&#39;1&#39;=&#39;red&#39;,&#39;2&#39;=&#39;blue&#39;,&#39;3&#39;=&#39;green&#39;,&#39;4&#39;=&#39;purple&#39;), labels = c(&#39;1.2&#39;,&#39;.9&#39;,&#39;.6&#39;,&#39;.3&#39;)) Lapse rate calculator https://www.shodor.org/os411/courses/_master/tools/calculators/lapserate/ 8.20 11-19-2018 Few days in September (Late September) mclim_AE10_CN01_2018 %&gt;% filter (!is.na(mclim_AE10_CN01_2018$minute) &amp; month %in% c(9) ) %&gt;% filter( day &gt; 20 &amp; day &lt; 24) %&gt;% group_by(month,day,hr) %&gt;% summarise(m1= mean(temp1),m2= mean(temp2),m3= mean(temp3),m4= mean(temp4)) %&gt;% group_by(day,hr) %&gt;% ggplot() + geom_line(aes(hr,m1,group=day,color=as.factor(day),linetype = &#39;0.3&#39;),se=F)+ geom_line(aes(hr,m4,group=day ,color=as.factor(day),linetype = &#39;1.2&#39;),se=F)+ scale_colour_manual(&quot;Temperature on day&quot;, breaks = c(&quot;21&quot;, &quot;22&quot;,&quot;23&quot;), values = c(&quot;blue&quot;,&quot;red&quot;,&quot;green&quot;)) + scale_linetype_manual(&quot;Height(m)&quot;,values=c(&quot;0.3&quot;=2,&quot;1.2&quot;=1)) + theme_classic() + ggtitle(&quot;Variation in temperature at two different heights at AE10&quot;) + xlab(&quot;Hour&quot;) + ylab(&quot;Temperature (°C)&quot;) + labs(colour = &quot;Hour&quot;, subtitle=&quot;9/21/18 - 9/23/19&quot;,caption=&quot;Data Source : http://www.nanoclimate.org&quot;) Early in the month mclim_AE10_CN01_2018 %&gt;% filter (!is.na(mclim_AE10_CN01_2018$minute) &amp; month %in% c(9) ) %&gt;% filter( day &gt; 11 &amp; day &lt; 15) %&gt;% group_by(month,day,hr) %&gt;% summarise(m1= mean(temp1),m2= mean(temp2),m3= mean(temp3),m4= mean(temp4)) %&gt;% group_by(day,hr) %&gt;% ggplot() + geom_line(aes(hr,m1,group=day,color=as.factor(day),linetype = &#39;0.3&#39;),se=F)+ geom_line(aes(hr,m4,group=day ,color=as.factor(day),linetype = &#39;1.2&#39;),se=F)+ scale_colour_manual(&quot;Temperature on day&quot;, breaks = c(&quot;12&quot;, &quot;13&quot;,&quot;14&quot;), values = c(&quot;blue&quot;,&quot;red&quot;,&quot;green&quot;)) + scale_linetype_manual(&quot;Height(m)&quot;,values=c(&quot;0.3&quot;=2,&quot;1.2&quot;=1)) + theme_classic() + ggtitle(&quot;Variation in temperature at two different heights at AE10&quot;) + xlab(&quot;Hour&quot;) + ylab(&quot;Temperature (°C)&quot;) + labs(colour = &quot;Hour&quot;, subtitle=&quot;9/12/18 - 9/14/19&quot;,caption=&quot;Data Source : http://www.nanoclimate.org&quot;) Minute resolution Early in the month mclim_AE10_CN01_2018 %&gt;% filter (!is.na(mclim_AE10_CN01_2018$minute) &amp; month %in% c(9) ) %&gt;% filter( day &gt; 11 &amp; day &lt; 15) %&gt;% group_by(month,day,hr) %&gt;% add_count(wt=3) %&gt;% summarise(m1= mean(temp1),m2= mean(temp2),m3= mean(temp3),m4= mean(temp4)) %&gt;% group_by(day,hr) %&gt;% ggplot() + geom_line(aes(hr,m1,group=day,color=as.factor(day),linetype = &#39;0.3&#39;),se=F)+ geom_line(aes(hr,m4,group=day ,color=as.factor(day),linetype = &#39;1.2&#39;),se=F)+ scale_colour_manual(&quot;Temperature on day&quot;, breaks = c(&quot;12&quot;, &quot;13&quot;,&quot;14&quot;), values = c(&quot;blue&quot;,&quot;red&quot;,&quot;green&quot;)) + scale_linetype_manual(&quot;Height(m)&quot;,values=c(&quot;0.3&quot;=2,&quot;1.2&quot;=1)) + theme_classic() + ggtitle(&quot;Variation in temperature at two different heights at AE10&quot;) + xlab(&quot;Hour&quot;) + ylab(&quot;Temperature (°C)&quot;) + labs(colour = &quot;Hour&quot;, subtitle=&quot;9/12/18 - 9/14/19&quot;,caption=&quot;Data Source : http://www.nanoclimate.org&quot;) Minute resolution Early in the month mclim_AE10_CN01_2018$segment &lt;- 0 mclim_AE10_CN01_2018[!is.na(mclim_AE10_CN01_2018$minute) &amp; mclim_AE10_CN01_2018$minute &gt;0 &amp; mclim_AE10_CN01_2018$minute &lt;=15 ,]$segment &lt;- 1 mclim_AE10_CN01_2018[!is.na(mclim_AE10_CN01_2018$minute) &amp; mclim_AE10_CN01_2018$minute &gt;15 &amp; mclim_AE10_CN01_2018$minute &lt;=30 ,]$segment &lt;- 2 mclim_AE10_CN01_2018[!is.na(mclim_AE10_CN01_2018$minute) &amp; mclim_AE10_CN01_2018$minute &gt;30 &amp; mclim_AE10_CN01_2018$minute &lt;=45 ,]$segment &lt;- 3 mclim_AE10_CN01_2018[!is.na(mclim_AE10_CN01_2018$minute) &amp; mclim_AE10_CN01_2018$minute &gt;45 &amp; mclim_AE10_CN01_2018$minute &lt;=60 ,]$segment &lt;- 4 mclim_AE10_CN01_2018 %&gt;% filter (!is.na(mclim_AE10_CN01_2018$minute) &amp; month %in% c(9) ) %&gt;% filter( day &gt; 11 &amp; day &lt; 15) %&gt;% group_by(month,day,hr,segment) %&gt;% summarise(m1= mean(temp1),m2= mean(temp2),m3= mean(temp3),m4= mean(temp4)) %&gt;% group_by(day,hr) %&gt;% summarise(m1= mean(m1),m2= mean(m2),m3= mean(m3),m4= mean(m4)) %&gt;% ggplot() + geom_line(aes(hr,m1,group=day,color=as.factor(day),linetype = &#39;0.3&#39;),se=F)+ geom_line(aes(hr,m4,group=day ,color=as.factor(day),linetype = &#39;1.2&#39;),se=F)+ scale_colour_manual(&quot;Temperature on day&quot;, breaks = c(&quot;12&quot;, &quot;13&quot;,&quot;14&quot;), values = c(&quot;blue&quot;,&quot;red&quot;,&quot;green&quot;)) + scale_linetype_manual(&quot;Height(m)&quot;,values=c(&quot;0.3&quot;=2,&quot;1.2&quot;=1)) + theme_classic() + ggtitle(&quot;Variation in temperature at two different heights at AE10&quot;) + xlab(&quot;Hour&quot;) + ylab(&quot;Temperature (°C)&quot;) + labs(colour = &quot;Hour&quot;, subtitle=&quot;9/12/18 - 9/14/19&quot;,caption=&quot;Data Source : http://www.nanoclimate.org&quot;) Microclim(Without the grid) - Take off title - Remove grid - Remove caption - Remove temperature on a day legend decombined %&gt;% filter(year(datec) %in% c(1981) &amp; month(datec) %in% c(01) &amp; day(datec) &gt; 15 &amp; day(datec) &lt; 19) %&gt;% group_by(month,day,hr) %&gt;% ggplot() + geom_line(aes(hr,Tsurface-273.5,group=day,color=as.factor(day),linetype = &#39;0&#39;),se=F)+ geom_line(aes(hr,TAH-273.5,group=day ,color=as.factor(day),linetype = &#39;1.3&#39;),se=F)+ scale_colour_manual(&quot;Temperature on day&quot;, breaks = c(&quot;16&quot;, &quot;17&quot;,&quot;18&quot;), values = c(&quot;blue&quot;,&quot;red&quot;,&quot;green&quot;),guide = FALSE) + scale_linetype_manual(&quot;Height(m)&quot;,values=c(&quot;0&quot;=2,&quot;1.3&quot;=1)) + theme_classic() + xlab(&quot;Hour&quot;) + ylab(&quot;Temperature (°C)&quot;) + labs(colour = &quot;Hour&quot;) ## 12-02-2018 8.21 12-17-2018 Comparison to LaCrosse Weather Station mclim_AE16_CN01_Calib&lt;-read_csv(&#39;./data/AE16CN-Calbration.CSV&#39;) ## Parsed with column specification: ## cols( ## date = col_character(), ## temp1 = col_double(), ## temp2 = col_double(), ## temp3 = col_double(), ## temp4 = col_double(), ## windspeed1 = col_double(), ## windspeed2 = col_double(), ## windspeed3 = col_double(), ## windspeed4 = col_double(), ## winddirection1 = col_double(), ## winddirection2 = col_double(), ## winddirection3 = col_double(), ## winddirection4 = col_double(), ## solar = col_double(), ## battery = col_double() ## ) names(mclim_AE16_CN01_Calib) ## [1] &quot;date&quot; &quot;temp1&quot; &quot;temp2&quot; &quot;temp3&quot; ## [5] &quot;temp4&quot; &quot;windspeed1&quot; &quot;windspeed2&quot; &quot;windspeed3&quot; ## [9] &quot;windspeed4&quot; &quot;winddirection1&quot; &quot;winddirection2&quot; &quot;winddirection3&quot; ## [13] &quot;winddirection4&quot; &quot;solar&quot; &quot;battery&quot; mclim_AE16_CN01_Calib$time &lt;- as_datetime(mclim_AE16_CN01_Calib$date, format=&quot;%m/%d/%y %H:%M:%S&quot;,tz=&quot;America/Los_Angeles&quot;) mclim_AE16_CN01_Calib$time &lt;-as.POSIXct(mclim_AE16_CN01_Calib$time) #Add hour month and day ## 11-05-2018 mclim_AE16_CN01_Calib$hr &lt;- hour(mclim_AE16_CN01_Calib$time) mclim_AE16_CN01_Calib$minute &lt;- minute(mclim_AE16_CN01_Calib$time) mclim_AE16_CN01_Calib$day &lt;- day(mclim_AE16_CN01_Calib$time) mclim_AE16_CN01_Calib$month&lt;- month(mclim_AE16_CN01_Calib$time) Read in LaCrosse library(weathermetrics) LaCrosse_Calib&lt;-read_csv(&#39;./data/LaCrosse_20181116-20181215.csv&#39;) ## Parsed with column specification: ## cols( ## Time = col_datetime(format = &quot;&quot;), ## HeatIndex_F = col_double(), ## `Humidity RH%` = col_double(), ## Temperature_F = col_double() ## ) names(LaCrosse_Calib) ## [1] &quot;Time&quot; &quot;HeatIndex_F&quot; &quot;Humidity RH%&quot; &quot;Temperature_F&quot; LaCrosse_Calib$Temperature_C&lt;- weathermetrics::fahrenheit.to.celsius(LaCrosse_Calib$Temperature_F) #LaCrosse_Calib$dtime &lt;- as_datetime(LaCrosse_Calib$Time, format=&quot;%Y-%m-%d %H:%M:%S&quot;,tz=&quot;America/Los_Angeles&quot;) #LaCrosse_Calib$dtime &lt;-as.POSIXct(LaCrosse_Calib$Time) #Add hour month and day ## 11-05-2018 LaCrosse_Calib$hr &lt;- hour(LaCrosse_Calib$Time) LaCrosse_Calib$minute &lt;- minute(LaCrosse_Calib$Time) LaCrosse_Calib$day &lt;- day(LaCrosse_Calib$Time) LaCrosse_Calib$month&lt;- month(LaCrosse_Calib$Time) Raw plots mclim_AE16_CN01_Calib %&gt;% filter(day &gt; 4) %&gt;% ggplot() + geom_line(aes(time,temp1,col=&#39;A&#39;)) + geom_line(aes(time,temp2,col=&#39;B&#39;)) + geom_line(data=LaCrosse_Calib, aes(Time,Temperature_C,col=&#39;C&#39;)) + theme_classic() + labs(x=&quot;Date&quot;, y=&quot;Temperature(°C) &quot;,subtitle=&quot;Microclimate station - AE10 Validation &quot;, caption=&quot;Data Source : http://nanoclimate.org&quot;) + geom_hline(aes(yintercept=9),colour=&quot;black&quot;, linetype=&quot;dashed&quot;) + scale_colour_manual(name = &#39;Heights&#39;, values =c(&#39;A&#39;=&#39;red&#39;,&#39;B&#39;=&#39;blue&#39;,&#39;C&#39;=&#39;green&#39;), labels = c(&#39;1.2&#39;,&#39;.9&#39;,&quot;Reference&quot;)) Hourly 8.22 12-21-2018 Plot three elevations at Mt Rainier MtRainier_Local &lt;- read_csv(&#39;./data/mt-rainier_temperature_2018.csv&#39;) ## Parsed with column specification: ## cols( ## `Date/Time (PST)` = col_datetime(format = &quot;&quot;), ## `deg F - 5400&#39; - Paradise` = col_double(), ## `deg F - 6410&#39; - Sunrise Base` = col_double(), ## `deg F - 6880&#39; - Sunrise Upper` = col_double(), ## `deg F - 10110&#39; - Camp Muir` = col_double() ## ) colnames(MtRainier_Local) &lt;- c(&#39;datetime&#39;,&#39;Paradise_5400&#39;,&#39;Sunrise_6410&#39;,&#39;Sunrise_6880&#39;,&#39;CampMuir_10110&#39;) MtRainier_Local$hr &lt;- hour(MtRainier_Local$datetime) MtRainier_Local$minute &lt;- minute(MtRainier_Local$datetime) MtRainier_Local$day &lt;- day(MtRainier_Local$datetime) MtRainier_Local$month&lt;- month(MtRainier_Local$datetime) MtRainier_Local$year&lt;- year(MtRainier_Local$datetime) MtRainier_Local %&gt;% filter(month == 9 &amp; year== 2018 ) %&gt;% ggplot() + geom_line(aes(datetime,weathermetrics::fahrenheit.to.celsius(Paradise_5400),col=&#39;5400&#39;)) + geom_line(aes(datetime,weathermetrics::fahrenheit.to.celsius(Sunrise_6410),col=&#39;6410&#39;)) + geom_line(aes(datetime,weathermetrics::fahrenheit.to.celsius(Sunrise_6880),col=&#39;6880&#39;)) + theme_classic() + labs(x=&quot;Date&quot;, y=&quot;Temperature(°C) &quot;,subtitle=&quot;Microclimate station - AE10 Validation &quot;, caption=&quot;Data Source : http://nanoclimate.org&quot;) + geom_hline(aes(yintercept=9),colour=&quot;black&quot;, linetype=&quot;dashed&quot;) + scale_colour_manual(name = &#39;Heights&#39;, values =c(&#39;5400&#39;=&#39;red&#39;,&#39;6410&#39;=&#39;blue&#39;,&#39;6880&#39;=&#39;green&#39;), labels = c(&#39;5400&#39;,&#39;6410&#39;,&quot;6880&quot;)) Read and plot the points #With zero plane dispacement library(leaflet) Nodes &lt;- read_csv(&#39;./data/Nodes-Table 1.csv&#39;) ## Parsed with column specification: ## cols( ## X1 = col_logical(), ## NodeId = col_character(), ## Lat = col_double(), ## Long = col_double(), ## Type = col_character(), ## Canopy = col_character(), ## `Live Date(GMT)` = col_character(), ## Notes = col_character() ## ) Nodes %&gt;% leaflet() %&gt;% fitBounds(~min(Long), ~min(Lat), ~max(Long), ~max(Lat)) %&gt;% addProviderTiles(providers$Esri.WorldTopoMap, options = providerTileOptions(noWrap = TRUE) ) %&gt;% addMarkers(~Long,~Lat,popup = ~as.character(NodeId), label = ~as.character(NodeId)) %&gt;% addCircleMarkers(-121.73,46.79,color = &quot;red&quot;) #addCircles(~lon,~lat,color = ~pal(estElevation)) %&gt;% #addLegend(pal = pal, values = ~estElevation) ## Get long and lat from your data.frame. Make sure that the order is in lon/lat. xy &lt;- Nodes[,c(&#39;Long&#39;,&#39;Lat&#39;)] spdf &lt;- SpatialPointsDataFrame(coords = xy, data = Nodes, proj4string = CRS(&quot;+proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0&quot;)) prj_dd &lt;- &quot;+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs&quot; library(elevatr) df_elev_epqs &lt;- get_elev_point(spdf, prj = prj_dd, src = &quot;epqs&quot;) ## Note: Elevation units are in &amp;units=Meters ## Note:. The coordinate reference system is: ## +proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0 Plot the nodes on high resolution DEM #With zero plane dispacement library(rgdal) #this package is necessary to import the .asc file in R. library(rasterVis) #this package has the function which allows the 3D plotting. #set the path where the file is, and import it into R. r= raster(paste(&quot;./data/rainier_2007_dtm_12.tif&quot;, sep=&quot;&quot;)) #visualize the raster in 3D plot(r,lit=TRUE) 8.23 1-3-2019 Checking a sample day at Mt Rainier, testing the hypothesis that temperature decreases by elevation. We are going to look at sample day of September 12th 2018, we see for for couple of hours temperature shows inversion. Now, unstable of the boundary layer means mixing, usually results from the wind. MtRainier_Local &lt;- read_csv(&#39;./data/mt-rainier_temperature_2018.csv&#39;) ## Parsed with column specification: ## cols( ## `Date/Time (PST)` = col_datetime(format = &quot;&quot;), ## `deg F - 5400&#39; - Paradise` = col_double(), ## `deg F - 6410&#39; - Sunrise Base` = col_double(), ## `deg F - 6880&#39; - Sunrise Upper` = col_double(), ## `deg F - 10110&#39; - Camp Muir` = col_double() ## ) colnames(MtRainier_Local) &lt;- c(&#39;datetime&#39;,&#39;Paradise_5400&#39;,&#39;Sunrise_6410&#39;,&#39;Sunrise_6880&#39;,&#39;CampMuir_10110&#39;) MtRainier_Local$hr &lt;- hour(MtRainier_Local$datetime) MtRainier_Local$minute &lt;- minute(MtRainier_Local$datetime) MtRainier_Local$day &lt;- day(MtRainier_Local$datetime) MtRainier_Local$month&lt;- month(MtRainier_Local$datetime) MtRainier_Local$year&lt;- year(MtRainier_Local$datetime) MtRainier_Local %&gt;% filter(month == 9 &amp; year== 2018 &amp; day == 12) %&gt;% ggplot() + geom_line(aes(datetime,weathermetrics::fahrenheit.to.celsius(Paradise_5400),col=&#39;1645&#39;)) + geom_line(aes(datetime,weathermetrics::fahrenheit.to.celsius(Sunrise_6410),col=&#39;1953&#39;)) + geom_line(aes(datetime,weathermetrics::fahrenheit.to.celsius(Sunrise_6880),col=&#39;2097&#39;)) + geom_line(aes(datetime,weathermetrics::fahrenheit.to.celsius(CampMuir_10110),col=&#39;3081&#39;)) + theme_classic() + labs(x=&quot;Date&quot;, y=&quot;Temperature(°C) &quot;,subtitle=&quot;Met stations - Mt Rainier &quot;, caption=&quot;Data Source : http://nanoclimate.org&quot;) + scale_colour_manual(name = &#39;Heights(m)&#39;, values =c(&#39;1&#39;,&#39;2&#39;,&#39;3&#39;,&#39;4&#39;), labels = c(&#39;1645&#39;,&#39;1953&#39;,&quot;2097&quot;,&quot;3081&quot;)) + geom_hline(aes(yintercept=9),colour=&quot;black&quot;, linetype=&quot;dashed&quot;) Lets lookjust for September MtRainier_Local &lt;- read_csv(&#39;./data/mt-rainier_temperature_2018.csv&#39;) ## Parsed with column specification: ## cols( ## `Date/Time (PST)` = col_datetime(format = &quot;&quot;), ## `deg F - 5400&#39; - Paradise` = col_double(), ## `deg F - 6410&#39; - Sunrise Base` = col_double(), ## `deg F - 6880&#39; - Sunrise Upper` = col_double(), ## `deg F - 10110&#39; - Camp Muir` = col_double() ## ) colnames(MtRainier_Local) &lt;- c(&#39;datetime&#39;,&#39;Paradise_5400&#39;,&#39;Sunrise_6410&#39;,&#39;Sunrise_6880&#39;,&#39;CampMuir_10110&#39;) MtRainier_Local$hr &lt;- hour(MtRainier_Local$datetime) MtRainier_Local$minute &lt;- minute(MtRainier_Local$datetime) MtRainier_Local$day &lt;- day(MtRainier_Local$datetime) MtRainier_Local$month&lt;- month(MtRainier_Local$datetime) MtRainier_Local$year&lt;- year(MtRainier_Local$datetime) MtRainier_Local %&gt;% filter(month == 9 &amp; year== 2018 ) %&gt;% ggplot() + geom_line(aes(datetime,weathermetrics::fahrenheit.to.celsius(Paradise_5400),col=&#39;1645&#39;)) + geom_line(aes(datetime,weathermetrics::fahrenheit.to.celsius(Sunrise_6410),col=&#39;1953&#39;)) + geom_line(aes(datetime,weathermetrics::fahrenheit.to.celsius(Sunrise_6880),col=&#39;2097&#39;)) + geom_line(aes(datetime,weathermetrics::fahrenheit.to.celsius(CampMuir_10110),col=&#39;3081&#39;)) + theme_classic() + labs(x=&quot;Date&quot;, y=&quot;Temperature(°C) &quot;,subtitle=&quot;Met stations - Mt Rainier Hourly readings (2018) &quot;, caption=&quot;Data Source : http://nwac.us&quot;) + scale_colour_manual(name = &#39;Heights(m)&#39;, values =c(&#39;1&#39;,&#39;2&#39;,&#39;3&#39;,&#39;4&#39;), labels = c(&#39;1645&#39;,&#39;1953&#39;,&quot;2097&quot;,&quot;3081&quot;)) + geom_hline(aes(yintercept=9),colour=&quot;black&quot;, linetype=&quot;dashed&quot;) See if it is true for the whole year,looks like Summer is bit jumbled MtRainier_Local &lt;- read_csv(&#39;./data/mt-rainier_temperature_2018.csv&#39;) ## Parsed with column specification: ## cols( ## `Date/Time (PST)` = col_datetime(format = &quot;&quot;), ## `deg F - 5400&#39; - Paradise` = col_double(), ## `deg F - 6410&#39; - Sunrise Base` = col_double(), ## `deg F - 6880&#39; - Sunrise Upper` = col_double(), ## `deg F - 10110&#39; - Camp Muir` = col_double() ## ) colnames(MtRainier_Local) &lt;- c(&#39;datetime&#39;,&#39;Paradise_5400&#39;,&#39;Sunrise_6410&#39;,&#39;Sunrise_6880&#39;,&#39;CampMuir_10110&#39;) MtRainier_Local$hr &lt;- hour(MtRainier_Local$datetime) MtRainier_Local$minute &lt;- minute(MtRainier_Local$datetime) MtRainier_Local$day &lt;- day(MtRainier_Local$datetime) MtRainier_Local$month&lt;- month(MtRainier_Local$datetime) MtRainier_Local$year&lt;- year(MtRainier_Local$datetime) MtRainier_Local %&gt;% filter( year== 2018) %&gt;% ggplot() + geom_smooth(method = &quot;loess&quot;,aes(datetime,weathermetrics::fahrenheit.to.celsius(Paradise_5400),colour=&#39;1645&#39;),se=TRUE) + geom_smooth(method = &quot;loess&quot;,aes(datetime,weathermetrics::fahrenheit.to.celsius(Sunrise_6410),colour=&#39;1953&#39;),se=TRUE) + geom_smooth(method = &quot;loess&quot;,aes(datetime,weathermetrics::fahrenheit.to.celsius(Sunrise_6880),colour=&#39;2097&#39;),se=TRUE) + geom_smooth(method = &quot;loess&quot;,aes(datetime,weathermetrics::fahrenheit.to.celsius(CampMuir_10110),colour=&#39;3081&#39;),se=TRUE) + theme_classic() + labs(x=&quot;Date&quot;, y=&quot;Temperature(°C) &quot;,subtitle=&quot;Met stations - Mt Rainier &quot;, caption=&quot;Data Source : http://nwac.us&quot;) + scale_colour_manual(name = &#39;Heights(m)&#39;, values =c(&#39;1&#39;,&#39;2&#39;,&#39;3&#39;,&#39;4&#39;), labels = c(&#39;1645&#39;,&#39;1953&#39;,&quot;2097&quot;,&quot;3081&quot;)) + geom_hline(aes(yintercept=9),colour=&quot;black&quot;, linetype=&quot;dashed&quot;) Mapping solar radiation for the same three heights.Its generally truethat higher the elevation,more solar insolation,but must not bethe case in all as MtRainier_Solar &lt;- read_csv(&#39;./data/mt-rainier_solar_pyranometer_2018.csv&#39;) ## Parsed with column specification: ## cols( ## `Date/Time (PST)` = col_datetime(format = &quot;&quot;), ## `W/m2 - 5380&#39; - Paradise Wind` = col_double(), ## `W/m2 - 6880&#39; - Sunrise Upper` = col_double(), ## `W/m2 - 10110&#39; - Camp Muir` = col_double() ## ) colnames(MtRainier_Solar) &lt;- c(&#39;datetime&#39;,&#39;Paradise_5400&#39;,&#39;Sunrise_6880&#39;,&#39;CampMuir_10110&#39;) MtRainier_Solar$hr &lt;- hour(MtRainier_Solar$datetime) MtRainier_Solar$minute &lt;- minute(MtRainier_Solar$datetime) MtRainier_Solar$day &lt;- day(MtRainier_Solar$datetime) MtRainier_Solar$month&lt;- month(MtRainier_Solar$datetime) MtRainier_Solar$year&lt;- year(MtRainier_Solar$datetime) MtRainier_Solar %&gt;% filter(month == 9 &amp; year== 2018 &amp; day == 10) %&gt;% ggplot() + geom_line(aes(datetime,Paradise_5400,col=&#39;1645&#39;)) + geom_line(aes(datetime,Sunrise_6880,col=&#39;2097&#39;)) + geom_line(aes(datetime,CampMuir_10110,col=&#39;3081&#39;)) + theme_classic() + labs(x=&quot;Date&quot;, y=&quot;Solar radiation(W/m2) &quot;,subtitle=&quot;Met stations - Mt Rainier Solar &quot;, caption=&quot;Data Source : http://nanoclimate.org&quot;) + geom_hline(aes(yintercept=9),colour=&quot;black&quot;, linetype=&quot;dashed&quot;) + scale_colour_manual(name = &#39;Heights(m)&#39;, values =c(&#39;red&#39;,&#39;blue&#39;,&#39;green&#39;), labels = c(&#39;1645&#39;,&#39;2097&#39;,&quot;3081&quot;)) Lets look for whole of September MtRainier_Solar &lt;- read_csv(&#39;./data/mt-rainier_solar_pyranometer_2018.csv&#39;) ## Parsed with column specification: ## cols( ## `Date/Time (PST)` = col_datetime(format = &quot;&quot;), ## `W/m2 - 5380&#39; - Paradise Wind` = col_double(), ## `W/m2 - 6880&#39; - Sunrise Upper` = col_double(), ## `W/m2 - 10110&#39; - Camp Muir` = col_double() ## ) colnames(MtRainier_Solar) &lt;- c(&#39;datetime&#39;,&#39;Paradise_5400&#39;,&#39;Sunrise_6880&#39;,&#39;CampMuir_10110&#39;) MtRainier_Solar$hr &lt;- hour(MtRainier_Solar$datetime) MtRainier_Solar$minute &lt;- minute(MtRainier_Solar$datetime) MtRainier_Solar$day &lt;- day(MtRainier_Solar$datetime) MtRainier_Solar$month&lt;- month(MtRainier_Solar$datetime) MtRainier_Solar$year&lt;- year(MtRainier_Solar$datetime) MtRainier_Solar %&gt;% filter(month == 9 &amp; year== 2018 ) %&gt;% ggplot() + geom_line(aes(datetime,Paradise_5400,col=&#39;1645&#39;)) + geom_line(aes(datetime,Sunrise_6880,col=&#39;2097&#39;)) + geom_line(aes(datetime,CampMuir_10110,col=&#39;3081&#39;)) + theme_classic() + labs(x=&quot;Date&quot;, y=&quot;Solar radiation(W/m2) &quot;,subtitle=&quot;Met stations - Mt Rainier Solar &quot;, caption=&quot;Data Source : http://nanoclimate.org&quot;) + geom_hline(aes(yintercept=9),colour=&quot;black&quot;, linetype=&quot;dashed&quot;) + scale_colour_manual(name = &#39;Heights(m)&#39;, values =c(&#39;red&#39;,&#39;blue&#39;,&#39;green&#39;), labels = c(&#39;1645&#39;,&#39;2097&#39;,&quot;3081&quot;)) Highest elevation crowding,lets take it out MtRainier_Solar &lt;- read_csv(&#39;./data/mt-rainier_solar_pyranometer_2018.csv&#39;) ## Parsed with column specification: ## cols( ## `Date/Time (PST)` = col_datetime(format = &quot;&quot;), ## `W/m2 - 5380&#39; - Paradise Wind` = col_double(), ## `W/m2 - 6880&#39; - Sunrise Upper` = col_double(), ## `W/m2 - 10110&#39; - Camp Muir` = col_double() ## ) colnames(MtRainier_Solar) &lt;- c(&#39;datetime&#39;,&#39;Paradise_5400&#39;,&#39;Sunrise_6880&#39;,&#39;CampMuir_10110&#39;) MtRainier_Solar$hr &lt;- hour(MtRainier_Solar$datetime) MtRainier_Solar$minute &lt;- minute(MtRainier_Solar$datetime) MtRainier_Solar$day &lt;- day(MtRainier_Solar$datetime) MtRainier_Solar$month&lt;- month(MtRainier_Solar$datetime) MtRainier_Solar$year&lt;- year(MtRainier_Solar$datetime) MtRainier_Solar %&gt;% filter(month == 9 &amp; year== 2018 ) %&gt;% ggplot() + geom_line(aes(datetime,Paradise_5400,col=&#39;1645&#39;)) + geom_line(aes(datetime,Sunrise_6880,col=&#39;2097&#39;)) + theme_classic() + labs(x=&quot;Date&quot;, y=&quot;Solar radiation(W/m2) &quot;,subtitle=&quot;Met stations - Mt Rainier Solar &quot;, caption=&quot;Data Source : http://nanoclimate.org&quot;) + geom_hline(aes(yintercept=9),colour=&quot;black&quot;, linetype=&quot;dashed&quot;) + scale_colour_manual(name = &#39;Heights(m)&#39;, values =c(&#39;red&#39;,&#39;blue&#39;,&#39;green&#39;), labels = c(&#39;1645&#39;,&#39;2097&#39;,&quot;3081&quot;)) Day in, selective days, again the solar insolation although highest at higher elevastions, not really a function of elevation MtRainier_Solar &lt;- read_csv(&#39;./data/mt-rainier_solar_pyranometer_2018.csv&#39;) ## Parsed with column specification: ## cols( ## `Date/Time (PST)` = col_datetime(format = &quot;&quot;), ## `W/m2 - 5380&#39; - Paradise Wind` = col_double(), ## `W/m2 - 6880&#39; - Sunrise Upper` = col_double(), ## `W/m2 - 10110&#39; - Camp Muir` = col_double() ## ) colnames(MtRainier_Solar) &lt;- c(&#39;datetime&#39;,&#39;Paradise_5400&#39;,&#39;Sunrise_6880&#39;,&#39;CampMuir_10110&#39;) MtRainier_Solar$hr &lt;- hour(MtRainier_Solar$datetime) MtRainier_Solar$minute &lt;- minute(MtRainier_Solar$datetime) MtRainier_Solar$day &lt;- day(MtRainier_Solar$datetime) MtRainier_Solar$month&lt;- month(MtRainier_Solar$datetime) MtRainier_Solar$year&lt;- year(MtRainier_Solar$datetime) MtRainier_Solar %&gt;% filter(month == 9 &amp; year== 2018 &amp; day %in% c(10,11,12,13,14) ) %&gt;% ggplot() + geom_line(aes(datetime,Paradise_5400,col=&#39;1645&#39;)) + geom_line(aes(datetime,Sunrise_6880,col=&#39;2097&#39;)) + geom_line(aes(datetime,CampMuir_10110,col=&#39;3081&#39;)) + theme_classic() + labs(x=&quot;Date&quot;, y=&quot;Solar radiation(W/m2) &quot;,subtitle=&quot;Met stations - Mt Rainier Solar - 2018&quot;, caption=&quot;Data Source : http://nanoclimate.org&quot;) + geom_hline(aes(yintercept=9),colour=&quot;black&quot;, linetype=&quot;dashed&quot;) + scale_colour_manual(name = &#39;Heights(m)&#39;, values =c(&#39;red&#39;,&#39;blue&#39;,&#39;green&#39;), labels = c(&#39;1645&#39;,&#39;2097&#39;,&quot;3081&quot;)) Lets read in A1 temps , plotting only September 2016 MtRainier_AE10A1_1617 &lt;- read_csv(&#39;./data/AE10-A1-061616-062717.csv&#39;) ## Parsed with column specification: ## cols( ## `#` = col_double(), ## `Date Time, GMT-07:00` = col_character(), ## `Temp, °C (LGR S/N: 10620921, SEN S/N: 10620921)` = col_double(), ## `Coupler Attached (LGR S/N: 10620921)` = col_logical(), ## `Host Connected (LGR S/N: 10620921)` = col_logical(), ## `Coupler Detached (LGR S/N: 10620921)` = col_logical(), ## `Stopped (LGR S/N: 10620921)` = col_logical(), ## `End Of File (LGR S/N: 10620921)` = col_logical() ## ) colnames(MtRainier_AE10A1_1617) &lt;- c(&#39;#&#39;,&#39;datetime&#39;,&#39;Temp&#39;,&#39;CoupAttach&#39;,&#39;HostConn&#39;,&#39;CoupDeAttach&#39;,&#39;Stopped&#39;,&#39;eof&#39;) MtRainier_AE10A1_1617$timect &lt;- as.POSIXct(MtRainier_AE10A1_1617$datetime, format=&quot;%m/%d/%y %I:%M:%S %p&quot;,tz=&quot;America/Los_Angeles&quot;) MtRainier_AE10A1_1617$hr &lt;- hour(MtRainier_AE10A1_1617$timect) MtRainier_AE10A1_1617$minute &lt;- minute(MtRainier_AE10A1_1617$timect) MtRainier_AE10A1_1617$day &lt;- day(MtRainier_AE10A1_1617$timect) MtRainier_AE10A1_1617$month&lt;- month(MtRainier_AE10A1_1617$timect) MtRainier_AE10A1_1617$year&lt;- year(MtRainier_AE10A1_1617$timect) MtRainier_AE10A1_1617 %&gt;% filter(month == 9 &amp; year== 2016 &amp; day %in% c(10,11,12,13,14) ) %&gt;% ggplot() + geom_point(aes(timect,Temp,col=&#39;A1&#39;)) + geom_line(aes(timect,Temp)) + theme_classic() + labs(x=&quot;Date&quot;, y=&quot;Temperature(°C) &quot;,subtitle=&quot;Air hobo AE10 A1 - Mt Rainie -Recorded every 2 hours (2016) &quot;, caption=&quot;Data Source : JHRL&quot;) + geom_hline(aes(yintercept=9),colour=&quot;black&quot;, linetype=&quot;dashed&quot;) + scale_colour_manual(name = &#39;Heights(m)&#39;, values =c(&#39;red&#39;,&#39;blue&#39;,&#39;green&#39;), labels = c(&#39;1645&#39;,&#39;2097&#39;,&quot;3081&quot;)) Lets read in A1 temps , plotting only September 2017 MtRainier_AE10A1_1718 &lt;- read_csv(&#39;./data/AE10-A1-062817-072818.csv&#39;) ## Parsed with column specification: ## cols( ## `#` = col_double(), ## `Date Time, GMT-07:00` = col_character(), ## `Temp, °C (LGR S/N: 10620922, SEN S/N: 10620922)` = col_double(), ## `Coupler Attached (LGR S/N: 10620922)` = col_logical(), ## `Host Connected (LGR S/N: 10620922)` = col_logical(), ## `Stopped (LGR S/N: 10620922)` = col_logical(), ## `End Of File (LGR S/N: 10620922)` = col_logical() ## ) colnames(MtRainier_AE10A1_1718) &lt;- c(&#39;#&#39;,&#39;datetime&#39;,&#39;Temp&#39;,&#39;CoupAttach&#39;,&#39;HostConn&#39;,&#39;Stopped&#39;,&#39;eof&#39;) MtRainier_AE10A1_1718$timect &lt;- as.POSIXct(MtRainier_AE10A1_1718$datetime, format=&quot;%m/%d/%y %I:%M:%S %p&quot;,tz=&quot;America/Los_Angeles&quot;) #MtRainier_AE10A1_1718$timect &lt;- as.POSIXct(MtRainier_AE10A1_1718$datetime, format=&quot;%m/%d/%y %I:%M:%S %p&quot;,tz=&quot;America/Los_Angeles&quot;) MtRainier_AE10A1_1718$hr &lt;- hour(MtRainier_AE10A1_1718$timect) MtRainier_AE10A1_1718$minute &lt;- minute(MtRainier_AE10A1_1718$timect) MtRainier_AE10A1_1718$day &lt;- day(MtRainier_AE10A1_1718$timect) MtRainier_AE10A1_1718$month&lt;- month(MtRainier_AE10A1_1718$timect) MtRainier_AE10A1_1718$year&lt;- year(MtRainier_AE10A1_1718$timect) MtRainier_AE10A1_1718 %&gt;% filter(month == 9 &amp; year== 2017 &amp; day %in% c(10,11,12,13,14) ) %&gt;% ggplot() + geom_point(aes(timect,Temp,col=&#39;A1&#39;)) + geom_line(aes(timect,Temp)) + theme_classic() + labs(x=&quot;Date&quot;, y=&quot;Temperature(°C) &quot;,subtitle=&quot;Air hobo AE10 A1 - Mt Rainie -Recorded every 2 hours (2017) &quot;, caption=&quot;Data Source : JHRL&quot;) + geom_hline(aes(yintercept=9),colour=&quot;black&quot;, linetype=&quot;dashed&quot;) + scale_colour_manual(name = &#39;Heights(m)&#39;, values =c(&#39;red&#39;,&#39;blue&#39;,&#39;green&#39;), labels = c(&#39;1645&#39;,&#39;2097&#39;,&quot;3081&quot;)) How does Sept compare to Paradise (2017) # read in Paradise MtRainier_Local_2017&lt;- read_csv(&#39;./data/mt-rainier_temperature_2017.csv&#39;) ## Parsed with column specification: ## cols( ## `Date/Time (PST)` = col_datetime(format = &quot;&quot;), ## `deg F - 5400&#39; - Paradise` = col_double(), ## `deg F - 6410&#39; - Sunrise Base` = col_double(), ## `deg F - 6880&#39; - Sunrise Upper` = col_double(), ## `deg F - 10110&#39; - Camp Muir` = col_double() ## ) colnames(MtRainier_Local_2017) &lt;- c(&#39;datetime&#39;,&#39;Paradise_5400&#39;,&#39;Sunrise_6410&#39;,&#39;Sunrise_6880&#39;,&#39;CampMuir_10110&#39;) MtRainier_Local_2017$hr &lt;- hour(MtRainier_Local_2017$datetime) MtRainier_Local_2017$minute &lt;- minute(MtRainier_Local_2017$datetime) MtRainier_Local_2017$day &lt;- day(MtRainier_Local_2017$datetime) MtRainier_Local_2017$month&lt;- month(MtRainier_Local_2017$datetime) MtRainier_Local_2017$year&lt;- year(MtRainier_Local_2017$datetime) MtRainier_Local_2017 %&gt;% filter(month == 9 &amp; year== 2017 ) %&gt;% ggplot() + geom_line(aes(datetime,weathermetrics::fahrenheit.to.celsius(Paradise_5400),col=&#39;1645&#39;)) + geom_line(aes(datetime,weathermetrics::fahrenheit.to.celsius(Sunrise_6410),col=&#39;1953&#39;)) + geom_line(aes(datetime,weathermetrics::fahrenheit.to.celsius(Sunrise_6880),col=&#39;2097&#39;)) + geom_line(aes(datetime,weathermetrics::fahrenheit.to.celsius(CampMuir_10110),col=&#39;3081&#39;)) + theme_classic() + labs(x=&quot;Date&quot;, y=&quot;Temperature(°C) &quot;,subtitle=&quot;Met stations - Mt Rainier Hourly readings (2017) &quot;, caption=&quot;Data Source : http://nwac.us&quot;) + scale_colour_manual(name = &#39;Heights(m)&#39;, values =c(&#39;1&#39;,&#39;2&#39;,&#39;3&#39;,&#39;4&#39;), labels = c(&#39;1645&#39;,&#39;1953&#39;,&quot;2097&quot;,&quot;3081&quot;)) + geom_hline(aes(yintercept=9),colour=&quot;black&quot;, linetype=&quot;dashed&quot;) MtRainier_AE10A1_1718 &lt;- read_csv(&#39;./data/AE10-A1-062817-072818.csv&#39;) ## Parsed with column specification: ## cols( ## `#` = col_double(), ## `Date Time, GMT-07:00` = col_character(), ## `Temp, °C (LGR S/N: 10620922, SEN S/N: 10620922)` = col_double(), ## `Coupler Attached (LGR S/N: 10620922)` = col_logical(), ## `Host Connected (LGR S/N: 10620922)` = col_logical(), ## `Stopped (LGR S/N: 10620922)` = col_logical(), ## `End Of File (LGR S/N: 10620922)` = col_logical() ## ) colnames(MtRainier_AE10A1_1718) &lt;- c(&#39;#&#39;,&#39;datetime&#39;,&#39;Temp&#39;,&#39;CoupAttach&#39;,&#39;HostConn&#39;,&#39;Stopped&#39;,&#39;eof&#39;) MtRainier_AE10A1_1718$timect &lt;- as.POSIXct(MtRainier_AE10A1_1718$datetime, format=&quot;%m/%d/%y %I:%M:%S %p&quot;,tz=&quot;America/Los_Angeles&quot;) MtRainier_AE10A1_1718$hr &lt;- hour(MtRainier_AE10A1_1718$timect) MtRainier_AE10A1_1718$minute &lt;- minute(MtRainier_AE10A1_1718$timect) MtRainier_AE10A1_1718$day &lt;- day(MtRainier_AE10A1_1718$timect) MtRainier_AE10A1_1718$month&lt;- month(MtRainier_AE10A1_1718$timect) MtRainier_AE10A1_1718$year&lt;- year(MtRainier_AE10A1_1718$timect) MtRainier_AE10A1_1718 %&gt;% filter(month == 9 &amp; year== 2017 ) %&gt;% ggplot() + geom_point(aes(timect,Temp,col=&#39;A1&#39;)) + geom_line(aes(timect,Temp)) + theme_classic() + labs(x=&quot;Date&quot;, y=&quot;Temperature(°C) &quot;,subtitle=&quot;Air hobo AE10 A1 - Mt Rainie -Recorded every 2 hours (2017) &quot;, caption=&quot;Data Source : JHRL&quot;) + geom_hline(aes(yintercept=9),colour=&quot;black&quot;, linetype=&quot;dashed&quot;) + scale_colour_manual(name = &#39;Heights(m)&#39;, values =c(&#39;red&#39;,&#39;blue&#39;,&#39;green&#39;), labels = c(&#39;1645&#39;,&#39;2097&#39;,&quot;3081&quot;)) Combine whole month with A1 # read in Paradise MtRainier_Local_2017 %&gt;% filter(month == 9 &amp; year== 2017 ) %&gt;% ggplot() + geom_line(aes(datetime,weathermetrics::fahrenheit.to.celsius(Paradise_5400),col=&#39;1645&#39;)) + geom_line(aes(datetime,weathermetrics::fahrenheit.to.celsius(Sunrise_6410),col=&#39;1953&#39;)) + geom_line(aes(datetime,weathermetrics::fahrenheit.to.celsius(Sunrise_6880),col=&#39;2097&#39;)) + geom_line(aes(datetime,weathermetrics::fahrenheit.to.celsius(CampMuir_10110),col=&#39;3081&#39;)) + geom_line(data=MtRainier_AE10A1_1718[MtRainier_AE10A1_1718$month == 9 &amp; MtRainier_AE10A1_1718$year== 2017,],aes(timect,Temp,col=&#39;1450&#39;)) + theme_classic() + labs(x=&quot;Date&quot;, y=&quot;Temperature(°C) &quot;, color = &quot;Height (m)&quot;, subtitle=&quot;Met stations and A1- Mt Rainier Hourly readings (2017) &quot;, caption=&quot;Data Source : http://nwac.us&quot;) + geom_hline(aes(yintercept=9),colour=&quot;black&quot;, linetype=&quot;dashed&quot;) Combine whole month with A1 selective days # read in Paradise MtRainier_AE10A1_1718$timectdiff2 &lt;- MtRainier_AE10A1_1718$timect - lubridate::hours(2) MtRainier_Local_2017 %&gt;% filter(month == 9 &amp; year== 2017 &amp; day %in% c(1,2,3,4,5,10,11,12,13,14,15) ) %&gt;% ggplot() + geom_line(aes(datetime,weathermetrics::fahrenheit.to.celsius(Paradise_5400),col=&#39;1645&#39;)) + geom_line(aes(datetime,weathermetrics::fahrenheit.to.celsius(Sunrise_6410),col=&#39;1953&#39;)) + geom_line(aes(datetime,weathermetrics::fahrenheit.to.celsius(Sunrise_6880),col=&#39;2097&#39;)) + geom_line(aes(datetime,weathermetrics::fahrenheit.to.celsius(CampMuir_10110),col=&#39;3081&#39;)) + geom_line(data=MtRainier_AE10A1_1718[MtRainier_AE10A1_1718$month == 9 &amp; MtRainier_AE10A1_1718$year== 2017 &amp; MtRainier_AE10A1_1718$day %in% c(1,2,3,4,5,10,11,12,13,14,15) ,],aes(timectdiff2,Temp,col=&#39;1450&#39;)) + theme_classic() + labs(x=&quot;Date&quot;, y=&quot;Temperature(°C) &quot;, color = &quot;Height (m)&quot;, subtitle=&quot;Met stations and A1- Mt Rainier Hourly readings (2017) &quot;, caption=&quot;Data Source : http://nwac.us&quot;) + geom_hline(aes(yintercept=9),colour=&quot;black&quot;, linetype=&quot;dashed&quot;) Combine whole month with A1 2017 # read in Paradise MtRainier_Local_2017 %&gt;% filter(year== 2017) %&gt;% ggplot() + geom_line(aes(datetime,weathermetrics::fahrenheit.to.celsius(Paradise_5400),col=&#39;1645&#39;)) + geom_line(aes(datetime,weathermetrics::fahrenheit.to.celsius(Sunrise_6410),col=&#39;1953&#39;)) + geom_line(aes(datetime,weathermetrics::fahrenheit.to.celsius(Sunrise_6880),col=&#39;2097&#39;)) + geom_line(aes(datetime,weathermetrics::fahrenheit.to.celsius(CampMuir_10110),col=&#39;3081&#39;)) + geom_line(data=MtRainier_AE10A1_1718[MtRainier_AE10A1_1718$year== 2017 ,],aes(timect,Temp,col=&#39;1450&#39;)) + theme_classic() + labs(x=&quot;Date&quot;, y=&quot;Temperature(°C) &quot;, color = &quot;Height (m)&quot;, subtitle=&quot;Met stations and A1- Mt Rainier Hourly readings (2017) &quot;, caption=&quot;Data Source : http://nwac.us&quot;) + geom_hline(aes(yintercept=9),colour=&quot;black&quot;, linetype=&quot;dashed&quot;) ## 1-04-2019 Plotting the min and max of the coop and snotel MtRainier_coopsnowsep_longmire &lt;- read_csv(&#39;./data/UCC_ghcn_Longmire.csv&#39;,comment = &#39;#&#39;) ## Parsed with column specification: ## cols( ## Day = col_date(format = &quot;&quot;), ## Precipitation = col_character(), ## Min_Temperature = col_character(), ## Max_Temperature = col_character() ## ) MtRainier_coopsnowsep_skatecreek &lt;- read_csv(&#39;./data/UCC_ghcn_SkateCreek.csv&#39;,comment = &#39;#&#39;) ## Parsed with column specification: ## cols( ## Day = col_date(format = &quot;&quot;), ## Precipitation = col_character(), ## Min_Temperature = col_character(), ## Max_Temperature = col_character() ## ) MtRainier_coopsnowsep_Paradise &lt;- read_csv(&#39;./data/UCC_ghcn_Paradise.csv&#39;,comment = &#39;#&#39;) ## Parsed with column specification: ## cols( ## Day = col_date(format = &quot;&quot;), ## Precipitation = col_character(), ## Min_Temperature = col_character(), ## Max_Temperature = col_character() ## ) MtRainier_coopsnowsep_longmire$day &lt;- day(MtRainier_coopsnowsep_longmire$Day) MtRainier_coopsnowsep_longmire$month&lt;- month(MtRainier_coopsnowsep_longmire$Day) MtRainier_coopsnowsep_longmire$year&lt;- year(MtRainier_coopsnowsep_longmire$Day) MtRainier_coopsnowsep_longmire %&gt;% filter(year== 2018) %&gt;% ggplot() + geom_line(aes(Day,as.numeric(Min_Temperature),col=&#39;1&#39;)) + geom_line(aes(Day,as.numeric(Max_Temperature),col=&#39;2&#39;)) + geom_line(data=MtRainier_coopsnowsep_skatecreek,aes(Day,as.numeric(Min_Temperature),col=&#39;3&#39;)) + geom_line(data=MtRainier_coopsnowsep_skatecreek,aes(Day,as.numeric(Max_Temperature),col=&#39;4&#39;)) + geom_line(data=MtRainier_coopsnowsep_Paradise,aes(Day,as.numeric(Min_Temperature),col=&#39;5&#39;)) + geom_line(data=MtRainier_coopsnowsep_Paradise,aes(Day,as.numeric(Max_Temperature),col=&#39;6&#39;)) + theme_classic() + labs(x=&quot;Date&quot;, y=&quot;Temperature(°C) &quot;,subtitle=&quot;Coop/Snotel - Mt Rainier- Minimum/Max Recorded every day (2018) &quot;, caption=&quot;Data Source : utah state climate center&quot;) + geom_hline(aes(yintercept=9),colour=&quot;black&quot;, linetype=&quot;dashed&quot;) + scale_colour_manual(name = &#39;Heights(m)&#39;, values =c(&#39;1&#39;,&#39;2&#39;,&#39;3&#39;,&#39;4&#39;,&#39;5&#39;,&#39;6&#39;), labels = c(&#39;841(Longmire)-Min &#39;,&#39;841(Longmire)-Max &#39;,&#39;1149(Skatecreek)-Min&#39;,&#39;1149(Skatecreek)-Max&#39;,&quot;1654(Paradise)-Min&quot;,&quot;1654(Paradise)-Max&quot;)) Looking at AG05 which is near Longmire Lets look at one site mclim_AG05_TN01_2018&lt;- read.csv(&#39;./data/DATALOG-AG05-TN01.CSV&#39;) names(mclim_AG05_TN01_2018) &lt;- c(&#39;time&#39;,&#39;nodeid&#39;,&#39;temp&#39;,&#39;batt&#39;) mclim_AG05_TN01_2018$time &lt;- as.POSIXct(mclim_AG05_TN01_2018$time, &quot;%Y/%m/%d %H:%M:%S&quot;) #Add hour month and day ## 11-05-2018 mclim_AG05_TN01_2018$hr &lt;- hour(mclim_AG05_TN01_2018$time) mclim_AG05_TN01_2018$minute&lt;- minute(mclim_AG05_TN01_2018$time) mclim_AG05_TN01_2018$day &lt;- day(mclim_AG05_TN01_2018$time) mclim_AG05_TN01_2018$month&lt;- month(mclim_AG05_TN01_2018$time) #Roughly one feet apart mclim_AG05_TN01_2018$height &lt;- 0 mclim_AG05_TN01_2018[mclim_AG05_TN01_2018$nodeid==&#39;28E21777910602CF&#39; ,]$height &lt;- 0.6 mclim_AG05_TN01_2018[mclim_AG05_TN01_2018$nodeid==&#39;28DE0577910A02ED&#39; ,]$height &lt;- 1.2 mclim_AG05_TN01_2018[mclim_AG05_TN01_2018$nodeid==&#39;2851BA7791090256&#39; ,]$height &lt;- 0.3 mclim_AG05_TN01_2018[mclim_AG05_TN01_2018$nodeid==&#39;2885827791080230&#39; ,]$height &lt;- 0.9 ## Day plot , Representive day mclim_AG05_TN01_2018 %&gt;% filter(month(time) %in% &#39;9&#39;) %&gt;% ggplot( aes(time,temp,color = factor(height))) + geom_line() + theme_minimal() + ggtitle(&quot;Variation in temperature at AG05- Open&quot;) + xlab(&quot;Date&quot;) + ylab(&quot;Temperature (°C)&quot;) + labs(colour = &quot;Height(m)&quot;, subtitle=&quot;9/17/2018&quot;,caption=&quot;Data Source : http://nanoclimate.org&quot;) Plot Longmire and Micromet # take height 1.2 mclim_AG05_TN01_2018 %&gt;% filter(month(time) %in% &#39;9&#39; &amp; height == 1.2) %&gt;% group_by(month,day) %&gt;% mutate(minT = min(temp),maxT=max(temp)) %&gt;% ggplot() + geom_point(aes(day,minT,col=&#39;1&#39;)) + geom_point(aes(day,maxT,col=&#39;2&#39;)) + geom_line(data=MtRainier_coopsnowsep_longmire[MtRainier_coopsnowsep_longmire$month==9,],aes(day,as.numeric(Min_Temperature),col=&#39;3&#39;)) + geom_line(data=MtRainier_coopsnowsep_longmire[MtRainier_coopsnowsep_longmire$month==9,],aes(day,as.numeric(Max_Temperature),col=&#39;4&#39;)) + theme_minimal() + ggtitle(&quot;Variation in temperature at AG05 TN01- Closed with Longmire&quot;) + xlab(&quot;Date&quot;) + ylab(&quot;Temperature (°C)&quot;) + labs(colour = &quot;Height(m)&quot;, subtitle=&quot;&quot;,caption=&quot;Data Source : http://nanoclimate.org&quot;) + geom_hline(aes(yintercept=9),colour=&quot;black&quot;, linetype=&quot;dashed&quot;) + scale_colour_manual(name = &#39;Heights(m)&#39;, values =c(&#39;1&#39;,&#39;2&#39;,&#39;3&#39;,&#39;4&#39;), labels = c(&#39;MM-921(Longmire)-Min &#39;,&#39;MM-921(Longmire)-Max &#39;,&#39;841(Longmire)-Min&#39;,&#39;841(Longmire)-Max&#39;)) Validation amb_4&lt;- read_csv(&#39;./data/ambient-weather-4.csv&#39;) ## Parsed with column specification: ## cols( ## .default = col_double(), ## Datetime = col_character() ## ) ## See spec(...) for full column specifications. amb_5&lt;- read_csv(&#39;./data/ambient-weather-5.csv&#39;) ## Parsed with column specification: ## cols( ## .default = col_double(), ## Datetime = col_character() ## ) ## See spec(...) for full column specifications. amb_6&lt;- read_csv(&#39;./data/ambient-weather-6.csv&#39;) ## Parsed with column specification: ## cols( ## .default = col_double(), ## Datetime = col_character() ## ) ## See spec(...) for full column specifications. amb_7&lt;- read_csv(&#39;./data/ambient-weather-7.csv&#39;) ## Parsed with column specification: ## cols( ## .default = col_double(), ## Datetime = col_character() ## ) ## See spec(...) for full column specifications. amb_8&lt;- read_csv(&#39;./data/ambient-weather-8.csv&#39;) ## Parsed with column specification: ## cols( ## .default = col_double(), ## Datetime = col_character() ## ) ## See spec(...) for full column specifications. amb_9&lt;- read_csv(&#39;./data/ambient-weather-9.csv&#39;) ## Parsed with column specification: ## cols( ## .default = col_double(), ## Datetime = col_character() ## ) ## See spec(...) for full column specifications. amb_10&lt;- read_csv(&#39;./data/ambient-weather-10.csv&#39;) ## Parsed with column specification: ## cols( ## .default = col_double(), ## Datetime = col_character() ## ) ## See spec(...) for full column specifications. amb_11&lt;- read_csv(&#39;./data/ambient-weather-11.csv&#39;) ## Parsed with column specification: ## cols( ## .default = col_double(), ## Datetime = col_character() ## ) ## See spec(...) for full column specifications. amb_12&lt;- read_csv(&#39;./data/ambient-weather-12.csv&#39;) ## Parsed with column specification: ## cols( ## .default = col_double(), ## Datetime = col_character() ## ) ## See spec(...) for full column specifications. amb_13&lt;- read_csv(&#39;./data/ambient-weather-13.csv&#39;) ## Parsed with column specification: ## cols( ## .default = col_double(), ## Datetime = col_character() ## ) ## See spec(...) for full column specifications. amb_14&lt;- read_csv(&#39;./data/ambient-weather-14.csv&#39;) ## Parsed with column specification: ## cols( ## .default = col_double(), ## Datetime = col_character() ## ) ## See spec(...) for full column specifications. amb_15&lt;- read_csv(&#39;./data/ambient-weather-15.csv&#39;) ## Parsed with column specification: ## cols( ## .default = col_double(), ## Datetime = col_character() ## ) ## See spec(...) for full column specifications. amb_16&lt;- read_csv(&#39;./data/ambient-weather-16.csv&#39;) ## Parsed with column specification: ## cols( ## .default = col_double(), ## Datetime = col_character() ## ) ## See spec(...) for full column specifications. amb_17&lt;- read_csv(&#39;./data/ambient-weather-17.csv&#39;) ## Parsed with column specification: ## cols( ## .default = col_double(), ## Datetime = col_character() ## ) ## See spec(...) for full column specifications. amb_18&lt;- read_csv(&#39;./data/ambient-weather-18.csv&#39;) ## Parsed with column specification: ## cols( ## .default = col_double(), ## Datetime = col_character() ## ) ## See spec(...) for full column specifications. amb_19&lt;- read_csv(&#39;./data/ambient-weather-19.csv&#39;) ## Parsed with column specification: ## cols( ## .default = col_double(), ## Datetime = col_character() ## ) ## See spec(...) for full column specifications. amb_20&lt;- read_csv(&#39;./data/ambient-weather-20.csv&#39;) ## Parsed with column specification: ## cols( ## .default = col_double(), ## Datetime = col_character() ## ) ## See spec(...) for full column specifications. amb &lt;- bind_rows(amb_4, amb_5,amb_6,.id = NULL) names(amb) &lt;- c(&#39;Datetime&#39;,&#39;Wind_Direction&#39;,&#39;Wind_Speed&#39;,&#39;Wind_Gust&#39;,&#39;Max_Daily_Gust&#39;,&#39;Outdoor_Temperature&#39;,&#39;Hourly_Rain&#39;,&#39;Event_Rain&#39;,&#39;Daily_Rain&#39;,&#39;Weekly_Rain&#39;,&#39;Monthly_Rain&#39;,&#39;Total_Rain&#39;,&#39;Relative_Pressure&#39;,&#39;Absolute_Pressure&#39;,&#39;Outdoor_Humidity&#39;,&#39;Indoor_Temperature&#39;,&#39;Indoor_Humidity&#39;,&#39;Ultra-Violet_Radiation_Index&#39;,&#39;Solar_Radiation&#39;,&#39;Feels_Like&#39;,&#39;Dew-Point&#39;) amb$time &lt;- as.POSIXct(amb$Datetime, format=&quot;%m/%d/%Y %I:%M %p&quot;,tz=&quot;America/Los_Angeles&quot;) amb$hr &lt;- hour(amb$time) amb$minute&lt;- minute(amb$time) amb$day &lt;- day(amb$time) amb$month&lt;- month(amb$time) amb %&gt;% ggplot() + geom_point(aes(time,Outdoor_Temperature ,col=&#39;1&#39;)) + geom_line(aes(time,Outdoor_Temperature)) + theme_minimal() + ggtitle(&quot;Variation in temperature at AG05 TN01- Closed with Longmire&quot;) + xlab(&quot;Date&quot;) + ylab(&quot;Temperature (°C)&quot;) + labs(colour = &quot;Height(m)&quot;, subtitle=&quot;&quot;,caption=&quot;Data Source : http://nanoclimate.org&quot;) + geom_hline(aes(yintercept=9),colour=&quot;black&quot;, linetype=&quot;dashed&quot;) + scale_colour_manual(name = &#39;Heights(m)&#39;, values =c(&#39;1&#39;,&#39;2&#39;,&#39;3&#39;,&#39;4&#39;), labels = c(&#39;MM-Ambient &#39;,&#39;MM-921(Longmire)-Max &#39;,&#39;841(Longmire)-Min&#39;,&#39;841(Longmire)-Max&#39;)) 8.24 1-9-2019 Temperature profile (Diel), daily vs weekly library(RColorBrewer) mclim_AE10_CN01_2018 %&gt;% filter (!is.na(mclim_AE10_CN01_2018$minute) &amp; month %in% c(9) ) %&gt;% filter( day &gt; 9 &amp; day &lt; 15) %&gt;% group_by(month,day,hr) %&gt;% add_count(wt=3) %&gt;% summarise(m1= mean(temp1)) %&gt;% group_by(day,hr) %&gt;% ggplot() + geom_line(aes(hr,m1,group=day ,color=as.factor(day),linetype = &#39;1.2&#39;),se=F)+ scale_colour_manual(&quot;Temperature on day&quot;, breaks = c(&quot;10&quot;,&quot;11&quot;, &quot;12&quot;,&quot;13&quot;,&quot;14&quot;), values = brewer.pal(5, &quot;Set1&quot;)) + scale_linetype_manual(&quot;Height(m)&quot;,values=c(&quot;1.2&quot;=1)) + theme_classic() + ggtitle(&quot;Diel Variation in temperature at 1.2m at site AE10 (1450m)&quot;) + xlab(&quot;Hour&quot;) + ylab(&quot;Temperature (°C)&quot;) + labs(colour = &quot;Hour&quot;, subtitle=&quot;9/10/18 - 9/14/19&quot;,caption=&quot;Data Source : http://www.nanoclimate.org&quot;) Comparing it to Paradise library(RColorBrewer) MtRainier_Local_2017 %&gt;% filter (month %in% c(9) ) %&gt;% filter( day &gt; 9 &amp; day &lt; 15) %&gt;% group_by(day,hr) %&gt;% ggplot() + geom_line(aes(hr,weathermetrics::fahrenheit.to.celsius(Paradise_5400),group=day ,color=as.factor(day))) + scale_colour_manual(&quot;Temperature on day&quot;, breaks = c(&quot;10&quot;,&quot;11&quot;, &quot;12&quot;,&quot;13&quot;,&quot;14&quot;), values = brewer.pal(5, &quot;Set1&quot;)) + theme_classic() + ggtitle(&quot;Diel Variation in temperature at site Paradise (1645m) &quot;) + xlab(&quot;Hour&quot;) + ylab(&quot;Temperature (°C)&quot;) + labs(colour = &quot;Hour&quot;, subtitle=&quot;9/10/18 - 9/14/19&quot;,caption=&quot;Data Source : http://www.nwac.org&quot;) Comparing it to Sunrise Base library(RColorBrewer) MtRainier_Local_2017 %&gt;% filter (month %in% c(9) ) %&gt;% filter( day &gt; 9 &amp; day &lt; 15) %&gt;% group_by(day,hr) %&gt;% ggplot() + geom_line(aes(hr,weathermetrics::fahrenheit.to.celsius(Sunrise_6410),group=day ,color=as.factor(day))) + scale_colour_manual(&quot;Temperature on day&quot;, breaks = c(&quot;10&quot;,&quot;11&quot;, &quot;12&quot;,&quot;13&quot;,&quot;14&quot;), values = brewer.pal(5, &quot;Set1&quot;)) + theme_classic() + ggtitle(&quot;Diel Variation in temperature at site Sunrise Base (1953m) &quot;) + xlab(&quot;Hour&quot;) + ylab(&quot;Temperature (°C)&quot;) + labs(colour = &quot;Hour&quot;, subtitle=&quot;9/10/18 - 9/14/19&quot;,caption=&quot;Data Source : http://www.nwac.org&quot;) Need to add interpolated for Longmire. Onto Radiation, use AE10-CN01 mclim_AE10_CN01_2018 %&gt;% filter (!is.na(mclim_AE10_CN01_2018$minute) &amp; month %in% c(9) ) %&gt;% filter( day &gt; 9 &amp; day &lt; 15) %&gt;% mutate(solrf = ((solar-39) * 1.8) + ((25 -temp1) * .0012)) %&gt;% group_by(month,day,hr) %&gt;% add_count(wt=3) %&gt;% summarise(m1= mean(solrf)) %&gt;% group_by(day,hr) %&gt;% ggplot() + geom_line(aes(hr,m1,group=day ,color=as.factor(day),linetype = &#39;1.2&#39;),se=F)+ scale_colour_manual(&quot;Solar radiatiion on day&quot;, breaks = c(&quot;10&quot;,&quot;11&quot;, &quot;12&quot;,&quot;13&quot;,&quot;14&quot;), values = brewer.pal(5, &quot;Set1&quot;)) + scale_linetype_manual(&quot;Height(m)&quot;,values=c(&quot;1.2&quot;=1)) + theme_classic() + ggtitle(&quot;Diel Variation in radiation at 1.2m at site AE10 (1450m)&quot;) + xlab(&quot;Hour&quot;) + ylab(&quot;Radiation (W/m^2)&quot;) + labs(colour = &quot;Hour&quot;, subtitle=&quot;9/10/18 - 9/14/19&quot;,caption=&quot;Data Source : http://www.nanoclimate.org&quot;) Paradise radiation MtRainier_Solar %&gt;% filter(month == 9 &amp; year== 2018 &amp; day %in% c(10,11,12,13,14) ) %&gt;% ggplot() + geom_line(aes(hr,Paradise_5400,group=day ,color=as.factor(day))) + scale_colour_manual(&quot;Solar radiatiion on day&quot;, breaks = c(&quot;10&quot;,&quot;11&quot;, &quot;12&quot;,&quot;13&quot;,&quot;14&quot;), values = brewer.pal(5, &quot;Set1&quot;)) + scale_x_continuous(breaks = c(seq(0,23,by=1))) + theme_classic() + labs(x=&quot;Date&quot;, y=&quot;Solar radiation(W/m2) &quot;,subtitle=&quot;Met station Paradise (1645m) - Mt Rainier Solar &quot;, caption=&quot;Data Source : http://nanoclimate.org&quot;) + geom_hline(aes(yintercept=9),colour=&quot;black&quot;, linetype=&quot;dashed&quot;) MtRainier_Solar %&gt;% filter(month == 9 &amp; year== 2018 &amp; day %in% c(10,11,12,13,14) ) %&gt;% ggplot() + geom_line(aes(hr,Sunrise_6880,group=day ,color=as.factor(day))) + scale_colour_manual(&quot;Solar radiatiion on day&quot;, breaks = c(&quot;10&quot;,&quot;11&quot;, &quot;12&quot;,&quot;13&quot;,&quot;14&quot;), values = brewer.pal(5, &quot;Set1&quot;)) + theme_classic() + labs(x=&quot;Date&quot;, y=&quot;Solar radiation(W/m2) &quot;,subtitle=&quot;Met station Sunrise base (2097m) - Mt Rainier Solar &quot;, caption=&quot;Data Source : http://nanoclimate.org&quot;) + geom_hline(aes(yintercept=9),colour=&quot;black&quot;, linetype=&quot;dashed&quot;) Daily solar, but average a 12 min interval. labelsx &lt;- c( &quot;0&quot;,&quot;-&quot;, &quot;-&quot;, &quot;-&quot;, &quot;-&quot; , &quot;1&quot;,&quot;-&quot;, &quot;-&quot;, &quot;-&quot;, &quot;-&quot;, &quot;2&quot; , &quot;-&quot;, &quot;-&quot;, &quot;-&quot;, &quot;-&quot;, &quot;3&quot;, &quot;-&quot;, &quot;-&quot;, &quot;-&quot;, &quot;-&quot;, &quot;4&quot;, &quot;-&quot;, &quot;-&quot;, &quot;-&quot;, &quot;-&quot;, &quot;5&quot;, &quot;-&quot;, &quot;-&quot;, &quot;-&quot;, &quot;-&quot;, &quot;6&quot;, &quot;-&quot;, &quot;-&quot;, &quot;-&quot;, &quot;-&quot;, &quot;7&quot;, &quot;-&quot;, &quot;-&quot;, &quot;-&quot;, &quot;-&quot;, &quot;8&quot;, &quot;-&quot;, &quot;-&quot;, &quot;-&quot;, &quot;-&quot;, &quot;9&quot;, &quot;-&quot;, &quot;-&quot;, &quot;-&quot;, &quot;-&quot;, &quot;10&quot;, &quot;-&quot;, &quot;-&quot;, &quot;-&quot;, &quot;-&quot;, &quot;11&quot;, &quot;-&quot;, &quot;-&quot;, &quot;-&quot;, &quot;-&quot;, &quot;12&quot;, &quot;-&quot;, &quot;-&quot;, &quot;-&quot;, &quot;-&quot;, &quot;13&quot;, &quot;-&quot;, &quot;-&quot;, &quot;-&quot;, &quot;-&quot;, &quot;14&quot;, &quot;-&quot;, &quot;-&quot;, &quot;-&quot;, &quot;-&quot;, &quot;15&quot;, &quot;-&quot;, &quot;-&quot;, &quot;-&quot;, &quot;-&quot;, &quot;16&quot;, &quot;-&quot;, &quot;-&quot;, &quot;-&quot;, &quot;-&quot;, &quot;17&quot;, &quot;-&quot;, &quot;-&quot;, &quot;-&quot;, &quot;-&quot;, &quot;18&quot;, &quot;-&quot;, &quot;-&quot;, &quot;-&quot;, &quot;-&quot;, &quot;19&quot;, &quot;-&quot;, &quot;-&quot;, &quot;-&quot;, &quot;-&quot;, &quot;20&quot;, &quot;-&quot;, &quot;-&quot;, &quot;-&quot;, &quot;-&quot;, &quot;21&quot;, &quot;-&quot;, &quot;-&quot;, &quot;-&quot;, &quot;-&quot;, &quot;22&quot;, &quot;-&quot;, &quot;-&quot;, &quot;-&quot;, &quot;-&quot;, &quot;23&quot;, &quot;-&quot;, &quot;-&quot;, &quot;-&quot;, &quot;-&quot;) mclim_AE10_CN01_2018 %&gt;% filter (!is.na(mclim_AE10_CN01_2018$minute) &amp; month %in% c(9) ) %&gt;% filter( day &gt; 9 &amp; day &lt; 11) %&gt;% mutate(solrf = ((solar-39) * 1.8) + ((25 -temp1) * .0012)) %&gt;% group_by(hr,minute) %&gt;% summarise(solmin = mean(solrf)) %&gt;% group_by(b = gl(ceiling(n()/4), 4, n())) %&gt;% group_by(hr,b) %&gt;% summarize(meansol = mean(solmin), sd = sd(solmin)) %&gt;% mutate(height=&quot;1.2&quot;,newx= as.numeric(paste(hr,b,sep=&quot;&quot;))) %&gt;% #select(newx) %&gt;% distinct(newx) dplyr::group_by(height) %&gt;% mutate(index=1:n()) %&gt;% ggplot() + geom_line(aes(index,meansol))+ theme_minimal() + scale_x_continuous(breaks = seq(0,119,by=1), limits = c(0,120),labels = labelsx) + scale_colour_manual(&quot;Solar radiatiion on day&quot;, breaks = c(&quot;10&quot;,&quot;11&quot;, &quot;12&quot;,&quot;13&quot;,&quot;14&quot;), values = brewer.pal(5, &quot;Set1&quot;)) + scale_linetype_manual(&quot;Height(m)&quot;,values=c(&quot;1.2&quot;=1)) + theme_classic() + ggtitle(&quot;Diel Variation in radiation at 1.2m at site AE10&quot;) + xlab(&quot;Hour&quot;) + ylab(&quot;Radiation (W/m^2)&quot;) + labs(colour = &quot;Hour&quot;, subtitle=&quot;9/10/18 - 9/14/19&quot;,caption=&quot;Data Source : http://www.nanoclimate.org&quot;) 8.25 1-10-2019 Combining the plots onto a single plot Create three dataframes to combine into one MtRainier_Local_2018&lt;- read_csv(&#39;./data/mt-rainier_temperature_2018.csv&#39;) ## Parsed with column specification: ## cols( ## `Date/Time (PST)` = col_datetime(format = &quot;&quot;), ## `deg F - 5400&#39; - Paradise` = col_double(), ## `deg F - 6410&#39; - Sunrise Base` = col_double(), ## `deg F - 6880&#39; - Sunrise Upper` = col_double(), ## `deg F - 10110&#39; - Camp Muir` = col_double() ## ) colnames(MtRainier_Local_2018) &lt;- c(&#39;datetime&#39;,&#39;Paradise_5400&#39;,&#39;Sunrise_6410&#39;,&#39;Sunrise_6880&#39;,&#39;CampMuir_10110&#39;) MtRainier_Local_2018$hr &lt;- hour(MtRainier_Local_2018$datetime) MtRainier_Local_2018$minute &lt;- minute(MtRainier_Local_2018$datetime) MtRainier_Local_2018$day &lt;- day(MtRainier_Local_2018$datetime) MtRainier_Local_2018$month&lt;- month(MtRainier_Local_2018$datetime) MtRainier_Local_2018$year&lt;- year(MtRainier_Local_2018$datetime) #subset dataframe for AE 10 ae1010to14 &lt;- mclim_AE10_CN01_2018 %&gt;% filter (!is.na(mclim_AE10_CN01_2018$minute) &amp; month %in% c(9) ) %&gt;% filter( day &gt; 9 &amp; day &lt; 15) %&gt;% group_by(month,day,hr) %&gt;% add_count(wt=3) %&gt;% summarise(m1= mean(temp1)) %&gt;% group_by(day,hr) %&gt;% as.data.frame() ae1010to14$site &lt;- &#39;AE10&#39; Paradise_10to14 &lt;- MtRainier_Local_2018 %&gt;% filter (month %in% c(9) ) %&gt;% filter( day &gt; 9 &amp; day &lt; 15) %&gt;% mutate(m1=weathermetrics::fahrenheit.to.celsius(Paradise_5400) ) %&gt;% group_by(month,day,hr) %&gt;% dplyr::select(month,day,hr,m1) %&gt;% as.data.frame() Paradise_10to14$site &lt;- &#39;Paradise_5400&#39; Sunrise_10to14 &lt;- MtRainier_Local_2018 %&gt;% filter (month %in% c(9) ) %&gt;% filter( day &gt; 9 &amp; day &lt; 15) %&gt;% mutate(m1=weathermetrics::fahrenheit.to.celsius(Sunrise_6880) ) %&gt;% group_by(month,day,hr) %&gt;% dplyr::select(month,day,hr,m1) %&gt;% as.data.frame() Sunrise_10to14$site &lt;- &#39;Sunrise_6880&#39; combined_10to14 &lt;- rbind(ae1010to14,Paradise_10to14,Sunrise_10to14) Do the plot combined_10to14 %&gt;% filter (month %in% c(9) ) %&gt;% filter( day %in% c(10) ) %&gt;% ggplot() + geom_line(aes(hr,m1,group=site,linetype = site),se=F)+ scale_linetype_manual(&quot;Site(m)&quot;,values=c(&quot;AE10&quot;=1,&quot;Paradise_5400&quot;=2,&quot;Sunrise_6880&quot;=3)) + theme_classic() + ggtitle(&quot;Variation in temperature at two different heights at AE10&quot;) + xlab(&quot;Hour&quot;) + ylab(&quot;Temperature (°C)&quot;) + labs(colour = &quot;Hour&quot;, subtitle=&quot;9/10/18&quot;,caption=&quot;Data Source : http://www.nanoclimate.org&quot;) 8.26 1-11-2019 Grid plots for multiple days combined_10to14 %&gt;% filter (month %in% c(9) ) %&gt;% filter( day %in% c(10,11,12,13,14) ) %&gt;% ggplot() + geom_line(aes(hr,m1,group=site,linetype = site),se=F)+ facet_grid(. ~ day) + scale_linetype_manual(&quot;Site(m)&quot;,values=c(&quot;AE10&quot;=1,&quot;Paradise_5400&quot;=2,&quot;Sunrise_6880&quot;=3)) + theme_classic() + ggtitle(&quot;Diel variation at differmt sites in comparion to micromet&quot;) + xlab(&quot;Hour&quot;) + ylab(&quot;Temperature (°C)&quot;) + labs(colour = &quot;Hour&quot;, subtitle=&quot;9/10/18&quot;,caption=&quot;Data Source : http://www.nanoclimate.org&quot;) Grid for two weeks ae10_5to15 &lt;- mclim_AE10_CN01_2018 %&gt;% filter (!is.na(mclim_AE10_CN01_2018$minute) &amp; month %in% c(9) ) %&gt;% filter( day &gt; 4 &amp; day &lt; 16) %&gt;% group_by(month,day,hr) %&gt;% add_count(wt=3) %&gt;% summarise(m1= mean(temp1)) %&gt;% group_by(day,hr) %&gt;% as.data.frame() ae10_5to15$site &lt;- &#39;AE10_1450&#39; Paradise_5to15 &lt;- MtRainier_Local_2018 %&gt;% filter (month %in% c(9) ) %&gt;% filter( day &gt; 4 &amp; day &lt; 16) %&gt;% mutate(m1=(Paradise_5400 - 32) * (5/9)) %&gt;% group_by(month,day,hr) %&gt;% dplyr::select(month,day,hr,m1) %&gt;% as.data.frame() Paradise_5to15$site &lt;- &#39;Paradise_1645&#39; Sunrise_5to15 &lt;- MtRainier_Local_2018 %&gt;% filter (month %in% c(9) ) %&gt;% filter( day &gt; 4 &amp; day &lt; 16) %&gt;% mutate(m1= weathermetrics::fahrenheit.to.celsius(Sunrise_6880)) %&gt;% group_by(month,day,hr) %&gt;% dplyr::select(month,day,hr,m1) %&gt;% as.data.frame() Sunrise_5to15$site &lt;- &#39;Sunrise_2097&#39; combined_5to15 &lt;- rbind(ae10_5to15,Paradise_5to15,Sunrise_5to15) combined_5to15 %&gt;% filter (month %in% c(9) ) %&gt;% filter( day %in% c(5,6,7,8,9,10,11,12,13,14) ) %&gt;% ggplot() + geom_line(aes(hr,m1,group=site,linetype = site),se=F)+ facet_grid(. ~ day, scales = &quot;free&quot;) + scale_linetype_manual(&quot;Site(m)&quot;,values=c(&quot;AE10_1450&quot;=1,&quot;Paradise_1645&quot;=2,&quot;Sunrise_2097&quot;=3)) + theme_classic() + ggtitle(&quot;Diel variation in Temperature at different sites in comparison to micromet&quot;) + xlab(&quot;Hour&quot;) + ylab(&quot;Temperature (°C)&quot;) + labs(colour = &quot;Hour&quot;, subtitle=&quot;1 hr resolution&quot;,caption=&quot;Data Source : http://www.nanoclimate.org&quot;) Combine Solar radiation ae10_5to15_solar &lt;- mclim_AE10_CN01_2018 %&gt;% filter (!is.na(mclim_AE10_CN01_2018$minute) &amp; month %in% c(9) ) %&gt;% filter( day &gt; 4 &amp; day &lt; 16) %&gt;% mutate(solrf = ((solar-39) * 1.8) + ((25 -temp1) * .0012)) %&gt;% group_by(month,day,hr) %&gt;% add_count(wt=3) %&gt;% summarise(m1= mean(solrf)) %&gt;% group_by(day,hr) %&gt;% as.data.frame() ae10_5to15_solar$site &lt;- &#39;AE10_1450&#39; Paradise_5to15_solar &lt;- MtRainier_Solar %&gt;% filter (month %in% c(9) ) %&gt;% filter( day &gt; 4 &amp; day &lt; 16) %&gt;% group_by(month,day,hr) %&gt;% summarise(m1= mean(Paradise_5400)) %&gt;% dplyr::select(month,day,hr,m1) %&gt;% as.data.frame() Paradise_5to15_solar$site &lt;- &#39;Paradise_1645&#39; Sunrise_5to15_solar &lt;- MtRainier_Solar %&gt;% filter (month %in% c(9) ) %&gt;% filter( day &gt; 4 &amp; day &lt; 16) %&gt;% group_by(month,day,hr) %&gt;% summarise(m1= mean(Sunrise_6880)) %&gt;% dplyr::select(month,day,hr,m1) %&gt;% as.data.frame() Sunrise_5to15_solar$site &lt;- &#39;Sunrise_2097&#39; combined_5to15_solar &lt;- rbind(ae10_5to15_solar,Paradise_5to15_solar,Sunrise_5to15_solar) combined_5to15_solar %&gt;% filter (month %in% c(9) ) %&gt;% filter( day %in% c(5,6,7,8,9,10,11,12,13,14) ) %&gt;% ggplot() + geom_line(aes(hr,m1,group=site,linetype = site),se=F)+ facet_grid(. ~ day, scales = &quot;free&quot;) + scale_linetype_manual(&quot;Site(m)&quot;,values=c(&quot;AE10_1450&quot;=1,&quot;Paradise_1645&quot;=2,&quot;Sunrise_2097&quot;=3)) + theme_classic() + ggtitle(&quot;Diel variation Solar radiation at different sites in comparison to micromet&quot;) + xlab(&quot;Hour&quot;) + ylab(&quot;Solar radiation(W/m2)&quot;) + labs(colour = &quot;Hour&quot;, subtitle=&quot;1 hr resolution&quot;,caption=&quot;Data Source : http://www.nanoclimate.org&quot;) 10 to 14th of September combined_5to15_solar %&gt;% filter (month %in% c(9) ) %&gt;% filter( day %in% c(10,11,12,13,14) ) %&gt;% ggplot() + geom_line(aes(hr,m1,group=site,linetype = site),se=F)+ facet_grid(. ~ day, scales = &quot;free&quot;) + scale_linetype_manual(&quot;Site(m)&quot;,values=c(&quot;AE10&quot;=1,&quot;Paradise_5400&quot;=2,&quot;Sunrise_6880&quot;=3)) + theme_classic() + ggtitle(&quot;Diel variation at differmt sites in comparion to micromet&quot;) + xlab(&quot;Hour&quot;) + ylab(&quot;Solar radiation(W/m2)&quot;) + labs(colour = &quot;Hour&quot;, subtitle=&quot;&quot;,caption=&quot;Data Source : http://www.nanoclimate.org&quot;) Solar radiation profile at 12 min resolution labelfx &lt;- c( &quot;0&quot;,&quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot; , &quot;1&quot;,&quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot; , &quot;2&quot; , &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot; , &quot;3&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot; , &quot;4&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot; , &quot;5&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;6&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot; , &quot;7&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot; , &quot;8&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot; , &quot;9&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot; , &quot;10&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot; , &quot;11&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot; , &quot;12&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot; , &quot;13&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot; , &quot;14&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot; , &quot;15&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot; , &quot;16&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot; , &quot;17&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot; , &quot;18&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot; , &quot;19&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot; , &quot;20&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot; , &quot;21&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot; , &quot;22&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot; , &quot;23&quot;, &quot;&quot;,&quot;&quot;, &quot;&quot;, &quot;&quot; ) mclim_AE10_CN01_2018 %&gt;% filter (!is.na(mclim_AE10_CN01_2018$minute) &amp; month %in% c(9) ) %&gt;% filter( day &gt; 4 &amp; day &lt; 16) %&gt;% mutate(solrf = ((solar-39) * 1.8) + ((25 -temp1) * .0012)) %&gt;% group_by(day,hr,minute) %&gt;% summarise(solmin = mean(solrf)) %&gt;% group_by(day,b = gl(ceiling(n()/4), 4, n())) %&gt;% group_by(day,hr,b) %&gt;% summarize(meansol = mean(solmin), sd = sd(solmin)) %&gt;% mutate(height=&quot;1.2&quot;,newx= as.numeric(paste(hr,b,sep=&quot;&quot;))) %&gt;% #select(newx) %&gt;% distinct(newx) dplyr::group_by(day,height) %&gt;% mutate(index=1:n()) %&gt;% ggplot() + geom_line(aes(hr,meansol))+ theme_minimal() + facet_grid(.~ day,scales = &quot;free&quot;) + # scale_x_continuous(breaks = seq(0,119,by=1), limits = c(0,120),labels = labelfx) + scale_colour_manual(&quot;Solar radiatiion on day&quot;, breaks = c(&quot;10&quot;,&quot;11&quot;, &quot;12&quot;,&quot;13&quot;,&quot;14&quot;), values = brewer.pal(5, &quot;Set1&quot;)) + scale_linetype_manual(&quot;Height(m)&quot;,values=c(&quot;1.2&quot;=1)) + theme_classic() + ggtitle(&quot;Diel Variation in radiation at 1.2m at site AE10&quot;) + xlab(&quot;Hour&quot;) + ylab(&quot;Radiation (W/m^2)&quot;) + labs(colour = &quot;Hour&quot;, subtitle=&quot;12 min resolution&quot;,caption=&quot;Data Source : http://www.nanoclimate.org&quot;) Selective plots mclim_AE10_CN01_2018 %&gt;% filter (!is.na(mclim_AE10_CN01_2018$minute) &amp; month %in% c(9) ) %&gt;% filter( day &gt; 8 &amp; day &lt; 13) %&gt;% mutate(solrf = ((solar-39) * 1.8) + ((25 -temp1) * .0012)) %&gt;% group_by(day,hr,minute) %&gt;% summarise(solmin = mean(solrf)) %&gt;% group_by(day,b = gl(ceiling(n()/4), 4, n())) %&gt;% group_by(day,hr,b) %&gt;% summarize(meansol = mean(solmin), sd = sd(solmin)) %&gt;% mutate(height=&quot;1.2&quot;,newx= as.numeric(paste(hr,b,sep=&quot;&quot;))) %&gt;% #select(newx) %&gt;% distinct(newx) dplyr::group_by(day,height) %&gt;% mutate(index=1:n()) %&gt;% ggplot() + geom_line(aes(index,meansol))+ theme_minimal() + facet_grid(.~ day,scales = &quot;free&quot;) + scale_x_continuous(breaks = seq(0,119,by=1), limits = c(0,120),labels = labelfx) + scale_colour_manual(&quot;Solar radiatiion on day&quot;, breaks = c(&quot;10&quot;,&quot;11&quot;, &quot;12&quot;,&quot;13&quot;,&quot;14&quot;), values = brewer.pal(5, &quot;Set1&quot;)) + scale_linetype_manual(&quot;Height(m)&quot;,values=c(&quot;1.2&quot;=1)) + theme_classic() + ggtitle(&quot;Diel Variation in radiation at 1.2m at site AE10&quot;) + xlab(&quot;Hour&quot;) + ylab(&quot;Radiation (W/m^2)&quot;) + labs(colour = &quot;Hour&quot;, subtitle=&quot;9/9/18 - 9/12/19&quot;,caption=&quot;Data Source : http://www.nanoclimate.org&quot;) Wind profiles at 12 min resolution (0.3m) mclim_AE10_CN01_2018 %&gt;% filter (!is.na(mclim_AE10_CN01_2018$minute) &amp; month %in% c(9) ) %&gt;% filter( day &gt; 4 &amp; day &lt; 7) %&gt;% group_by(day,height,hr,minute) %&gt;% summarise(wspd1 = mean(windspeed4)) %&gt;% group_by(day,b = gl(ceiling(n()/4), 4, n())) %&gt;% group_by(day,hr,b) %&gt;% summarize(meanw1 = mean(wspd1), sd = sd(wspd1)) %&gt;% mutate(ht=&#39;1.2&#39;,newx= as.numeric(paste(hr,b,sep=&quot;&quot;))) %&gt;% #select(newx) %&gt;% distinct(newx) dplyr::group_by(day,ht) %&gt;% mutate(index=1:n()) %&gt;% ggplot() + geom_line(aes(index,meanw1))+ theme_minimal() + facet_grid(.~ day,scales = &quot;free&quot;) + scale_x_continuous(breaks = seq(0,119,by=1), limits = c(0,120),labels = labelfx) + scale_colour_manual(&quot;Solar radiatiion on day&quot;, breaks = c(&quot;10&quot;,&quot;11&quot;, &quot;12&quot;,&quot;13&quot;,&quot;14&quot;), values = brewer.pal(5, &quot;Set1&quot;)) + scale_linetype_manual(&quot;Height(m)&quot;,values=c(&quot;1.2&quot;=1)) + theme_classic() + ggtitle(&quot;Diel Variation in wind profile at 0.3m at site AE10&quot;) + xlab(&quot;Hour&quot;) + ylab(&quot;Wind speed (km/hr)&quot;) + labs(colour = &quot;Hour&quot;, subtitle=&quot;12 min resolution&quot;,caption=&quot;Data Source : http://www.nanoclimate.org&quot;) Wind profiles at 12 min resolution (0.6m) mclim_AE10_CN01_2018 %&gt;% filter (!is.na(mclim_AE10_CN01_2018$minute) &amp; month %in% c(9) ) %&gt;% filter( day &gt; 4 &amp; day &lt; 16) %&gt;% group_by(day,height,hr,minute) %&gt;% summarise(wspd1 = mean(windspeed3)) %&gt;% group_by(day,b = gl(ceiling(n()/4), 4, n())) %&gt;% group_by(day,hr,b) %&gt;% summarize(meanw1 = mean(wspd1), sd = sd(wspd1)) %&gt;% mutate(ht=&#39;1.2&#39;,newx= as.numeric(paste(hr,b,sep=&quot;&quot;))) %&gt;% #select(newx) %&gt;% distinct(newx) dplyr::group_by(day,ht) %&gt;% mutate(index=1:n()) %&gt;% ggplot() + geom_line(aes(index,meanw1))+ theme_minimal() + facet_grid(.~ day,scales = &quot;free&quot;) + scale_x_continuous(breaks = seq(0,119,by=1), limits = c(0,120),labels = labelfx) + scale_colour_manual(&quot;Solar radiatiion on day&quot;, breaks = c(&quot;10&quot;,&quot;11&quot;, &quot;12&quot;,&quot;13&quot;,&quot;14&quot;), values = brewer.pal(5, &quot;Set1&quot;)) + scale_linetype_manual(&quot;Height(m)&quot;,values=c(&quot;1.2&quot;=1)) + theme_classic() + ggtitle(&quot;Diel Variation in wind profile at 0.6m at site AE10&quot;) + xlab(&quot;Hour&quot;) + ylab(&quot;Radiation (km/hr)&quot;) + labs(colour = &quot;Hour&quot;, subtitle=&quot;12 min resolution&quot;,caption=&quot;Data Source : http://www.nanoclimate.org&quot;) Wind profiles at 12 min resolution (0.9m) mclim_AE10_CN01_2018 %&gt;% filter (!is.na(mclim_AE10_CN01_2018$minute) &amp; month %in% c(9) ) %&gt;% filter( day &gt; 4 &amp; day &lt; 16) %&gt;% group_by(day,height,hr,minute) %&gt;% summarise(wspd1 = mean(windspeed2)) %&gt;% group_by(day,b = gl(ceiling(n()/4), 4, n())) %&gt;% group_by(day,hr,b) %&gt;% summarize(meanw1 = mean(wspd1), sd = sd(wspd1)) %&gt;% mutate(ht=&#39;1.2&#39;,newx= as.numeric(paste(hr,b,sep=&quot;&quot;))) %&gt;% #select(newx) %&gt;% distinct(newx) dplyr::group_by(day,ht) %&gt;% mutate(index=1:n()) %&gt;% ggplot() + geom_line(aes(index,meanw1))+ theme_minimal() + facet_grid(.~ day,scales = &quot;free&quot;) + scale_x_continuous(breaks = seq(0,119,by=1), limits = c(0,120),labels = labelfx) + scale_colour_manual(&quot;Solar radiatiion on day&quot;, breaks = c(&quot;10&quot;,&quot;11&quot;, &quot;12&quot;,&quot;13&quot;,&quot;14&quot;), values = brewer.pal(5, &quot;Set1&quot;)) + scale_linetype_manual(&quot;Height(m)&quot;,values=c(&quot;1.2&quot;=1)) + theme_classic() + ggtitle(&quot;Diel Variation in wind profile at 0.9m at site AE10&quot;) + xlab(&quot;Hour&quot;) + ylab(&quot;Windspeed (km/hr)&quot;) + labs(colour = &quot;Hour&quot;, subtitle=&quot;12 min resolution&quot;,caption=&quot;Data Source : http://www.nanoclimate.org&quot;) Wind profiles at 12 min resolution (1.2m) mclim_AE10_CN01_2018 %&gt;% filter (!is.na(mclim_AE10_CN01_2018$minute) &amp; month %in% c(9) ) %&gt;% filter( day &gt; 4 &amp; day &lt; 16) %&gt;% group_by(day,height,hr,minute) %&gt;% summarise(wspd1 = mean(windspeed1)) %&gt;% group_by(day,b = gl(ceiling(n()/4), 4, n())) %&gt;% group_by(day,hr,b) %&gt;% summarize(meanw1 = mean(wspd1), sd = sd(wspd1)) %&gt;% mutate(ht=&#39;1.2&#39;,newx= as.numeric(paste(hr,b,sep=&quot;&quot;))) %&gt;% #select(newx) %&gt;% distinct(newx) dplyr::group_by(day,ht) %&gt;% mutate(index=1:n()) %&gt;% ggplot() + geom_line(aes(index,meanw1))+ theme_minimal() + facet_grid(.~ day,scales = &quot;free&quot;) + scale_x_continuous(breaks = seq(0,119,by=1), limits = c(0,120),labels = labelfx) + scale_colour_manual(&quot;Solar radiatiion on day&quot;, breaks = c(&quot;10&quot;,&quot;11&quot;, &quot;12&quot;,&quot;13&quot;,&quot;14&quot;), values = brewer.pal(5, &quot;Set1&quot;)) + scale_linetype_manual(&quot;Height(m)&quot;,values=c(&quot;1.2&quot;=1)) + theme_classic() + ggtitle(&quot;Diel Variation in wind profile at 1.2m at site AE10&quot;) + xlab(&quot;Hour&quot;) + ylab(&quot;Radiation (km/hr)&quot;) + labs(colour = &quot;Hour&quot;, subtitle=&quot;12 min resolution&quot;,caption=&quot;Data Source : http://www.nanoclimate.org&quot;) Notes from the PI meeting Remarks Temperature readings from AE10 still looks very buffered (not tracking the regional) Solar radiation magnitude not matching-up, hard to believe canopy buffering is the cause. If canopy buffering was the case, it wont be that be that influential after the peak solar radiation. Battery hypothesis that being cold is making it lose the ability to capture the signal. Next steps Compare with Longmire Compare with Skate creek and other MM sites If the site is buffered, previous years comparison sgould highlight that (Aji’s hypothesis), there are old-growth forests. () Compare with file = &#39;AE10-A1_hourly.csv&#39; # Read the file onest &lt;- read.csv(paste(&quot;data/&quot; , file, sep = &quot;&quot;)) # Update the tumestamp onest$dt &lt;- strptime(onest$DATE, format = &quot;%Y-%m-%d %H:%M:%S&quot;) # add the year onest$year &lt;- as.numeric(substring(as.character(onest$DATE),1,4)) # add txn date onest$dt_txn &lt;- as.POSIXct(onest$DATE,ormat = &quot;%Y-%m-%d %H:%M:%S&quot;) # Add month column # Add day column # Add hour column onest$month &lt;- as.numeric(format(onest$dt_txn,&quot;%m&quot;)) onest$day &lt;- as.numeric(format(onest$dt_txn,&quot;%d&quot;)) onest$hr &lt;- as.numeric(format(onest$dt,&quot;%H&quot;)) onest %&gt;% dplyr::select( &quot;series_xts&quot; , &quot;year&quot; , &quot;dt_txn&quot; , &quot;month&quot; , &quot;day&quot; , &quot;hr&quot;) %&gt;% filter (month %in% c(9) ) %&gt;% group_by(year,month,day,hr) %&gt;% summarise(m1= mean(series_xts)) %&gt;% filter( day %in% c(5,6,7,8,9) ) %&gt;% ggplot() + geom_line(aes(hr,m1,group=as.factor(day),linetype = as.factor(day)),se=F)+ facet_grid(. ~ year, scales = &quot;free&quot;) + # scale_linetype_manual(&quot;Site(m)&quot;,values=c(&quot;AE10_1450&quot;=1,&quot;Paradise_1645&quot;=2,&quot;Sunrise_2097&quot;=3)) + theme_classic() + ggtitle(&quot;Diel variation in Temperature at different sites in comparison to micromet&quot;) + xlab(&quot;Hour&quot;) + ylab(&quot;Temperature (°C)&quot;) + labs(colour = &quot;Hour&quot;, subtitle=&quot;1 hr resolution&quot;,caption=&quot;Data Source : http://www.nanoclimate.org&quot;) Compare 14,15 and 2016. I hypitheize that southside slope, facng tatoosh range, its a deep valley which is giving rise to the unque microclimate Paradise_5400_2017&lt;- read.csv(&#39;./data/Paradise_5400_feet_2017.csv&#39;) Paradise_5400_2016&lt;- read.csv(&#39;./data/Paradise_5400_feet_2016.csv&#39;) Paradise_5400_2015&lt;- read.csv(&#39;./data/Paradise_5400_feet_2015.csv&#39;) Paradise_5400_2014&lt;- read.csv(&#39;./data/Paradise_5400_feet_2014.csv&#39;) Paradise_5400_2017$date &lt;- as.Date(Paradise_5400_2017$Date.Time..PST., &quot;%Y-%m-%d&quot;) Paradise_5400_2017$datetime &lt;- as.Date(Paradise_5400_2017$Date.Time..PST., &quot;%Y-%m-%d %H:%M&quot;) library(lubridate) library(gridExtra) Paradise_5400_2017$hr &lt;-lubridate::hour(lubridate::as_datetime(Paradise_5400_2017$Date.Time..PST.)) Paradise_5400_2017$min &lt;-lubridate::minute(lubridate::as_datetime(Paradise_5400_2017$Date.Time..PST.)) Paradise_5400_2017$month &lt;- as.numeric (strftime(Paradise_5400_2017$Date.Time..PST.,&#39;%m&#39;)) Paradise_5400_2017$day &lt;-as.numeric (strftime(Paradise_5400_2017$Date.Time..PST.,&#39;%d&#39;)) # 2014 Paradise_5400_2014$date &lt;- as.Date(Paradise_5400_2014$Date.Time..PST., &quot;%Y-%m-%d&quot;) Paradise_5400_2014$datetime &lt;- as.Date(Paradise_5400_2014$Date.Time..PST., &quot;%Y-%m-%d %H:%M&quot;) Paradise_5400_2014$hr &lt;-lubridate::hour(lubridate::as_datetime(Paradise_5400_2014$Date.Time..PST.)) Paradise_5400_2014$min &lt;-lubridate::minute(lubridate::as_datetime(Paradise_5400_2014$Date.Time..PST.)) Paradise_5400_2014$month &lt;- as.numeric (strftime(Paradise_5400_2014$Date.Time..PST.,&#39;%m&#39;)) Paradise_5400_2014$day &lt;-as.numeric (strftime(Paradise_5400_2014$Date.Time..PST.,&#39;%d&#39;)) # 2015 Paradise_5400_2015$date &lt;- as.Date(Paradise_5400_2015$Date.Time..PST., &quot;%Y-%m-%d&quot;) Paradise_5400_2015$datetime &lt;- as.Date(Paradise_5400_2015$Date.Time..PST., &quot;%Y-%m-%d %H:%M&quot;) Paradise_5400_2015$hr &lt;-lubridate::hour(lubridate::as_datetime(Paradise_5400_2015$Date.Time..PST.)) Paradise_5400_2015$min &lt;-lubridate::minute(lubridate::as_datetime(Paradise_5400_2015$Date.Time..PST.)) Paradise_5400_2015$month &lt;- as.numeric (strftime(Paradise_5400_2015$Date.Time..PST.,&#39;%m&#39;)) Paradise_5400_2015$day &lt;- as.numeric (strftime(Paradise_5400_2015$Date.Time..PST.,&#39;%d&#39;)) # 2016 Paradise_5400_2016$date &lt;- as.Date(Paradise_5400_2016$Date.Time..PST., &quot;%Y-%m-%d&quot;) Paradise_5400_2016$datetime &lt;- as.Date(Paradise_5400_2016$Date.Time..PST., &quot;%Y-%m-%d %H:%M&quot;) Paradise_5400_2016$hr &lt;-lubridate::hour(lubridate::as_datetime(Paradise_5400_2016$Date.Time..PST.)) Paradise_5400_2016$min &lt;-lubridate::minute(lubridate::as_datetime(Paradise_5400_2016$Date.Time..PST.)) Paradise_5400_2016$month &lt;- as.numeric (strftime(Paradise_5400_2016$Date.Time..PST.,&#39;%m&#39;)) Paradise_5400_2016$day &lt;- as.numeric (strftime(Paradise_5400_2016$Date.Time..PST.,&#39;%d&#39;)) ae10_A1_1to30_2015 &lt;- onest %&gt;% dplyr::select( &quot;series_xts&quot; , &quot;year&quot; , &quot;dt_txn&quot; , &quot;month&quot; , &quot;day&quot; , &quot;hr&quot;) %&gt;% filter (month %in% c(9) &amp; year ==2015) %&gt;% filter(day &gt; 0 &amp; day &lt; 31) %&gt;% group_by(month,day,hr) %&gt;% summarise(m1= mean(series_xts)) %&gt;% dplyr::select(month,day,hr,m1) %&gt;% as.data.frame() ae10_A1_1to30_2015$site &lt;- &#39;AE10_A1_1450&#39; ae10_A1_1to30_2016 &lt;- onest %&gt;% dplyr::select( &quot;series_xts&quot; , &quot;year&quot; , &quot;dt_txn&quot; , &quot;month&quot; , &quot;day&quot; , &quot;hr&quot;) %&gt;% filter (month %in% c(9) &amp; year ==2016) %&gt;% filter(day &gt; 0 &amp; day &lt; 31) %&gt;% group_by(month,day,hr) %&gt;% summarise(m1= mean(series_xts)) %&gt;% dplyr::select(month,day,hr,m1) %&gt;% as.data.frame() ae10_A1_1to30_2016$site &lt;- &#39;AE10_A1_1450&#39; Paradise_1to30_2015 &lt;-Paradise_5400_2015 %&gt;% filter (month %in% c(9) ) %&gt;% filter(day &gt; 0 &amp; day &lt; 31) %&gt;% group_by(month,day,hr) %&gt;% summarise(m1= mean(weathermetrics::fahrenheit.to.celsius(Temperature..deg.F.))) %&gt;% dplyr::select(month,day,hr,m1) %&gt;% as.data.frame() Paradise_1to30_2015$site &lt;- &#39;Paradise_2015_1645&#39; Paradise_1to30_2016 &lt;-Paradise_5400_2016 %&gt;% filter (month %in% c(9) ) %&gt;% filter(day &gt; 0 &amp; day &lt; 31) %&gt;% group_by(month,day,hr) %&gt;% summarise(m1= mean(weathermetrics::fahrenheit.to.celsius(Temperature..deg.F.))) %&gt;% dplyr::select(month,day,hr,m1) %&gt;% as.data.frame() Paradise_1to30_2016$site &lt;- &#39;Paradise_2016_1645&#39; combined_1to30_A1_2015 &lt;- rbind(ae10_A1_1to30_2015,Paradise_1to30_2015) combined_1to30_A1_2016 &lt;- rbind(ae10_A1_1to30_2016,Paradise_1to30_2016) 8.27 1-12-2019 Do the comparison with year 2015 against M1 combined_1to30_A1_2015 %&gt;% filter (month %in% c(9) ) %&gt;% # filter( day %in% c(10,11,12,13,14) ) %&gt;% filter(day &gt; 0 &amp; day &lt; 31) %&gt;% ggplot() + geom_line(aes(hr,m1,group=site,linetype = site),se=F)+ facet_grid(. ~ day, scales = &quot;free&quot;) + scale_linetype_manual(&quot;Site(m)&quot;,values=c(&quot;AE10_A1_1450&quot;=1,&quot;Paradise_2015_1645&quot;=2,&quot;Sunrise_6880&quot;=3)) + theme_classic() + ggtitle(&quot;Diel variation at different sites in comparion to A1&quot;) + xlab(&quot;Hour&quot;) + ylab(&quot;Solar radiation(W/m2)&quot;) + labs(colour = &quot;Hour&quot;, subtitle=&quot;Year 2015&quot;,caption=&quot;Data Source : http://www.nanoclimate.org&quot;) Do the comparison with year 2016 against M1 combined_1to30_A1_2016 %&gt;% filter (month %in% c(9) ) %&gt;% # filter( day %in% c(10,11,12,13,14) ) %&gt;% filter(day &gt; 0 &amp; day &lt; 31) %&gt;% ggplot() + geom_line(aes(hr,m1,group=site,linetype = site),se=F)+ facet_grid(. ~ day, scales = &quot;free&quot;) + scale_linetype_manual(&quot;Site(m)&quot;,values=c(&quot;AE10_A1_1450&quot;=1,&quot;Paradise_2016_1645&quot;=2,&quot;Sunrise_6880&quot;=3)) + theme_classic() + ggtitle(&quot;Diel variation at different sites in comparion to A1&quot;) + xlab(&quot;Hour&quot;) + ylab(&quot;Solar radiation(W/m2)&quot;) + labs(colour = &quot;Hour&quot;, subtitle=&quot;Year 2016&quot;,caption=&quot;Data Source : http://www.nanoclimate.org&quot;) Looks like A1 is tracking quite well, adhering to principles that air temperature is quite in sync and with boundary principles, and being in the canopy does not seem to be afffecting its temperatyres . Lets now test the hypothesis that maybe other three sites in AE10 might be capturing the signal quite well if battery is givng out. Here I hypothesize that being in deep understory, ours should be more refglectant of the temp above ground. Inversion ….. ae10_TN01_5to15 &lt;- mclim_AE10_TN01_2018 %&gt;% filter ( month %in% c(9) &amp; height == 0.9) %&gt;% filter( day &gt; 4 &amp; day &lt; 16) %&gt;% group_by(month,day,hr) %&gt;% add_count(wt=3) %&gt;% summarise(m1= mean(temp)) %&gt;% group_by(day,hr) %&gt;% as.data.frame() ae10_TN01_5to15$site &lt;- &#39;AE10_TN01_1450&#39; ae10_TN02_5to15 &lt;- mclim_AE10_TN02_2018 %&gt;% filter (month %in% c(9) &amp; height == 1.2) %&gt;% filter( day &gt; 4 &amp; day &lt; 16) %&gt;% group_by(month,day,hr) %&gt;% add_count(wt=3) %&gt;% summarise(m1= mean(temp)) %&gt;% group_by(day,hr) %&gt;% as.data.frame() ae10_TN02_5to15$site &lt;- &#39;AE10_TN02_1450&#39; ae10_TN03_5to15 &lt;- mclim_AE10_TN03_2018 %&gt;% filter (month %in% c(9) &amp; height == 1.2) %&gt;% filter( day &gt; 4 &amp; day &lt; 16) %&gt;% group_by(month,day,hr) %&gt;% add_count(wt=3) %&gt;% summarise(m1= mean(temp)) %&gt;% group_by(day,hr) %&gt;% as.data.frame() ae10_TN03_5to15$site &lt;- &#39;AE10_TN03_1450&#39; combined_5to15_all_MMAE10 &lt;- rbind(ae10_TN01_5to15, ae10_TN02_5to15, ae10_TN03_5to15, ae10_5to15, Paradise_5to15, Sunrise_5to15) combined_5to15_all_MMAE10 %&gt;% filter (month %in% c(9) ) %&gt;% filter( day %in% c(5,6,7,8,9,10,11,12,13,14) ) %&gt;% ggplot() + geom_line(aes(hr,m1,group=site,linetype = site),se=F)+ facet_grid(. ~ day, scales = &quot;free&quot;) + scale_linetype_manual(&quot;Site(m)&quot;,values=c(&quot;AE10_TN01_1450&quot;=1,&quot;AE10_TN02_1450&quot;=2,&quot;AE10_TN03_1450&quot;=3,&quot;AE10_1450&quot;=4,&quot;Paradise_1645&quot;=5,&quot;Sunrise_2097&quot;=6)) + theme_classic() + ggtitle(&quot;Diel variation in Temperature at different sites in comparison to micromet&quot;) + xlab(&quot;Hour&quot;) + ylab(&quot;Temperature (°C)&quot;) + labs(colour = &quot;Hour&quot;, subtitle=&quot;1 hr resolution&quot;,caption=&quot;Data Source : http://www.nanoclimate.org&quot;) some inetersting facts, plots terrible, be selective combined_5to15_all_MMAE10 %&gt;% filter (month %in% c(9) ) %&gt;% filter( day %in% c(10,11,12) ) %&gt;% ggplot() + geom_line(aes(hr,m1,group=site,linetype = site),se=F)+ facet_grid(. ~ day, scales = &quot;free&quot;) + scale_linetype_manual(&quot;Site(m)&quot;,values=c(&quot;AE10_TN01_1450&quot;=1,&quot;AE10_TN02_1450&quot;=2,&quot;AE10_TN03_1450&quot;=3,&quot;AE10_1450&quot;=4,&quot;Paradise_1645&quot;=5,&quot;Sunrise_2097&quot;=6)) + theme_classic() + ggtitle(&quot;Diel variation in Temperature at different sites in comparison to micromet&quot;) + xlab(&quot;Hour&quot;) + ylab(&quot;Temperature (°C)&quot;) + labs(colour = &quot;Hour&quot;, subtitle=&quot;1 hr resolution&quot;,caption=&quot;Data Source : http://www.nanoclimate.org&quot;) Line types not legible, lets try the color combined_5to15_all_MMAE10 %&gt;% filter (month %in% c(9) ) %&gt;% filter( day %in% c(5,6,7,8,9,10,11,12,13,14) ) %&gt;% ggplot() + geom_line(aes(hr,m1,color=site),se=F)+ facet_grid(. ~ day, scales = &quot;free&quot;) + scale_color_manual(&quot;Site(m)&quot;,values=c(&quot;AE10_TN01_1450&quot;=1,&quot;AE10_TN02_1450&quot;=2,&quot;AE10_TN03_1450&quot;=3,&quot;AE10_1450&quot;=4,&quot;Paradise_1645&quot;=5,&quot;Sunrise_2097&quot;=6)) + theme_classic() + ggtitle(&quot;Diel variation in Temperature at different sites in comparison to micromet&quot;) + xlab(&quot;Hour&quot;) + ylab(&quot;Temperature (°C)&quot;) + labs(colour = &quot;Hour&quot;, subtitle=&quot;1 hr resolution&quot;,caption=&quot;Data Source : http://www.nanoclimate.org&quot;) Wow, something going on, our three MM are quite inline. combined_5to15_all_MMAE10 %&gt;% filter (month %in% c(9) ) %&gt;% filter( day %in% c(10,11,12) ) %&gt;% ggplot() + geom_line(aes(hr,m1,color=site),se=F)+ facet_grid(. ~ day, scales = &quot;free&quot;) + scale_color_manual(&quot;Site(m)&quot;,values=c(&quot;AE10_TN01_1450&quot;=1,&quot;AE10_TN02_1450&quot;=2,&quot;AE10_TN03_1450&quot;=3,&quot;AE10_1450&quot;=4,&quot;Paradise_1645&quot;=5,&quot;Sunrise_2097&quot;=6)) + theme_classic() + ggtitle(&quot;Diel variation at different sites in comparison to micromet&quot;) + xlab(&quot;Hour&quot;) + ylab(&quot;Temperature (°C)&quot;) + labs(colour = &quot;Hour&quot;, subtitle=&quot;1 hr resolution&quot;,caption=&quot;Data Source : http://www.nanoclimate.org&quot;) theme_Publication &lt;- function(base_size=14, base_family=&quot;helvetica&quot;) { library(grid) library(ggthemes) (theme_foundation(base_size=base_size, base_family=base_family) + theme(plot.title = element_text(face = &quot;bold&quot;, size = rel(1.2), hjust = 0.5), text = element_text(), panel.background = element_rect(colour = NA), plot.background = element_rect(colour = NA), panel.border = element_rect(colour = NA), axis.title = element_text(face = &quot;bold&quot;,size = rel(1)), axis.title.y = element_text(angle=90,vjust =2), axis.title.x = element_text(vjust = -0.2), axis.text = element_text(), axis.line = element_line(colour=&quot;black&quot;), axis.ticks = element_line(), panel.grid.major = element_line(colour=&quot;#f0f0f0&quot;), panel.grid.minor = element_blank(), legend.key = element_rect(colour = NA), legend.position = &quot;bottom&quot;, legend.direction = &quot;horizontal&quot;, legend.key.size= unit(0.2, &quot;cm&quot;), legend.margin = unit(0, &quot;cm&quot;), legend.title = element_text(face=&quot;italic&quot;), plot.margin=unit(c(10,5,5,5),&quot;mm&quot;), strip.background=element_rect(colour=&quot;#f0f0f0&quot;,fill=&quot;#f0f0f0&quot;), strip.text = element_text(face=&quot;bold&quot;) )) } presentation_theme &lt;- theme(axis.text = element_text(size = 25, colour = &quot;black&quot;), axis.title.x = element_text(size = 30), axis.title.y = element_text(size = 30, angle = 0), strip.text.x = element_text(size = 25, face = &quot;italic&quot;), strip.text.y = element_text(size = 25, angle = 270, face = &quot;italic&quot;), plot.title = element_text(size = 35, face = &quot;bold&quot;), legend.text = element_text(size = 20), legend.title = element_text(size = 25, face = &quot;bold&quot;)) my_theme &lt;- theme(axis.text.x = element_text(angle = 45, vjust = 0.9, hjust = 0.9, size = rel(3))) png(&quot;Spatial-MC.png&quot;, width = 1024, height = 768, units = &#39;px&#39;) combined_5to15_all_MMAE10 %&gt;% filter (month %in% c(9) ) %&gt;% filter( day %in% c(10,11,12) ) %&gt;% ggplot() + geom_line(aes(hr,m1,color=site),se=F)+ facet_grid(. ~ day, scales = &quot;free&quot;) + scale_color_manual(&quot;Site(m)&quot;,values=c(&quot;AE10_TN01_1450&quot;=1,&quot;AE10_TN02_1450&quot;=2,&quot;AE10_TN03_1450&quot;=3,&quot;AE10_1450&quot;=4,&quot;Paradise_1645&quot;=5,&quot;Sunrise_2097&quot;=6)) + my_theme + ggtitle(&quot;Diel variation at different sites in comparison to micromet&quot;) + xlab(&quot;Hour&quot;) + ylab(&quot;Temperature (°C)&quot;) + labs(colour = &quot;Hour&quot;, subtitle=&quot;1 hr resolution&quot;,caption=&quot;Data Source : http://www.nanoclimate.org&quot;) dev.off() ## quartz_off_screen ## 2 Something unique, 8.28 1-15-2019 look how TN03 is the colder of them all, and also you see the tiering where TN01 and AE10 CN01 are relatively the same. This was done at .9m , so not the convential height the weater stations use. 8.29 1-16-2019 Load other stations at AG05 AG05 - TN02 Data cirruption - 9/9 from 8 pm onwards to 1am next day. 2871D7779109021D Removed the faulty record mclim_AG05_TN02_2018&lt;- read.csv(&#39;./data/DATALOG-AG05-TN02.CSV&#39;) names(mclim_AG05_TN02_2018) &lt;- c(&#39;time&#39;,&#39;nodeid&#39;,&#39;temp&#39;,&#39;batt&#39;) mclim_AG05_TN02_2018$time &lt;- as.POSIXct(mclim_AG05_TN02_2018$time, &quot;%Y/%m/%d %H:%M:%S&quot;) #Add hour month and day ## 11-05-2018 mclim_AG05_TN02_2018$hr &lt;- hour(mclim_AG05_TN02_2018$time) mclim_AG05_TN02_2018$minute&lt;- minute(mclim_AG05_TN02_2018$time) mclim_AG05_TN02_2018$day &lt;- day(mclim_AG05_TN02_2018$time) mclim_AG05_TN02_2018$month&lt;- month(mclim_AG05_TN02_2018$time) #Roughly one feet apart mclim_AG05_TN02_2018$height &lt;- 0 mclim_AG05_TN02_2018[mclim_AG05_TN02_2018$nodeid==&#39;282662779114024E&#39; ,]$height &lt;- 0.6 mclim_AG05_TN02_2018[mclim_AG05_TN02_2018$nodeid==&#39;28121077910602EC&#39; ,]$height &lt;- 1.2 mclim_AG05_TN02_2018[mclim_AG05_TN02_2018$nodeid==&#39;2871D7779109021D&#39; ,]$height &lt;- 0.3 mclim_AG05_TN02_2018[mclim_AG05_TN02_2018$nodeid==&#39;28AE157791060244&#39; ,]$height &lt;- 0.9 ## Day plot , Representive day mclim_AG05_TN02_2018 %&gt;% filter(month(time) %in% &#39;9&#39; &amp; day %in% c(10)) %&gt;% ggplot( aes(time,temp,color = factor(height))) + geom_line() + theme_minimal() + ggtitle(&quot;Variation in temperature at AG05- TN02 Closed&quot;) + xlab(&quot;Date&quot;) + ylab(&quot;Temperature (°C)&quot;) + labs(colour = &quot;Height(m)&quot;, subtitle=&quot;9/17/2018&quot;,caption=&quot;Data Source : http://nanoclimate.org&quot;) AG05 TN03 mclim_AG05_TN03_2018&lt;- read.csv(&#39;./data/DATALOG-AG05-TN03.CSV&#39;) names(mclim_AG05_TN03_2018) &lt;- c(&#39;time&#39;,&#39;nodeid&#39;,&#39;temp&#39;,&#39;batt&#39;) mclim_AG05_TN03_2018$time &lt;- as.POSIXct(mclim_AG05_TN03_2018$time, &quot;%Y/%m/%d %H:%M:%S&quot;) #Add hour month and day ## 11-05-2018 mclim_AG05_TN03_2018$hr &lt;- hour(mclim_AG05_TN03_2018$time) mclim_AG05_TN03_2018$minute&lt;- minute(mclim_AG05_TN03_2018$time) mclim_AG05_TN03_2018$day &lt;- day(mclim_AG05_TN03_2018$time) mclim_AG05_TN03_2018$month&lt;- month(mclim_AG05_TN03_2018$time) #Roughly one feet apart mclim_AG05_TN03_2018$height &lt;- 0 mclim_AG05_TN03_2018[mclim_AG05_TN03_2018$nodeid==&#39;282E997791080298&#39; ,]$height &lt;- 0.6 mclim_AG05_TN03_2018[mclim_AG05_TN03_2018$nodeid==&#39;28A005779106022B&#39; ,]$height &lt;- 1.2 mclim_AG05_TN03_2018[mclim_AG05_TN03_2018$nodeid==&#39;286EF577910A024C&#39; ,]$height &lt;- 0.3 mclim_AG05_TN03_2018[mclim_AG05_TN03_2018$nodeid==&#39;2886E177910902F2&#39; ,]$height &lt;- 0.9 ## Day plot , Representive day mclim_AG05_TN03_2018 %&gt;% filter(month(time) %in% &#39;9&#39; &amp; day %in% c(10)) %&gt;% ggplot( aes(time,temp,color = factor(height))) + geom_line() + theme_minimal() + ggtitle(&quot;Variation in temperature at AG05- TN03 Open&quot;) + xlab(&quot;Date&quot;) + ylab(&quot;Temperature (°C)&quot;) + labs(colour = &quot;Height (m)&quot;, subtitle=&quot;&quot;,caption=&quot;Data Source : http://nanoclimate.org&quot;) AM16 Narada falls, expect it to be much cooler as its a bog where the CN is and others are little above. TN01 mclim_AM16_TN01_2018&lt;- read.csv(&#39;./data/DATALOG-AM16-TN01.CSV&#39;) names(mclim_AM16_TN01_2018) &lt;- c(&#39;time&#39;,&#39;nodeid&#39;,&#39;temp&#39;,&#39;batt&#39;) mclim_AM16_TN01_2018$time &lt;- as.POSIXct(mclim_AM16_TN01_2018$time, &quot;%Y/%m/%d %H:%M:%S&quot;) #Add hour month and day ## 11-05-2018 mclim_AM16_TN01_2018$hr &lt;- hour(mclim_AM16_TN01_2018$time) mclim_AM16_TN01_2018$minute&lt;- minute(mclim_AM16_TN01_2018$time) mclim_AM16_TN01_2018$day &lt;- day(mclim_AM16_TN01_2018$time) mclim_AM16_TN01_2018$month&lt;- month(mclim_AM16_TN01_2018$time) #Roughly one feet apart mclim_AM16_TN01_2018$height &lt;- 0 mclim_AM16_TN01_2018[mclim_AM16_TN01_2018$nodeid==&#39;28D216779104027E&#39; ,]$height &lt;- 0.6 mclim_AM16_TN01_2018[mclim_AM16_TN01_2018$nodeid==&#39;28BC8B77910802B8&#39; ,]$height &lt;- 1.2 mclim_AM16_TN01_2018[mclim_AM16_TN01_2018$nodeid==&#39;28B50A7791040265&#39; ,]$height &lt;- 0.3 mclim_AM16_TN01_2018[mclim_AM16_TN01_2018$nodeid==&#39;28B18877910802BC&#39; ,]$height &lt;- 0.9 ## Day plot , Representive day mclim_AM16_TN01_2018 %&gt;% filter(month(time) %in% &#39;9&#39;) %&gt;% ggplot( aes(time,temp,color = factor(height))) + geom_line() + theme_minimal() + ggtitle(&quot;Variation in temperature at AM16- TN01 Closed&quot;) + xlab(&quot;Date&quot;) + ylab(&quot;Temperature (°C)&quot;) + labs(colour = &quot;Height(m)&quot;, subtitle=&quot;9/17/2018&quot;,caption=&quot;Data Source : http://nanoclimate.org&quot;) mclim_AM16_TN02_2018&lt;- read.csv(&#39;./data/DATALOG-AM16-TN02.CSV&#39;) names(mclim_AM16_TN02_2018) &lt;- c(&#39;time&#39;,&#39;nodeid&#39;,&#39;temp&#39;,&#39;batt&#39;) mclim_AM16_TN02_2018$time &lt;- as.POSIXct(mclim_AM16_TN02_2018$time, &quot;%Y/%m/%d %H:%M:%S&quot;) #Add hour month and day ## 11-05-2018 mclim_AM16_TN02_2018$hr &lt;- hour(mclim_AM16_TN02_2018$time) mclim_AM16_TN02_2018$minute&lt;- minute(mclim_AM16_TN02_2018$time) mclim_AM16_TN02_2018$day &lt;- day(mclim_AM16_TN02_2018$time) mclim_AM16_TN02_2018$month&lt;- month(mclim_AM16_TN02_2018$time) #Roughly one feet apart mclim_AM16_TN02_2018$height &lt;- 0 mclim_AM16_TN02_2018[mclim_AM16_TN02_2018$nodeid==&#39;28439C77910802C3&#39; ,]$height &lt;- 0.6 mclim_AM16_TN02_2018[mclim_AM16_TN02_2018$nodeid==&#39;28F4B977910902AF&#39; ,]$height &lt;- 1.2 mclim_AM16_TN02_2018[mclim_AM16_TN02_2018$nodeid==&#39;28D9657791100272&#39; ,]$height &lt;- 0.3 mclim_AM16_TN02_2018[mclim_AM16_TN02_2018$nodeid==&#39;28C928779106026A&#39; ,]$height &lt;- 0.9 ## Day plot , Representive day mclim_AM16_TN02_2018 %&gt;% filter(month(time) %in% &#39;9&#39;) %&gt;% ggplot( aes(time,temp,color = factor(height))) + geom_line() + theme_minimal() + ggtitle(&quot;Variation in temperature at AM16- TN02 Closed&quot;) + xlab(&quot;Date&quot;) + ylab(&quot;Temperature (°C)&quot;) + labs(colour = &quot;Height(m)&quot;, subtitle=&quot;9/17/2018&quot;,caption=&quot;Data Source : http://nanoclimate.org&quot;) Need to fix the hour mclim_AM16_TN03_2018&lt;- read.csv(&#39;./data/DATALOG-AM16-TN03.CSV&#39;) names(mclim_AM16_TN03_2018) &lt;- c(&#39;time&#39;,&#39;nodeid&#39;,&#39;temp&#39;,&#39;batt&#39;) mclim_AM16_TN03_2018$time &lt;- as.POSIXct(mclim_AM16_TN03_2018$time, &quot;%Y/%m/%d %H:%M:%S&quot;) #Add hour month and day ## 11-05-2018 mclim_AM16_TN03_2018$hr &lt;- hour(mclim_AM16_TN03_2018$time) mclim_AM16_TN03_2018$minute&lt;- minute(mclim_AM16_TN03_2018$time) mclim_AM16_TN03_2018$day &lt;- day(mclim_AM16_TN03_2018$time) mclim_AM16_TN03_2018$month&lt;- month(mclim_AM16_TN03_2018$time) #Roughly one feet apart mclim_AM16_TN03_2018$height &lt;- 0 mclim_AM16_TN03_2018[mclim_AM16_TN03_2018$nodeid==&#39;28A64677910302C1&#39; ,]$height &lt;- 0.6 mclim_AM16_TN03_2018[mclim_AM16_TN03_2018$nodeid==&#39;28542677910A027E&#39; ,]$height &lt;- 1.2 mclim_AM16_TN03_2018[mclim_AM16_TN03_2018$nodeid==&#39;28EE7977910802DD&#39; ,]$height &lt;- 0.3 mclim_AM16_TN03_2018[mclim_AM16_TN03_2018$nodeid==&#39;283D867791080289&#39; ,]$height &lt;- 0.9 ## Day plot , Representive day mclim_AM16_TN03_2018 %&gt;% filter(month(time) %in% &#39;9&#39; &amp; height !=0) %&gt;% ggplot( aes(time,temp,color = factor(height))) + geom_line() + theme_minimal() + ggtitle(&quot;Variation in temperature at AM16- TN03 Open&quot;) + xlab(&quot;Date&quot;) + ylab(&quot;Temperature (°C)&quot;) + labs(colour = &quot;Height(m)&quot;, subtitle=&quot;9/17/2018&quot;,caption=&quot;Data Source : http://nanoclimate.org&quot;) To do CN01 for AM16 which is on the bog. TO04 - expect it to be cold but stull warmer than the rest mclim_TO04_TN01_2018&lt;- read.csv(&#39;./data/DATALOG-TO04-TN01.CSV&#39;) names(mclim_TO04_TN01_2018) &lt;- c(&#39;time&#39;,&#39;nodeid&#39;,&#39;temp&#39;,&#39;batt&#39;) mclim_TO04_TN01_2018$time &lt;- as.POSIXct(mclim_TO04_TN01_2018$time, &quot;%Y/%m/%d %H:%M:%S&quot;) #Add hour month and day ## 11-05-2018 mclim_TO04_TN01_2018$hr &lt;- hour(mclim_TO04_TN01_2018$time) mclim_TO04_TN01_2018$minute&lt;- minute(mclim_TO04_TN01_2018$time) mclim_TO04_TN01_2018$day &lt;- day(mclim_TO04_TN01_2018$time) mclim_TO04_TN01_2018$month&lt;- month(mclim_TO04_TN01_2018$time) #Roughly one feet apart mclim_TO04_TN01_2018$height &lt;- 0 mclim_TO04_TN01_2018[mclim_TO04_TN01_2018$nodeid==&#39;2883A377910802B7&#39; ,]$height &lt;- 0.6 mclim_TO04_TN01_2018[mclim_TO04_TN01_2018$nodeid==&#39;28B14477910F02D1&#39; ,]$height &lt;- 1.2 mclim_TO04_TN01_2018[mclim_TO04_TN01_2018$nodeid==&#39;28783877910402B7&#39; ,]$height &lt;- 0.3 mclim_TO04_TN01_2018[mclim_TO04_TN01_2018$nodeid==&#39;286919779106027F&#39; ,]$height &lt;- 0.9 ## Day plot , Representive day mclim_TO04_TN01_2018 %&gt;% filter(month(time) %in% &#39;9&#39; &amp; temp != -127) %&gt;% ggplot( aes(time,temp,color = factor(height))) + geom_line() + theme_minimal() + ggtitle(&quot;Variation in temperature at TO04- TN01 Closed&quot;) + xlab(&quot;Date&quot;) + ylab(&quot;Temperature (°C)&quot;) + labs(colour = &quot;Height(m)&quot;, subtitle=&quot;9/17/2018&quot;,caption=&quot;Data Source : http://nanoclimate.org&quot;) mclim_TO04_TN02_2018&lt;- read.csv(&#39;./data/DATALOG-TO04-TN02.CSV&#39;) names(mclim_TO04_TN02_2018) &lt;- c(&#39;time&#39;,&#39;nodeid&#39;,&#39;temp&#39;,&#39;batt&#39;) mclim_TO04_TN02_2018$time &lt;- as.POSIXct(mclim_TO04_TN02_2018$time, &quot;%Y/%m/%d %H:%M:%S&quot;) #Add hour month and day ## 11-05-2018 mclim_TO04_TN02_2018$hr &lt;- hour(mclim_TO04_TN02_2018$time) mclim_TO04_TN02_2018$minute&lt;- minute(mclim_TO04_TN02_2018$time) mclim_TO04_TN02_2018$day &lt;- day(mclim_TO04_TN02_2018$time) mclim_TO04_TN02_2018$month&lt;- month(mclim_TO04_TN02_2018$time) #Roughly one feet apart mclim_TO04_TN02_2018$height &lt;- 0 mclim_TO04_TN02_2018[mclim_TO04_TN02_2018$nodeid==&#39;28A13C7791130278&#39; ,]$height &lt;- 0.6 mclim_TO04_TN02_2018[mclim_TO04_TN02_2018$nodeid==&#39;2893977791080277&#39; ,]$height &lt;- 1.2 mclim_TO04_TN02_2018[mclim_TO04_TN02_2018$nodeid==&#39;28414B77910F02CC&#39; ,]$height &lt;- 0.3 mclim_TO04_TN02_2018[mclim_TO04_TN02_2018$nodeid==&#39;28F94277910F0299&#39; ,]$height &lt;- 0.9 ## Day plot , Representive day mclim_TO04_TN02_2018 %&gt;% filter(month(time) %in% &#39;9&#39; &amp; temp != -127) %&gt;% ggplot( aes(time,temp,color = factor(height))) + geom_line() + theme_minimal() + ggtitle(&quot;Variation in temperature at TO04- TN02 Open&quot;) + xlab(&quot;Date&quot;) + ylab(&quot;Temperature (°C)&quot;) + labs(colour = &quot;Height(m)&quot;, subtitle=&quot;9/17/2018&quot;,caption=&quot;Data Source : http://nanoclimate.org&quot;) mclim_TO04_TN03_2018&lt;- read.csv(&#39;./data/DATALOG-TO04-TN03.CSV&#39;) names(mclim_TO04_TN03_2018) &lt;- c(&#39;time&#39;,&#39;nodeid&#39;,&#39;temp&#39;,&#39;batt&#39;) mclim_TO04_TN03_2018$time &lt;- as.POSIXct(mclim_TO04_TN03_2018$time, &quot;%Y/%m/%d %H:%M:%S&quot;) #Add hour month and day ## 11-05-2018 mclim_TO04_TN03_2018$hr &lt;- hour(mclim_TO04_TN03_2018$time) mclim_TO04_TN03_2018$minute&lt;- minute(mclim_TO04_TN03_2018$time) mclim_TO04_TN03_2018$day &lt;- day(mclim_TO04_TN03_2018$time) mclim_TO04_TN03_2018$month&lt;- month(mclim_TO04_TN03_2018$time) #Roughly one feet apart mclim_TO04_TN03_2018$height &lt;- 0 mclim_TO04_TN03_2018[mclim_TO04_TN03_2018$nodeid==&#39;28CC077791040287&#39; ,]$height &lt;- 0.6 mclim_TO04_TN03_2018[mclim_TO04_TN03_2018$nodeid==&#39;288EEB77910902EE&#39; ,]$height &lt;- 1.2 mclim_TO04_TN03_2018[mclim_TO04_TN03_2018$nodeid==&#39;28D7C67791090242&#39; ,]$height &lt;- 0.3 mclim_TO04_TN03_2018[mclim_TO04_TN03_2018$nodeid==&#39;286EDA779109028E&#39; ,]$height &lt;- 0.9 ## Day plot , Representive day mclim_TO04_TN03_2018 %&gt;% filter(month(time) %in% &#39;9&#39; &amp; temp != -127) %&gt;% ggplot( aes(time,temp,color = factor(height))) + geom_line() + theme_minimal() + ggtitle(&quot;Variation in temperature at TO04- TN03 Closed&quot;) + xlab(&quot;Date&quot;) + ylab(&quot;Temperature (°C)&quot;) + labs(colour = &quot;Height(m)&quot;, subtitle=&quot;9/17/2018&quot;,caption=&quot;Data Source : http://nanoclimate.org&quot;) 8.30 1-17-2019 ae10_TN01 &lt;- mclim_AE10_TN01_2018 %&gt;% filter ( month %in% c(9) &amp; height == 0.9) %&gt;% filter( day &gt; 4 &amp; day &lt; 16) %&gt;% group_by(month,day,hr) %&gt;% add_count(wt=3) %&gt;% summarise(m1= mean(temp)) %&gt;% group_by(day,hr) %&gt;% as.data.frame() ae10_TN01$site &lt;- &#39;AE10_TN01&#39; ag05_TN01 &lt;- mclim_AG05_TN01_2018 %&gt;% filter (month %in% c(9) &amp; height == 1.2) %&gt;% filter( day &gt; 4 &amp; day &lt; 16) %&gt;% group_by(month,day,hr) %&gt;% add_count(wt=3) %&gt;% summarise(m1= mean(temp)) %&gt;% group_by(day,hr) %&gt;% as.data.frame() ag05_TN01$site &lt;- &#39;AG05_TN01&#39; am16_TN01 &lt;- mclim_AM16_TN01_2018 %&gt;% filter (month %in% c(9) &amp; height == 1.2) %&gt;% filter( day &gt; 4 &amp; day &lt; 16) %&gt;% group_by(month,day,hr) %&gt;% add_count(wt=3) %&gt;% summarise(m1= mean(temp)) %&gt;% group_by(day,hr) %&gt;% as.data.frame() am16_TN01$site &lt;- &#39;AM16_TN01&#39; TO04_TN01 &lt;- mclim_TO04_TN01_2018 %&gt;% filter (month %in% c(9) &amp; height == 1.2 &amp; temp != -127) %&gt;% filter( day &gt; 4 &amp; day &lt; 16) %&gt;% group_by(month,day,hr) %&gt;% add_count(wt=3) %&gt;% summarise(m1= mean(temp)) %&gt;% group_by(day,hr) %&gt;% as.data.frame() TO04_TN01$site &lt;- &#39;TO04_TN01&#39; combined_across_MM &lt;- rbind(ae10_TN01, ag05_TN01, am16_TN01, TO04_TN01, Paradise_5to15, Sunrise_5to15) combined_across_MM %&gt;% filter (month %in% c(9) ) %&gt;% filter( day %in% c(5,6,7,8,9,10,11,12,13,14) ) %&gt;% ggplot() + geom_line(aes(hr,m1,color = site),se=F)+ facet_grid(. ~ day, scales = &quot;free&quot;) + scale_color_manual(&quot;Site(m)&quot;,values=c(&quot;AE10_TN01&quot;=1,&quot;AG05_TN01&quot;=2,&quot;AM16_TN01&quot;=3,&quot;TO04_TN01&quot;=4,&quot;Paradise_1645&quot;=5,&quot;Sunrise_2097&quot;=6)) + theme_classic() + ggtitle(&quot;Diel variation in Temperature at different sites in comparison to micromet&quot;) + xlab(&quot;Hour&quot;) + ylab(&quot;Temperature (°C)&quot;) + labs(colour = &quot;Hour&quot;, subtitle=&quot;1 hr resolution&quot;,caption=&quot;Data Source : http://www.nanoclimate.org&quot;) Battery voltages ae10_TN01_batt &lt;- mclim_AE10_TN01_2018 %&gt;% filter ( month %in% c(9) &amp; height == 0.9) %&gt;% filter( day &gt; 4 &amp; day &lt; 16) %&gt;% group_by(month,day,hr) %&gt;% add_count(wt=3) %&gt;% summarise(m1= mean(batt)) %&gt;% group_by(day,hr) %&gt;% as.data.frame() ae10_TN01_batt$site &lt;- &#39;AE10_TN01&#39; ag05_TN01_batt &lt;- mclim_AG05_TN01_2018 %&gt;% filter (month %in% c(9) &amp; height == 1.2) %&gt;% filter( day &gt; 4 &amp; day &lt; 16) %&gt;% group_by(month,day,hr) %&gt;% add_count(wt=3) %&gt;% summarise(m1= mean(batt)) %&gt;% group_by(day,hr) %&gt;% as.data.frame() ag05_TN01_batt$site &lt;- &#39;AG05_TN01&#39; am16_TN01_batt &lt;- mclim_AM16_TN01_2018 %&gt;% filter (month %in% c(9) &amp; height == 1.2) %&gt;% filter( day &gt; 4 &amp; day &lt; 16) %&gt;% group_by(month,day,hr) %&gt;% add_count(wt=3) %&gt;% summarise(m1= mean(batt)) %&gt;% group_by(day,hr) %&gt;% as.data.frame() am16_TN01_batt$site &lt;- &#39;AM16_TN01&#39; TO04_TN01_batt &lt;- mclim_TO04_TN01_2018 %&gt;% filter (month %in% c(9) &amp; height == 1.2 ) %&gt;% filter( day &gt; 4 &amp; day &lt; 16) %&gt;% group_by(month,day,hr) %&gt;% add_count(wt=3) %&gt;% summarise(m1= mean(batt)) %&gt;% group_by(day,hr) %&gt;% as.data.frame() TO04_TN01_batt$site &lt;- &#39;TO04_TN01&#39; combined_batt_across_MM &lt;- rbind(ae10_TN01_batt, ag05_TN01_batt, am16_TN01_batt, TO04_TN01_batt) combined_batt_across_MM %&gt;% filter (month %in% c(9) ) %&gt;% filter( day %in% c(5,6,7,8,9,10,11,12,13,14) ) %&gt;% ggplot() + geom_line(aes(hr,m1,color = site),se=F)+ facet_grid(. ~ day, scales = &quot;free&quot;) + scale_color_manual(&quot;Site(m)&quot;,values=c(&quot;AE10_TN01&quot;=1,&quot;AG05_TN01&quot;=2,&quot;AM16_TN01&quot;=3,&quot;TO04_TN01&quot;=4,&quot;Paradise_1645&quot;=5,&quot;Sunrise_2097&quot;=6)) + theme_classic() + ggtitle(&quot;Diel variation in batt at different sMM sites&quot;) + xlab(&quot;Hour&quot;) + ylab(&quot;Temperature (°C)&quot;) + labs(colour = &quot;Hour&quot;, subtitle=&quot;1 hr resolution&quot;,caption=&quot;Data Source : http://www.nanoclimate.org&quot;) Difference between the heights ggplot(data=mclim_AM16_TN01_2018, aes(x=as.factor(height), y=temp)) + geom_boxplot(aes(fill=as.factor(height))) + ylab(&quot;Temperature&quot;) + xlab(&quot;Height&quot;) +ggtitle(&quot;AM16 -Narada Temp Boxplot&quot;) + stat_summary(fun.y=mean, geom=&quot;point&quot;, shape=5, size=4) + theme_minimal() mclim_AE10_TN01_2018 %&gt;% filter(temp != -127) %&gt;% ggplot(aes(x=as.factor(height), y=temp)) + geom_boxplot(aes(fill=as.factor(height))) + ylab(&quot;Temperature&quot;) + xlab(&quot;Height&quot;) +ggtitle(&quot;AE10 -Reflection Temp Boxplot&quot;) + stat_summary(fun.y=mean, geom=&quot;point&quot;, shape=5, size=4) + theme_minimal() mclim_AG05_TN01_2018 %&gt;% filter(temp != -127) %&gt;% ggplot(aes(x=as.factor(height), y=temp)) + geom_boxplot(aes(fill=as.factor(height))) + ylab(&quot;Temperature&quot;) + xlab(&quot;Height&quot;) +ggtitle(&quot;AG05 -Longmire Temp Boxplot&quot;) + stat_summary(fun.y=mean, geom=&quot;point&quot;, shape=5, size=4) + theme_minimal() mclim_TO04_TN01_2018 %&gt;% filter(temp != -127) %&gt;% ggplot(aes(x=as.factor(height), y=temp)) + geom_boxplot(aes(fill=as.factor(height))) + ylab(&quot;Temperature&quot;) + xlab(&quot;Height&quot;) +ggtitle(&quot;TO04 -Devils Temp Boxplot&quot;) + stat_summary(fun.y=mean, geom=&quot;point&quot;, shape=5, size=4) + theme_minimal() Open vs Closed - Expect to see higher temperatures ad more variability AE10 - TN01 - Open AM16 - TN01 - Closed AG05 - TN01 - Closed TO04 - TN01 - Closed Looking at the above plots AE10 is warmer than the rest. 0.3 must be more turbulent than the rest, is it ? mclim_TO04_TN01_2018 %&gt;% filter(temp != -127) %&gt;% dplyr::group_by(height) %&gt;% dplyr::summarise(meant = mean(temp), cft = sd(temp)) %&gt;% ggplot(aes(x=as.factor(height), y=cft)) + geom_boxplot(aes(fill=as.factor(height))) + ylab(&quot;Temperature&quot;) + xlab(&quot;Height&quot;) +ggtitle(&quot;TO04 -Devils SD Temp Boxplot&quot;) + stat_summary(fun.y=mean, geom=&quot;point&quot;, shape=5, size=4) + theme_minimal() Looks like SD is the highest for 1.2 height, is it true for all of them ? mclim_AG05_TN01_2018 %&gt;% filter(temp != -127) %&gt;% dplyr::group_by(height) %&gt;% dplyr::summarise(meant = mean(temp), cft = sd(temp)) %&gt;% ggplot(aes(x=as.factor(height), y=cft)) + geom_boxplot(aes(fill=as.factor(height))) + ylab(&quot;Temperature&quot;) + xlab(&quot;Height&quot;) +ggtitle(&quot;AG05 -Longmire SD Temp Boxplot&quot;) + stat_summary(fun.y=mean, geom=&quot;point&quot;, shape=5, size=4) + theme_minimal() mclim_AM16_TN01_2018 %&gt;% filter(temp != -127) %&gt;% dplyr::group_by(height) %&gt;% dplyr::summarise(meant = mean(temp), cft = sd(temp)) %&gt;% ggplot(aes(x=as.factor(height), y=cft)) + geom_boxplot(aes(fill=as.factor(height))) + ylab(&quot;Temperature&quot;) + xlab(&quot;Height&quot;) +ggtitle(&quot;AM16 -Narada falls SD Temp Boxplot&quot;) + stat_summary(fun.y=mean, geom=&quot;point&quot;, shape=5, size=4) + theme_minimal() Falls in place for AM16, lets check fpr AE10 mclim_AE10_TN01_2018 %&gt;% filter(temp != -127) %&gt;% dplyr::group_by(height) %&gt;% dplyr::summarise(meant = mean(temp), cft = sd(temp)) %&gt;% ggplot(aes(x=as.factor(height), y=cft)) + geom_boxplot(aes(fill=as.factor(height))) + ylab(&quot;Temperature&quot;) + xlab(&quot;Height&quot;) +ggtitle(&quot;AE10 -Reflection falls SD Temp Boxplot&quot;) + stat_summary(fun.y=mean, geom=&quot;point&quot;, shape=5, size=4) + theme_minimal() ## 1-18-2019 Longmire hourly data MtRainier_coopsnowsep_longmire %&gt;% filter(year== 2018) %&gt;% ggplot() + geom_line(aes(Day,as.numeric(Min_Temperature),col=&#39;1&#39;)) + geom_line(aes(Day,as.numeric(Max_Temperature),col=&#39;2&#39;)) + geom_line(data=MtRainier_coopsnowsep_skatecreek,aes(Day,as.numeric(Min_Temperature),col=&#39;3&#39;)) + geom_line(data=MtRainier_coopsnowsep_skatecreek,aes(Day,as.numeric(Max_Temperature),col=&#39;4&#39;)) + geom_line(data=MtRainier_coopsnowsep_Paradise,aes(Day,as.numeric(Min_Temperature),col=&#39;5&#39;)) + geom_line(data=MtRainier_coopsnowsep_Paradise,aes(Day,as.numeric(Max_Temperature),col=&#39;6&#39;)) + theme_classic() + labs(x=&quot;Date&quot;, y=&quot;Temperature(°C) &quot;,subtitle=&quot;Coop/Snotel - Mt Rainier- Minimum/Max Recorded every day (2018) &quot;, caption=&quot;Data Source : utah state climate center&quot;) + geom_hline(aes(yintercept=9),colour=&quot;black&quot;, linetype=&quot;dashed&quot;) + scale_colour_manual(name = &#39;Heights(m)&#39;, values =c(&#39;1&#39;,&#39;2&#39;,&#39;3&#39;,&#39;4&#39;,&#39;5&#39;,&#39;6&#39;), labels = c(&#39;841(Longmire)-Min &#39;,&#39;841(Longmire)-Max &#39;,&#39;1149(Skatecreek)-Min&#39;,&#39;1149(Skatecreek)-Max&#39;,&quot;1654(Paradise)-Min&quot;,&quot;1654 (Paradise)-Max&quot;)) # head(MtRainier_coopsnowsep_longmire) # # daily_longmire &lt;- data.frame() # # R function # #get hourly temperatures # dtf = function(x, output) { # # x is the row of type Character # # access element in first column # date = x[1] # # min # min = as.numeric(x[3]) # # # max # max = as.numeric(x[4]) # # # day # day = x[5] # # # month # month = x[6] # # # year # year = x[7] # # for (hr in 1:24) # { # dayrecords &lt;- TrenchR::diurnal_temp_variation_sine(Tmn=min,Tmx=max,Hr=hr) # print(paste(date,dayrecords,hr,min,max,day,month,year,sep = &#39;,&#39;)) # daily_longmire &lt;- rbind(daily_longmire, dayrecords) # } # # # } # # MtRainier_coopsnowsep_longmire_ss &lt;- MtRainier_coopsnowsep_longmire %&gt;% dplyr::filter(month==9 &amp; day &gt; 0 &amp; day &lt; 25) %&gt;% as.data.frame() # # MtRainier_coopsnowsep_longmire_ss$Min_Temperature &lt;- as.numeric(MtRainier_coopsnowsep_longmire_ss$Min_Temperature) # # MtRainier_coopsnowsep_longmire_ss$Max_Temperature &lt;- as.numeric(MtRainier_coopsnowsep_longmire_ss$Max_Temperature) # # df &lt;- apply(MtRainier_coopsnowsep_longmire_ss, 1, dtf) Prepare Longmire hourly longmire_hrly &lt;- read_csv(&#39;./data/longmire_hourly&#39;) ## Parsed with column specification: ## cols( ## date = col_date(format = &quot;&quot;), ## m1 = col_double(), ## hr = col_double(), ## min = col_double(), ## max = col_double(), ## day = col_double(), ## month = col_double(), ## year = col_double() ## ) longmire_hrly_5to15 &lt;- longmire_hrly %&gt;% filter (month %in% c(9)) %&gt;% filter( day &gt; 4 &amp; day &lt; 16) %&gt;% group_by(month,day,hr) %&gt;% add_count(wt=3) %&gt;% summarise(m1= mean(m1)) %&gt;% group_by(day,hr) %&gt;% as.data.frame() longmire_hrly_5to15$site &lt;- &#39;Longmire_841&#39; ae10_TN01 &lt;- mclim_AE10_TN01_2018 %&gt;% filter ( month %in% c(9) &amp; height == 0.9) %&gt;% filter( day &gt; 4 &amp; day &lt; 16) %&gt;% group_by(month,day,hr) %&gt;% add_count(wt=3) %&gt;% summarise(m1= mean(temp)) %&gt;% group_by(day,hr) %&gt;% as.data.frame() ae10_TN01$site &lt;- &#39;AE10_TN01_1450&#39; ag05_TN01 &lt;- mclim_AG05_TN01_2018 %&gt;% filter (month %in% c(9) &amp; height == 1.2) %&gt;% filter( day &gt; 4 &amp; day &lt; 16) %&gt;% group_by(month,day,hr) %&gt;% add_count(wt=3) %&gt;% summarise(m1= mean(temp)) %&gt;% group_by(day,hr) %&gt;% as.data.frame() ag05_TN01$site &lt;- &#39;AG05_TN01_950&#39; am16_TN01 &lt;- mclim_AM16_TN01_2018 %&gt;% filter (month %in% c(9) &amp; height == 1.2) %&gt;% filter( day &gt; 4 &amp; day &lt; 16) %&gt;% group_by(month,day,hr) %&gt;% add_count(wt=3) %&gt;% summarise(m1= mean(temp)) %&gt;% group_by(day,hr) %&gt;% as.data.frame() am16_TN01$site &lt;- &#39;AM16_TN01_1200&#39; TO04_TN01 &lt;- mclim_TO04_TN01_2018 %&gt;% filter (month %in% c(9) &amp; height == 1.2 &amp; temp != -127) %&gt;% filter( day &gt; 4 &amp; day &lt; 16) %&gt;% group_by(month,day,hr) %&gt;% add_count(wt=3) %&gt;% summarise(m1= mean(temp)) %&gt;% group_by(day,hr) %&gt;% as.data.frame() TO04_TN01$site &lt;- &#39;TO04_TN01_650&#39; combined_across_MM &lt;- rbind(ae10_TN01, ag05_TN01, am16_TN01, TO04_TN01,longmire_hrly_5to15, Paradise_5to15, Sunrise_5to15) combined_across_MM %&gt;% filter (month %in% c(9) ) %&gt;% filter( day %in% c(5,6,7,8,9,10,11,12,13,14) ) %&gt;% ggplot() + geom_line(aes(hr,m1,color = site),se=F)+ facet_grid(. ~ day, scales = &quot;free&quot;) + scale_color_manual(&quot;Site(m)&quot;,values=c(&quot;AE10_TN01_1450&quot;=1,&quot;AG05_TN01_950&quot;=2,&quot;AM16_TN01_1200&quot;=3,&quot;TO04_TN01_650&quot;=4,&quot;Paradise_1645&quot;=5,&quot;Sunrise_2097&quot;=6,&quot;Longmire_841&quot;=8)) + theme_classic() + ggtitle(&quot;Diel variation in Temperature at different sites in comparison to micromet&quot;) + xlab(&quot;Hour&quot;) + ylab(&quot;Temperature (°C)&quot;) + labs(colour = &quot;Hour&quot;, subtitle=&quot;1 hr resolution&quot;,caption=&quot;Data Source : http://www.nanoclimate.org&quot;) Ford et. al understory structure had greater effect on daily maximum temperatures canopy had effect on 100m - avg daily max and minimum temperatures canopy gaps had higher max temps, but lower minimum and mean temps. Check the CV mclim_TO04_TN01_2018 %&gt;% filter(temp != -127) %&gt;% dplyr::group_by(height) %&gt;% dplyr::summarise(meant = mean(temp), cft = sd(temp)) %&gt;% ggplot(aes(x=as.factor(height), y=cft/meant)) + geom_boxplot(aes(fill=as.factor(height))) + ylab(&quot;Temperature&quot;) + xlab(&quot;Height&quot;) +ggtitle(&quot;TO04 -Devils CV Temp Boxplot&quot;) + stat_summary(fun.y=mean, geom=&quot;point&quot;, shape=5, size=4) + theme_minimal() mclim_AE10_TN01_2018 %&gt;% filter(temp != -127) %&gt;% dplyr::group_by(height) %&gt;% dplyr::summarise(meant = mean(temp), cft = sd(temp)) %&gt;% ggplot(aes(x=as.factor(height), y=cft/meant)) + geom_boxplot(aes(fill=as.factor(height))) + ylab(&quot;Temperature&quot;) + xlab(&quot;Height&quot;) +ggtitle(&quot;AE16 -Ref lakes CV Temp Boxplot&quot;) + stat_summary(fun.y=mean, geom=&quot;point&quot;, shape=5, size=4) + theme_minimal() mclim_AM16_TN01_2018 %&gt;% filter(temp != -127) %&gt;% dplyr::group_by(height) %&gt;% dplyr::summarise(meant = mean(temp), cft = sd(temp)) %&gt;% ggplot(aes(x=as.factor(height), y=cft/meant)) + geom_boxplot(aes(fill=as.factor(height))) + ylab(&quot;Temperature&quot;) + xlab(&quot;Height&quot;) +ggtitle(&quot;AM16 -Narada CV Temp Boxplot&quot;) + stat_summary(fun.y=mean, geom=&quot;point&quot;, shape=5, size=4) + theme_minimal() mclim_AG05_TN01_2018 %&gt;% filter(temp != -127) %&gt;% dplyr::group_by(height) %&gt;% dplyr::summarise(meant = mean(temp), cft = sd(temp)) %&gt;% ggplot(aes(x=as.factor(height), y=cft/meant)) + geom_boxplot(aes(fill=as.factor(height))) + ylab(&quot;Temperature&quot;) + xlab(&quot;Height&quot;) +ggtitle(&quot;AG05 -Longmire CV Temp Boxplot&quot;) + stat_summary(fun.y=mean, geom=&quot;point&quot;, shape=5, size=4) + theme_minimal() 8.31 1-24-2019 Verify Part 2 ae10_TN01_2 &lt;- mclim_AE10_TN01_2018 %&gt;% filter(temp != -127) %&gt;% filter ( month %in% c(9) &amp; height == 0.9) %&gt;% filter( day &gt; 14 &amp; day &lt; 30) %&gt;% group_by(month,day,hr) %&gt;% add_count(wt=3) %&gt;% summarise(m1= mean(temp)) %&gt;% group_by(day,hr) %&gt;% as.data.frame() ae10_TN01_2$site &lt;- &#39;AE10_TN01_1450&#39; ag05_TN02_2 &lt;- mclim_AG05_TN02_2018 %&gt;% filter(temp != -127) %&gt;% filter (month %in% c(9) &amp; height == 1.2) %&gt;% filter( day &gt; 14 &amp; day &lt; 30) %&gt;% group_by(month,day,hr) %&gt;% add_count(wt=3) %&gt;% summarise(m1= mean(temp)) %&gt;% group_by(day,hr) %&gt;% as.data.frame() ag05_TN02_2$site &lt;- &#39;AG05_TN02_950&#39; am16_TN02_2 &lt;- mclim_AM16_TN02_2018 %&gt;% filter(temp != -127) %&gt;% filter (month %in% c(9) &amp; height == 1.2) %&gt;% filter( day &gt; 14 &amp; day &lt; 30) %&gt;% group_by(month,day,hr) %&gt;% add_count(wt=3) %&gt;% summarise(m1= mean(temp)) %&gt;% group_by(day,hr) %&gt;% as.data.frame() am16_TN02_2$site &lt;- &#39;AM16_TN02_1200&#39; TO04_TN03_2 &lt;- mclim_TO04_TN03_2018 %&gt;% filter (month %in% c(9) &amp; height == 1.2 &amp; temp != -127) %&gt;% filter( day &gt; 14 &amp; day &lt; 30) %&gt;% group_by(month,day,hr) %&gt;% add_count(wt=3) %&gt;% summarise(m1= mean(temp)) %&gt;% group_by(day,hr) %&gt;% as.data.frame() TO04_TN03_2$site &lt;- &#39;TO04_TN03_650&#39; longmire_hrly_2 &lt;- longmire_hrly %&gt;% filter (month %in% c(9)) %&gt;% filter( day &gt; 14 &amp; day &lt; 30) %&gt;% group_by(month,day,hr) %&gt;% add_count(wt=3) %&gt;% summarise(m1= mean(m1)) %&gt;% group_by(day,hr) %&gt;% as.data.frame() longmire_hrly_2$site &lt;- &#39;Longmire_841&#39; Paradise_2 &lt;- MtRainier_Local_2018 %&gt;% filter (month %in% c(9) ) %&gt;% filter( day &gt; 14 &amp; day &lt; 30) %&gt;% mutate(m1=(Paradise_5400 - 32) * (5/9)) %&gt;% group_by(month,day,hr) %&gt;% dplyr::select(month,day,hr,m1) %&gt;% as.data.frame() Paradise_2$site &lt;- &#39;Paradise_1645&#39; Sunrise_2 &lt;- MtRainier_Local_2018 %&gt;% filter (month %in% c(9) ) %&gt;% filter( day &gt; 14 &amp; day &lt; 30) %&gt;% mutate(m1=(Sunrise_6880 - 32) * (5/9)) %&gt;% group_by(month,day,hr) %&gt;% dplyr::select(month,day,hr,m1) %&gt;% as.data.frame() Sunrise_2$site &lt;- &#39;Sunrise_2097&#39; combined_across_MM_2 &lt;- rbind(ae10_TN01_2, ag05_TN02_2, am16_TN02_2, TO04_TN03_2, longmire_hrly_2, Paradise_2, Sunrise_2) combined_across_MM_2 %&gt;% filter (month %in% c(9) ) %&gt;% filter( day %in% c(15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30) ) %&gt;% ggplot() + geom_line(aes(hr,m1,color = site),se=F)+ facet_grid(. ~ day, scales = &quot;free&quot;) + scale_color_manual(&quot;Site(m)&quot;,values=c(&quot;AE10_TN01_1450&quot;=1,&quot;AG05_TN02_950&quot;=2,&quot;AM16_TN02_1200&quot;=3,&quot;TO04_TN03_650&quot;=4,&quot;Paradise_1645&quot;=5,&quot;Sunrise_2097&quot;=6,&quot;Longmire_841&quot;=8)) + theme_classic() + ggtitle(&quot;Diel variation in Temperature at different sites in comparison to micromet&quot;) + xlab(&quot;Hour&quot;) + ylab(&quot;Temperature (°C)&quot;) + labs(colour = &quot;Hour&quot;, subtitle=&quot;1 hr resolution&quot;,caption=&quot;Data Source : http://www.nanoclimate.org&quot;) All the dates ae10_1 &lt;- ae10_TN01 ae10_1$site &lt;- &#39;AE10_1450&#39; ag05_1 &lt;- ag05_TN01 ag05_1$site &lt;- &#39;AG05_950&#39; am16_1 &lt;- am16_TN01 am16_1$site &lt;- &#39;AM16_1200&#39; TO04_1 &lt;- TO04_TN01 TO04_1$site &lt;- &#39;TO04_650&#39; Longmire_1 &lt;-longmire_hrly_5to15 Longmire_1$site &lt;- &#39;Longmire_841&#39; Paradise_1 &lt;-Paradise_5to15 Paradise_1$site &lt;- &#39;Paradise_1645&#39; #Sunrise_1 &lt;-Sunrise_5to15 Sunrise_1 &lt;- Sunrise_5to15 Sunrise_1$site &lt;- &#39;Sunrise_2097&#39; ae10_2 &lt;- ae10_TN01_2 ae10_2$site &lt;- &#39;AE10_1450&#39; ag05_2 &lt;- ag05_TN02_2 ag05_2$site &lt;- &#39;AG05_950&#39; am16_2 &lt;-am16_TN02_2 am16_2$site &lt;- &#39;AM16_1200&#39; TO04_2 &lt;- TO04_TN03_2 TO04_2$site &lt;- &#39;TO04_650&#39; Longmire_2 &lt;- longmire_hrly_2 Longmire_2$site &lt;- &#39;Longmire_841&#39; Paradise_2 &lt;- Paradise_2 Paradise_2$site &lt;- &#39;Paradise_1645&#39; Sunrise_2 &lt;- Sunrise_2 Sunrise_2$site &lt;- &#39;Sunrise_2097&#39; combined_across_MM_and_PP_Long &lt;- rbind(ae10_1, ag05_1, am16_1, TO04_1, Longmire_1, Paradise_1, Sunrise_1, ae10_2, ag05_2, am16_2, TO04_2, Longmire_2, Paradise_2, Sunrise_2) combined_across_MM_and_PP_Long %&gt;% filter (month %in% c(9) ) %&gt;% ggplot() + geom_line(aes(hr,m1,color = site),se=F)+ facet_grid(. ~ day, scales = &quot;free&quot;) + scale_color_manual(&quot;Site(m)&quot;,values=c(&quot;AE10_1450&quot;=1,&quot;AG05_950&quot;=2,&quot;AM16_1200&quot;=3,&quot;TO04_650&quot;=4,&quot;Paradise_1645&quot;=5,&quot;Sunrise_2097&quot;=6,&quot;Longmire_841&quot;=8)) + theme_classic() + ggtitle(&quot;Diel variation in Temperature at different sites in comparison to micromet&quot;) + xlab(&quot;Hour&quot;) + ylab(&quot;Temperature (°C)&quot;) + labs(colour = &quot;Hour&quot;, subtitle=&quot;1 hr resolution&quot;,caption=&quot;Data Source : http://www.nanoclimate.org&quot;) 8.32 1-29-2019 Do we see distinct diurnal patterns at differnt height, is it relavsnt to the plants Get the te,p profile 8.33 2-03-2019 Below canopy you get 1% of sunlight, what does that translate to ? compare it with JHRL lux There is no simple conversion….it depends on the wavelength or color of the light. However, for the SUN, there is an approximate conversion of 0.0079 W/m2 per Lux.(ResearchGate) AE10_S1_2018&lt;- read.csv(&#39;./data/2018/AE10-S1.csv&#39;) colnames(AE10_S1_2018) &lt;- c(&#39;#&#39;,&#39;datetime&#39;,&#39;Temp&#39;,&#39;Lux&#39;,&#39;CoupAttach&#39;,&#39;HostConn&#39;,&#39;Stopped&#39;,&#39;eof&#39;) AE10_S1_2018$timect &lt;- as.POSIXct(AE10_S1_2018$datetime, format=&quot;%m/%d/%y %I:%M:%S %p&quot;,tz=&quot;America/Los_Angeles&quot;) AE10_S1_2018$hr &lt;- hour(AE10_S1_2018$timect) AE10_S1_2018$minute &lt;- minute(AE10_S1_2018$timect) AE10_S1_2018$day &lt;- day(AE10_S1_2018$timect) AE10_S1_2018$month&lt;- month(AE10_S1_2018$timect) AE10_S1_2018$year&lt;- year(AE10_S1_2018$timect) AE10_S1_2018 %&gt;% ggplot() + geom_point(aes(timect,Temp,col=&#39;AE10-S1&#39;)) + geom_line(aes(timect,Temp)) + theme_classic() + labs(x=&quot;Date&quot;, y=&quot;Temperature(°C) &quot;,subtitle=&quot;Air hobo AE10 S1 - Mt Rainie -Recorded every 3 hours (2018) &quot;, caption=&quot;Data Source : JHRL&quot;) + geom_hline(aes(yintercept=9),colour=&quot;black&quot;, linetype=&quot;dashed&quot;) + scale_colour_manual(name = &#39;Heights(m)&#39;, values =c(&#39;red&#39;,&#39;blue&#39;,&#39;green&#39;), labels = c(&#39;1645&#39;,&#39;2097&#39;,&quot;3081&quot;)) Lets compare temperature of 2017 AE10_S1_2018 %&gt;% filter(year %in% c(2017)) %&gt;% ggplot() + geom_point(aes(timect,Temp,col=&#39;AE10-S1&#39;)) + geom_line(aes(timect,Temp)) + theme_classic() + labs(x=&quot;Date&quot;, y=&quot;Temperature(°C) &quot;,subtitle=&quot;Air hobo AE10 S1 - Mt Rainie -Recorded every 3 hours (2018) &quot;, caption=&quot;Data Source : JHRL&quot;) + geom_hline(aes(yintercept=9),colour=&quot;black&quot;, linetype=&quot;dashed&quot;) + scale_colour_manual(name = &#39;Heights(m)&#39;, values =c(&#39;red&#39;,&#39;blue&#39;,&#39;green&#39;), labels = c(&#39;1645&#39;,&#39;2097&#39;,&quot;3081&quot;)) Lot of days where its colder, compare it with air temp for same year at 1.2 , should tell the kind of height relation AE10_S1_2018 %&gt;% filter(year %in% c(2017) &amp; month %in% c(9,10)) %&gt;% ggplot() + # geom_point(aes(timect,Temp,col=&#39;AE10-S1&#39;)) + geom_line(aes(timect,Temp,col=&#39;S1&#39;)) + geom_line(data=MtRainier_AE10A1_1718[MtRainier_AE10A1_1718$year==2017 &amp; MtRainier_AE10A1_1718$month %in% c(9,10),],aes(timect,Temp,col=&#39;M1&#39;)) + # geom_point(data=MtRainier_AE10A1_1718[MtRainier_AE10A1_1718$year==2017 &amp; MtRainier_AE10A1_1718$month %in% c(9,10),],aes(timect,Temp,col=&#39;AE10-A1&#39;)) + theme_classic() + labs(x=&quot;Date&quot;, y=&quot;Temperature(°C) &quot;,subtitle=&quot;Air hobo AE10 S1 - Mt Rainie -Recorded every 3 hours (2018) &quot;, caption=&quot;Data Source : JHRL&quot;) + geom_hline(aes(yintercept=9),colour=&quot;black&quot;, linetype=&quot;dashed&quot;) Ground temp looks warmer, lets look for a shorter week 8.34 2-04-2019 AE10_S1_2018 %&gt;% filter(year %in% c(2017) &amp; month %in% c(9) &amp; day %in% c(15:25) ) %&gt;% ggplot() + # geom_point(aes(timect,Temp,col=&#39;AE10-S1&#39;)) + geom_line(aes(hr,Temp,col=&#39;S1&#39;)) + geom_line(data=MtRainier_AE10A1_1718[MtRainier_AE10A1_1718$year==2017 &amp; MtRainier_AE10A1_1718$month %in% c(9) &amp; MtRainier_AE10A1_1718$day %in% c(15:25),],aes(hr,Temp,col=&#39;M1&#39;)) + # geom_point(data=MtRainier_AE10A1_1718[MtRainier_AE10A1_1718$year==2017 &amp; MtRainier_AE10A1_1718$month %in% c(9,10),],aes(timect,Temp,col=&#39;AE10-A1&#39;)) + facet_grid(. ~ day, scales = &quot;free&quot;) + theme_classic() + labs(x=&quot;Date&quot;, y=&quot;Temperature(°C) &quot;,subtitle=&quot;Air hobo AE10 S1 - Mt Rainie -Recorded every 3 hours (2017) &quot;, caption=&quot;Data Source : JHRL&quot;) + geom_hline(aes(yintercept=9),colour=&quot;black&quot;, linetype=&quot;dashed&quot;) Todo, explain one day of two curves, look at solar radiation for Lux and Paradise The conversion of Lux to W/m^2 https://cumulus.hosiene.co.uk/viewtopic.php?t=3979 AE10_S1_2018 %&gt;% filter(year %in% c(2017) &amp; month %in% c(9) &amp; day %in% c(15:25) ) %&gt;% mutate(LuxinWM2 = Lux * 0.0079 ) %&gt;% ggplot() + geom_line(aes(hr,LuxinWM2,col=&#39;S1&#39;)) + geom_line(data = Paradise_2017[Paradise_2017$month %in% c(&#39;09&#39;) &amp; Paradise_2017$day %in% c(17:25),], aes(hour,Solar.Pyranometer..W.m2.,col=&#39;Paradise&#39;) ) + geom_line(data = Paradise_2017[Paradise_2017$month %in% c(&#39;09&#39;) &amp; Paradise_2017$day %in% c(17:25),], aes(hour,.05* Solar.Pyranometer..W.m2.,col=&#39;Paradise5Pct&#39;) ) + facet_grid(. ~ day, scales = &quot;free&quot;) + # scale_x_datetime(labels=date_format(&quot;%H&quot;)) + theme(axis.text.x=element_text(angle=90)) + theme_classic() + labs(colour = &quot;Site&quot;,x=&quot;Date&quot;, y=&quot; Solar Irradiance(W/m^2) &quot;,subtitle=&quot;Ground Lux S1 AE10 compared to Paradise -Recorded every 3 hours (Sept 2017) &quot;, caption=&quot;Data Source : JHRL&quot;) So, ground solar radiation is less than what is above canopy So, if our scaling is correct, looks like Ground is warmer than on colder days or when its overcast Lets compare it with Paradise (5400), if clouds are below the elevation, then it should be more warmer (i.e. the AE10 sites) AE10_S1_2018 %&gt;% filter(year %in% c(2017) &amp; month %in% c(9) &amp; day %in% c(15:25) ) %&gt;% ggplot() + # geom_point(aes(timect,Temp,col=&#39;AE10-S1&#39;)) + geom_line(aes(hr,Temp,col=&#39;S1&#39;)) + geom_line(data=MtRainier_AE10A1_1718[MtRainier_AE10A1_1718$year==2017 &amp; MtRainier_AE10A1_1718$month %in% c(9) &amp; MtRainier_AE10A1_1718$day %in% c(15:25),],aes(hr,Temp,col=&#39;M1&#39;)) + geom_line(data=Paradise_5400_2017[Paradise_5400_2017$month %in% c(9) &amp; Paradise_5400_2017$day %in% c(15:25),],aes(hr,weathermetrics::fahrenheit.to.celsius(Temperature..deg.F.),col=&#39;Paradise&#39;)) + # geom_point(data=MtRainier_AE10A1_1718[MtRainier_AE10A1_1718$year==2017 &amp; MtRainier_AE10A1_1718$month %in% c(9,10),],aes(timect,Temp,col=&#39;AE10-A1&#39;)) + facet_grid(. ~ day, scales = &quot;free&quot;) + theme_classic() + labs(x=&quot;Date&quot;, y=&quot;Temperature(°C) &quot;,subtitle=&quot;Air hobo AE10 S1 - Mt Rainier -Recorded every 3 hours (2017) &quot;, caption=&quot;Data Source : JHRL&quot;) + geom_hline(aes(yintercept=9),colour=&quot;black&quot;, linetype=&quot;dashed&quot;) Some days, looks like cold days, the ground is warmer consistently, even much warmer than the air temp for the same day. Ideal - In the mornings ground is coller than air, till yu reach solar max (11 am), after yu get to max, the ground is much warmer, so the air is less warmer than ground, and it remains like it thru early mornings. Switching back to year 2019, lets liok at how the Solar radation load looked like AM16 mclim_AM16_CN01_2018&lt;-read_csv(&#39;./data/DATALOG-AM16-CN01.CSV&#39;) ## Parsed with column specification: ## cols( ## date = col_character(), ## temp1 = col_double(), ## temp2 = col_double(), ## temp3 = col_double(), ## temp4 = col_double(), ## windspeed1 = col_double(), ## windspeed2 = col_double(), ## windspeed3 = col_double(), ## windspeed4 = col_double(), ## winddirection1 = col_double(), ## winddirection2 = col_double(), ## winddirection3 = col_double(), ## winddirection4 = col_double(), ## solar = col_double(), ## battery = col_double() ## ) #mclim_AE10_CN01_2018&lt;- read.csv(&#39;./data/DATALOG-AE10-CN01.CSV&#39;,stringsAsFactors = T) names(mclim_AM16_CN01_2018) ## [1] &quot;date&quot; &quot;temp1&quot; &quot;temp2&quot; &quot;temp3&quot; ## [5] &quot;temp4&quot; &quot;windspeed1&quot; &quot;windspeed2&quot; &quot;windspeed3&quot; ## [9] &quot;windspeed4&quot; &quot;winddirection1&quot; &quot;winddirection2&quot; &quot;winddirection3&quot; ## [13] &quot;winddirection4&quot; &quot;solar&quot; &quot;battery&quot; mclim_AM16_CN01_2018$time &lt;- as_datetime(mclim_AM16_CN01_2018$date, format=&quot;%m/%d/%y %H:%M:%S&quot;,tz=&quot;America/Los_Angeles&quot;) mclim_AM16_CN01_2018$time &lt;-as.POSIXct(mclim_AM16_CN01_2018$time) #Add hour month and day ## 11-05-2018 mclim_AM16_CN01_2018$hr &lt;- hour(mclim_AM16_CN01_2018$time) mclim_AM16_CN01_2018$minute &lt;- minute(mclim_AM16_CN01_2018$time) mclim_AM16_CN01_2018$day &lt;- day(mclim_AM16_CN01_2018$time) mclim_AM16_CN01_2018$month&lt;- month(mclim_AM16_CN01_2018$time) #Roughly one feet apart mclim_AM16_CN01_2018$height &lt;- 0 #therm1,28782877910A0217 - 0.6 #therm2,284CCE7791090235 - 1.2 #therm3,286C7A7791080217 - 0.9 #therm4,280A2577910A020D - 0.3 # mclim_AE10_CN01_2018[mclim_AE10_CN01_2018$nodeid==&#39;2862367791040281&#39; ,]$height &lt;- 1.2 # mclim_AE10_CN01_2018[mclim_AE10_CN01_2018$nodeid==&#39;286E9D77910802F2&#39; ,]$height &lt;- 0.6 # mclim_AE10_CN01_2018[mclim_AE10_CN01_2018$nodeid==&#39;28A91B7791060263&#39; ,]$height &lt;- 0.3 # mclim_AE10_CN01_2018[mclim_AE10_CN01_2018$nodeid==&#39;280704779106023F&#39; ,]$height &lt;- 0.9 ## Day plot , Representive day mclim_AM16_CN01_2018 %&gt;% filter(month %in% c(9) &amp; day(time) %in% c(8:15) &amp; hr %in% c(10,11,12,13)) %&gt;% ggplot() + geom_line( aes(time,windspeed1,color = &#39;0.6&#39;)) + geom_line( aes(time,windspeed2,color = &#39;1.2&#39;)) + geom_line( aes(time,windspeed3,color = &#39;0.9&#39;)) + geom_line( aes(time,windspeed4,color = &#39;0.3&#39;)) + theme_minimal() + facet_grid(. ~ day, scales = &quot;free&quot;) + ggtitle(&quot;Variation in wind at AM16 - Open&quot;) + xlab(&quot;Date&quot;) + ylab(&quot;Windspeed (k/h)&quot;) + labs(colour = &quot;Height(m)&quot;, subtitle=&quot;9/14/2018&quot;,caption=&quot;Data Source : http://nanoclimate.org&quot;) AG05 mclim_AG05_CN01_2018&lt;-read_csv(&#39;./data/DATALOG-AG05-CN01.CSV&#39;) ## Parsed with column specification: ## cols( ## date = col_character(), ## temp1 = col_double(), ## temp2 = col_double(), ## temp3 = col_double(), ## temp4 = col_double(), ## windspeed1 = col_double(), ## windspeed2 = col_double(), ## windspeed3 = col_double(), ## windspeed4 = col_double(), ## winddirection1 = col_double(), ## winddirection2 = col_double(), ## winddirection3 = col_double(), ## winddirection4 = col_double(), ## solar = col_double(), ## battery = col_double() ## ) #mclim_AE10_CN01_2018&lt;- read.csv(&#39;./data/DATALOG-AE10-CN01.CSV&#39;,stringsAsFactors = T) names(mclim_AG05_CN01_2018) ## [1] &quot;date&quot; &quot;temp1&quot; &quot;temp2&quot; &quot;temp3&quot; ## [5] &quot;temp4&quot; &quot;windspeed1&quot; &quot;windspeed2&quot; &quot;windspeed3&quot; ## [9] &quot;windspeed4&quot; &quot;winddirection1&quot; &quot;winddirection2&quot; &quot;winddirection3&quot; ## [13] &quot;winddirection4&quot; &quot;solar&quot; &quot;battery&quot; mclim_AG05_CN01_2018$time &lt;- as_datetime(mclim_AG05_CN01_2018$date, format=&quot;%m/%d/%y %H:%M:%S&quot;,tz=&quot;America/Los_Angeles&quot;) mclim_AG05_CN01_2018$time &lt;-as.POSIXct(mclim_AG05_CN01_2018$time) #Add hour month and day ## 11-05-2018 mclim_AG05_CN01_2018$hr &lt;- hour(mclim_AG05_CN01_2018$time) mclim_AG05_CN01_2018$minute &lt;- minute(mclim_AG05_CN01_2018$time) mclim_AG05_CN01_2018$day &lt;- day(mclim_AG05_CN01_2018$time) mclim_AG05_CN01_2018$month&lt;- month(mclim_AG05_CN01_2018$time) #Roughly one feet apart mclim_AG05_CN01_2018$height &lt;- 0 #therm1,28782877910A0217 - 0.6 #therm2,284CCE7791090235 - 1.2 #therm3,286C7A7791080217 - 0.9 #therm4,280A2577910A020D - 0.3 # mclim_AE10_CN01_2018[mclim_AE10_CN01_2018$nodeid==&#39;2862367791040281&#39; ,]$height &lt;- 1.2 # mclim_AE10_CN01_2018[mclim_AE10_CN01_2018$nodeid==&#39;286E9D77910802F2&#39; ,]$height &lt;- 0.6 # mclim_AE10_CN01_2018[mclim_AE10_CN01_2018$nodeid==&#39;28A91B7791060263&#39; ,]$height &lt;- 0.3 # mclim_AE10_CN01_2018[mclim_AE10_CN01_2018$nodeid==&#39;280704779106023F&#39; ,]$height &lt;- 0.9 ## Day plot , Representive day mclim_AG05_CN01_2018 %&gt;% filter(month %in% c(9) &amp; day(time) %in% c(10:20) &amp; hr %in% c(10,11,12,13)) %&gt;% ggplot() + geom_line( aes(time,windspeed1,color = &#39;0.6&#39;)) + geom_line( aes(time,windspeed2,color = &#39;1.2&#39;)) + geom_line( aes(time,windspeed3,color = &#39;0.9&#39;)) + geom_line( aes(time,windspeed4,color = &#39;0.3&#39;)) + theme_minimal() + facet_grid(. ~ day, scales = &quot;free&quot;) + ggtitle(&quot;Variation in wind at AG05 - Open&quot;) + xlab(&quot;Date&quot;) + ylab(&quot;Windspeed (k/h)&quot;) + labs(colour = &quot;Height(m)&quot;, subtitle=&quot;9/14/2018&quot;,caption=&quot;Data Source : http://nanoclimate.org&quot;) TO04 mclim_TO04_CN01_2018&lt;-read_csv(&#39;./data/DATALOG-TO04-CN01.CSV&#39;) ## Parsed with column specification: ## cols( ## date = col_character(), ## temp1 = col_double(), ## temp2 = col_double(), ## temp3 = col_double(), ## temp4 = col_double(), ## windspeed1 = col_double(), ## windspeed2 = col_double(), ## windspeed3 = col_double(), ## windspeed4 = col_double(), ## winddirection1 = col_double(), ## winddirection2 = col_double(), ## winddirection3 = col_double(), ## winddirection4 = col_double(), ## solar = col_double(), ## battery = col_double() ## ) #mclim_AE10_CN01_2018&lt;- read.csv(&#39;./data/DATALOG-AE10-CN01.CSV&#39;,stringsAsFactors = T) names(mclim_TO04_CN01_2018) ## [1] &quot;date&quot; &quot;temp1&quot; &quot;temp2&quot; &quot;temp3&quot; ## [5] &quot;temp4&quot; &quot;windspeed1&quot; &quot;windspeed2&quot; &quot;windspeed3&quot; ## [9] &quot;windspeed4&quot; &quot;winddirection1&quot; &quot;winddirection2&quot; &quot;winddirection3&quot; ## [13] &quot;winddirection4&quot; &quot;solar&quot; &quot;battery&quot; mclim_TO04_CN01_2018$time &lt;- as_datetime(mclim_TO04_CN01_2018$date, format=&quot;%m/%d/%y %H:%M:%S&quot;,tz=&quot;America/Los_Angeles&quot;) mclim_TO04_CN01_2018$time &lt;-as.POSIXct(mclim_TO04_CN01_2018$time) #Add hour month and day ## 11-05-2018 mclim_TO04_CN01_2018$hr &lt;- hour(mclim_TO04_CN01_2018$time) mclim_TO04_CN01_2018$minute &lt;- minute(mclim_TO04_CN01_2018$time) mclim_TO04_CN01_2018$day &lt;- day(mclim_TO04_CN01_2018$time) mclim_TO04_CN01_2018$month&lt;- month(mclim_TO04_CN01_2018$time) #Roughly one feet apart mclim_TO04_CN01_2018$height &lt;- 0 #therm1,28782877910A0217 - 0.6 #therm2,284CCE7791090235 - 1.2 #therm3,286C7A7791080217 - 0.9 #therm4,280A2577910A020D - 0.3 # mclim_AE10_CN01_2018[mclim_AE10_CN01_2018$nodeid==&#39;2862367791040281&#39; ,]$height &lt;- 1.2 # mclim_AE10_CN01_2018[mclim_AE10_CN01_2018$nodeid==&#39;286E9D77910802F2&#39; ,]$height &lt;- 0.6 # mclim_AE10_CN01_2018[mclim_AE10_CN01_2018$nodeid==&#39;28A91B7791060263&#39; ,]$height &lt;- 0.3 # mclim_AE10_CN01_2018[mclim_AE10_CN01_2018$nodeid==&#39;280704779106023F&#39; ,]$height &lt;- 0.9 ## Day plot , Representive day mclim_TO04_CN01_2018 %&gt;% filter(month %in% c(9) &amp; day(time) %in% c(5:10) &amp; hr %in% c(10,11,12,13)) %&gt;% ggplot() + geom_line( aes(time,windspeed1,color = &#39;0.6&#39;)) + geom_line( aes(time,windspeed2,color = &#39;1.2&#39;)) + geom_line( aes(time,windspeed3,color = &#39;0.9&#39;)) + geom_line( aes(time,windspeed4,color = &#39;0.3&#39;)) + theme_minimal() + facet_grid(. ~ day, scales = &quot;free&quot;) + ggtitle(&quot;Variation in wind at TO04 - Open&quot;) + xlab(&quot;Date&quot;) + ylab(&quot;Windspeed (k/h)&quot;) + labs(colour = &quot;Height(m)&quot;, subtitle=&quot;9/14/2018&quot;,caption=&quot;Data Source : http://nanoclimate.org&quot;) AM16 mclim_AM16_CN01_2018 %&gt;% filter (!is.na(mclim_AM16_CN01_2018$minute) &amp; month %in% c(9) ) %&gt;% filter( day %in% c(7:13)) %&gt;% mutate(solrf = ((solar-39) * 1.8) + ((25 -temp1) * .0012)) %&gt;% group_by(day,hr,minute) %&gt;% summarise(solmin = mean(solrf)) %&gt;% group_by(day,b = gl(ceiling(n()/4), 4, n())) %&gt;% group_by(day,hr,b) %&gt;% summarize(meansol = mean(solmin), sd = sd(solmin)) %&gt;% mutate(height=&quot;1.2&quot;,newx= as.numeric(paste(hr,b,sep=&quot;&quot;))) %&gt;% #select(newx) %&gt;% distinct(newx) dplyr::group_by(day,height) %&gt;% mutate(index=1:n()) %&gt;% ggplot() + geom_line(aes(index,meansol))+ theme_minimal() + facet_grid(.~ day,scales = &quot;free&quot;) + scale_x_continuous(breaks = seq(0,119,by=1), limits = c(0,120),labels = labelfx) + scale_colour_manual(&quot;Solar radiatiion on day&quot;, breaks = c(&quot;10&quot;,&quot;11&quot;, &quot;12&quot;,&quot;13&quot;,&quot;14&quot;), values = brewer.pal(5, &quot;Set1&quot;)) + scale_linetype_manual(&quot;Height(m)&quot;,values=c(&quot;1.2&quot;=1)) + theme_classic() + ggtitle(&quot;Diel Variation in radiation at 1.2m at site AM16&quot;) + xlab(&quot;Hour&quot;) + ylab(&quot;Radiation (W/m^2)&quot;) + labs(colour = &quot;Hour&quot;, subtitle=&quot;9/9/18 - 9/12/19&quot;,caption=&quot;Data Source : http://www.nanoclimate.org&quot;) AG05 mclim_AG05_CN01_2018 %&gt;% filter (!is.na(mclim_AG05_CN01_2018$minute) &amp; month %in% c(9) ) %&gt;% filter( day %in% c(7:13)) %&gt;% mutate(solrf = ((solar-39) * 1.8) + ((25 -temp1) * .0012)) %&gt;% group_by(day,hr,minute) %&gt;% summarise(solmin = mean(solrf)) %&gt;% group_by(day,b = gl(ceiling(n()/4), 4, n())) %&gt;% group_by(day,hr,b) %&gt;% summarize(meansol = mean(solmin), sd = sd(solmin)) %&gt;% mutate(height=&quot;1.2&quot;,newx= as.numeric(paste(hr,b,sep=&quot;&quot;))) %&gt;% #select(newx) %&gt;% distinct(newx) dplyr::group_by(day,height) %&gt;% mutate(index=1:n()) %&gt;% ggplot() + geom_line(aes(index,meansol))+ theme_minimal() + facet_grid(.~ day,scales = &quot;free&quot;) + scale_x_continuous(breaks = seq(0,119,by=1), limits = c(0,120),labels = labelfx) + scale_colour_manual(&quot;Solar radiatiion on day&quot;, breaks = c(&quot;10&quot;,&quot;11&quot;, &quot;12&quot;,&quot;13&quot;,&quot;14&quot;), values = brewer.pal(5, &quot;Set1&quot;)) + scale_linetype_manual(&quot;Height(m)&quot;,values=c(&quot;1.2&quot;=1)) + theme_classic() + ggtitle(&quot;Diel Variation in radiation at 1.2m at site AG05&quot;) + xlab(&quot;Hour&quot;) + ylab(&quot;Radiation (W/m^2)&quot;) + labs(colour = &quot;Hour&quot;, subtitle=&quot;9/9/18 - 9/12/19&quot;,caption=&quot;Data Source : http://www.nanoclimate.org&quot;) mclim_TO04_CN01_2018 %&gt;% filter (!is.na(mclim_TO04_CN01_2018$minute) &amp; month %in% c(9) ) %&gt;% filter( day %in% c(7:13)) %&gt;% mutate(solrf = ((solar-39) * 1.8) + ((25 -temp1) * .0012)) %&gt;% group_by(day,hr,minute) %&gt;% summarise(solmin = mean(solrf)) %&gt;% group_by(day,b = gl(ceiling(n()/4), 4, n())) %&gt;% group_by(day,hr,b) %&gt;% summarize(meansol = mean(solmin), sd = sd(solmin)) %&gt;% mutate(height=&quot;1.2&quot;,newx= as.numeric(paste(hr,b,sep=&quot;&quot;))) %&gt;% #select(newx) %&gt;% distinct(newx) dplyr::group_by(day,height) %&gt;% mutate(index=1:n()) %&gt;% ggplot() + geom_line(aes(index,meansol))+ theme_minimal() + facet_grid(.~ day,scales = &quot;free&quot;) + scale_x_continuous(breaks = seq(0,119,by=1), limits = c(0,120),labels = labelfx) + scale_colour_manual(&quot;Solar radiatiion on day&quot;, breaks = c(&quot;10&quot;,&quot;11&quot;, &quot;12&quot;,&quot;13&quot;,&quot;14&quot;), values = brewer.pal(5, &quot;Set1&quot;)) + scale_linetype_manual(&quot;Height(m)&quot;,values=c(&quot;1.2&quot;=1)) + theme_classic() + ggtitle(&quot;Diel Variation in radiation at 1.2m at site TO04&quot;) + xlab(&quot;Hour&quot;) + ylab(&quot;Radiation (W/m^2)&quot;) + labs(colour = &quot;Hour&quot;, subtitle=&quot;9/9/18 - 9/12/19&quot;,caption=&quot;Data Source : http://www.nanoclimate.org&quot;) mclim_AE10_CN01_2018 %&gt;% filter (!is.na(mclim_AE10_CN01_2018$minute) &amp; month %in% c(9) ) %&gt;% filter( day %in% c(7:13)) %&gt;% mutate(solrf = ((solar-39) * 1.8) + ((25 -temp1) * .0012)) %&gt;% group_by(day,hr,minute) %&gt;% summarise(solmin = mean(solrf)) %&gt;% group_by(day,b = gl(ceiling(n()/4), 4, n())) %&gt;% group_by(day,hr,b) %&gt;% summarize(meansol = mean(solmin), sd = sd(solmin)) %&gt;% mutate(height=&quot;1.2&quot;,newx= as.numeric(paste(hr,b,sep=&quot;&quot;))) %&gt;% #select(newx) %&gt;% distinct(newx) dplyr::group_by(day,height) %&gt;% mutate(index=1:n()) %&gt;% ggplot() + geom_line(aes(index,meansol))+ theme_minimal() + facet_grid(.~ day,scales = &quot;free&quot;) + scale_x_continuous(breaks = seq(0,119,by=1), limits = c(0,120),labels = labelfx) + scale_colour_manual(&quot;Solar radiatiion on day&quot;, breaks = c(&quot;10&quot;,&quot;11&quot;, &quot;12&quot;,&quot;13&quot;,&quot;14&quot;), values = brewer.pal(5, &quot;Set1&quot;)) + scale_linetype_manual(&quot;Height(m)&quot;,values=c(&quot;1.2&quot;=1)) + theme_classic() + ggtitle(&quot;Diel Variation in radiation at 1.2m at site AE10&quot;) + xlab(&quot;Hour&quot;) + ylab(&quot;Radiation (W/m^2)&quot;) + labs(colour = &quot;Hour&quot;, subtitle=&quot;9/9/18 - 9/12/19&quot;,caption=&quot;Data Source : http://www.nanoclimate.org&quot;) 8.35 2-05-2019 Canopy reduces limits the amount of short-wave radiation ( Gay et al 1971, T R Oke BLC , P 125) mclim_AE10_CN01_2018_solar &lt;- mclim_AE10_CN01_2018 %&gt;% filter (!is.na(mclim_AE10_CN01_2018$minute) &amp; month %in% c(9) ) %&gt;% filter( day %in% c(7:13)) %&gt;% mutate(solrf = ((solar-39) * 1.8) + ((25 -temp1) * .0012)) %&gt;% group_by(day,hr,minute) %&gt;% summarise(solmin = mean(solrf)) %&gt;% group_by(day,b = gl(ceiling(n()/4), 4, n())) %&gt;% group_by(day,hr,b) %&gt;% summarize(meansol = mean(solmin), sd = sd(solmin)) %&gt;% mutate(height=&quot;1.2&quot;,newx= as.numeric(paste(hr,b,sep=&quot;&quot;))) %&gt;% #select(newx) %&gt;% distinct(newx) dplyr::group_by(day,height) %&gt;% mutate(index=1:n()) %&gt;% as.data.frame() mclim_AE10_CN01_2018_solar$site &lt;- &#39;AE10&#39; mclim_AM16_CN01_2018_solar &lt;- mclim_AM16_CN01_2018 %&gt;% filter (!is.na(mclim_AM16_CN01_2018$minute) &amp; month %in% c(9) ) %&gt;% filter( day %in% c(7:13)) %&gt;% mutate(solrf = ((solar-39) * 1.8) + ((25 -temp1) * .0012)) %&gt;% group_by(day,hr,minute) %&gt;% summarise(solmin = mean(solrf)) %&gt;% group_by(day,b = gl(ceiling(n()/4), 4, n())) %&gt;% group_by(day,hr,b) %&gt;% summarize(meansol = mean(solmin), sd = sd(solmin)) %&gt;% mutate(height=&quot;1.2&quot;,newx= as.numeric(paste(hr,b,sep=&quot;&quot;))) %&gt;% #select(newx) %&gt;% distinct(newx) dplyr::group_by(day,height) %&gt;% mutate(index=1:n()) %&gt;% as.data.frame() mclim_AM16_CN01_2018_solar$site &lt;- &#39;AM16&#39; mclim_AG05_CN01_2018_solar &lt;- mclim_AG05_CN01_2018 %&gt;% filter (!is.na(mclim_AG05_CN01_2018$minute) &amp; month %in% c(9) ) %&gt;% filter( day %in% c(7:13)) %&gt;% mutate(solrf = ((solar-39) * 1.8) + ((25 -temp1) * .0012)) %&gt;% group_by(day,hr,minute) %&gt;% summarise(solmin = mean(solrf)) %&gt;% group_by(day,b = gl(ceiling(n()/4), 4, n())) %&gt;% group_by(day,hr,b) %&gt;% summarize(meansol = mean(solmin), sd = sd(solmin)) %&gt;% mutate(height=&quot;1.2&quot;,newx= as.numeric(paste(hr,b,sep=&quot;&quot;))) %&gt;% #select(newx) %&gt;% distinct(newx) dplyr::group_by(day,height) %&gt;% mutate(index=1:n()) %&gt;% as.data.frame() mclim_AG05_CN01_2018_solar$site &lt;- &#39;AG05&#39; mclim_TO04_CN01_2018_solar &lt;- mclim_TO04_CN01_2018 %&gt;% filter (!is.na(mclim_TO04_CN01_2018$minute) &amp; month %in% c(9) ) %&gt;% filter( day %in% c(7:13)) %&gt;% mutate(solrf = ((solar-39) * 1.8) + ((25 -temp1) * .0012)) %&gt;% group_by(day,hr,minute) %&gt;% summarise(solmin = mean(solrf)) %&gt;% group_by(day,b = gl(ceiling(n()/4), 4, n())) %&gt;% group_by(day,hr,b) %&gt;% summarize(meansol = mean(solmin), sd = sd(solmin)) %&gt;% mutate(height=&quot;1.2&quot;,newx= as.numeric(paste(hr,b,sep=&quot;&quot;))) %&gt;% #select(newx) %&gt;% distinct(newx) dplyr::group_by(day,height) %&gt;% mutate(index=1:n()) %&gt;% as.data.frame() mclim_TO04_CN01_2018_solar$site &lt;- &#39;TO04&#39; mclim_CN01_2018_solar_df &lt;- rbind(mclim_AE10_CN01_2018_solar, mclim_AM16_CN01_2018_solar, mclim_AG05_CN01_2018_solar, mclim_TO04_CN01_2018_solar) mclim_CN01_2018_solar_df %&gt;% filter(day %in% c(7:15)) %&gt;% ggplot() + geom_line(aes(index,meansol,col=site))+ theme_minimal() + facet_grid(.~ day,scales = &quot;free&quot;) + scale_x_continuous(breaks = seq(0,119,by=1), limits = c(0,120),labels = labelfx) + scale_colour_manual(&quot;Solar radiatiion on day&quot;, values = brewer.pal(4, &quot;Set1&quot;), labels=c(&#39;AE10 - 1450&#39;,&#39;AM16 - 1200&#39;,&#39;AG05 - 950&#39;,&#39;TO04 - 650&#39;)) + scale_linetype_manual(&quot;Height(m)&quot;,values=c(&quot;1.2&quot;=1)) + theme_classic() + ggtitle(&quot;Diel Variation in radiation at 1.2m at 4 MM sites&quot;) + xlab(&quot;Hour&quot;) + ylab(&quot;Radiation (W/m^2)&quot;) + labs(colour = &quot;Hour&quot;, subtitle=&quot;9/8/18 - 9/9/18&quot;,caption=&quot;Data Source : http://www.nanoclimate.org&quot;) Compare with Paradise Try to plot with Paradise Paradise_5to15_solar_df &lt;- Paradise_5to15_solar %&gt;% filter (month %in% c(9) ) %&gt;% filter( day %in% c(7:13)) %&gt;% mutate(meansol=m1,b=0,sd=0,newx=0,height=&quot;1.2&quot;) %&gt;% dplyr::select(day,hr,sd,site,meansol,b,height,newx) %&gt;% dplyr::group_by(day) %&gt;% mutate(index= seq(1,120,by = 5)) %&gt;% dplyr::select(day,hr,b,meansol,sd,height,newx,index,site) %&gt;% as.data.frame() Paradise_5to15_solar_df_5pct &lt;- Paradise_5to15_solar %&gt;% filter (month %in% c(9) ) %&gt;% filter( day %in% c(7:13)) %&gt;% mutate(meansol=m1*0.05,b=0,sd=0,newx=0,height=&quot;1.2&quot;) %&gt;% dplyr::select(day,hr,sd,site,meansol,b,height,newx) %&gt;% dplyr::group_by(day) %&gt;% mutate(index= seq(1,120,by = 5)) %&gt;% dplyr::select(day,hr,b,meansol,sd,height,newx,index,site) %&gt;% as.data.frame() Paradise_5to15_solar_df_5pct$site &lt;- &#39;Paradise_1645_5%&#39; Paradise_5to15_solar_df_20pct &lt;- Paradise_5to15_solar %&gt;% filter (month %in% c(9) ) %&gt;% filter( day %in% c(7:13)) %&gt;% mutate(meansol=m1*0.2,b=0,sd=0,newx=0,height=&quot;1.2&quot;) %&gt;% dplyr::select(day,hr,sd,site,meansol,b,height,newx) %&gt;% dplyr::group_by(day) %&gt;% mutate(index= seq(1,120,by = 5)) %&gt;% dplyr::select(day,hr,b,meansol,sd,height,newx,index,site) %&gt;% as.data.frame() Paradise_5to15_solar_df_20pct$site &lt;- &#39;Paradise_1645_20%&#39; mclim_CN01_2018_solar_df_compare &lt;- rbind(mclim_AE10_CN01_2018_solar, mclim_AM16_CN01_2018_solar, mclim_AG05_CN01_2018_solar, mclim_TO04_CN01_2018_solar, Paradise_5to15_solar_df, Paradise_5to15_solar_df_5pct, Paradise_5to15_solar_df_20pct) mclim_CN01_2018_solar_df_compare %&gt;% filter(day %in% c(5:15)) %&gt;% ggplot() + geom_line(aes(index,meansol,col=site))+ theme_minimal() + facet_grid(.~ day,scales = &quot;free&quot;) + scale_x_continuous(breaks = seq(0,119,by=1), limits = c(0,120),labels = labelfx) + # scale_colour_manual(&quot;Solar radiatiion on day&quot;, values = brewer.pal(7, &quot;Set1&quot;), # labels=c(&#39;AE10 - 1450&#39;,&#39;AM16 - 1200&#39;,&#39;AG05 - 950&#39;,&#39;TO04 - 650&#39;,&#39;Paradise - 1645&#39;,&#39;Paradise - 1645_5%&#39;,&#39;Paradise - 1645_20%&#39;)) + scale_linetype_manual(&quot;Height(m)&quot;,values=c(&quot;1.2&quot;=1)) + theme_classic() + ggtitle(&quot;Diel Variation in radiation at 1.2m at 4 MM and Paradise sites&quot;) + xlab(&quot;Hour&quot;) + ylab(&quot;Radiation (W/m^2)&quot;) + labs(colour = &quot;Hour&quot;, subtitle=&quot;9/8/18 - 9/9/18&quot;,caption=&quot;Data Source : http://www.nanoclimate.org&quot;) 8.36 2-23-2019 Looking at the variation by height at each individual heights, expect it to be variable closer to ground. More turbulent AM16 - TN01 ggplot(mclim_AM16_TN01_2018, aes(as.factor(height), temp))+ stat_boxplot( aes(as.factor(height), temp), geom=&#39;errorbar&#39;, linetype=1, width=0.5)+ #whiskers geom_boxplot( aes(as.factor(height), temp),outlier.shape=1) + stat_summary(fun.y=mean, geom=&quot;point&quot;, size=2) + stat_summary(fun.data = mean_se, geom = &quot;errorbar&quot;) + theme_minimal() + ylab(&quot;Temperature&quot;) + xlab(&quot;Height&quot;) +ggtitle(&quot;AM16-Narada TN01&quot;) TN02 ggplot(mclim_AM16_TN02_2018, aes(as.factor(height), temp))+ stat_boxplot( aes(as.factor(height), temp), geom=&#39;errorbar&#39;, linetype=1, width=0.5)+ #whiskers geom_boxplot( aes(as.factor(height), temp),outlier.shape=1) + stat_summary(fun.y=mean, geom=&quot;point&quot;, size=2) + stat_summary(fun.data = mean_se, geom = &quot;errorbar&quot;) + theme_minimal() + ylab(&quot;Temperature&quot;) + xlab(&quot;Height&quot;) +ggtitle(&quot;AM16-Narada TN02&quot;) TN03 mclim_AM16_TN03_2018 %&gt;% filter(height &gt; 0) %&gt;% ggplot( aes(as.factor(height), temp))+ stat_boxplot( aes(as.factor(height), temp), geom=&#39;errorbar&#39;, linetype=1, width=0.5)+ #whiskers geom_boxplot( aes(as.factor(height), temp),outlier.shape=1) + stat_summary(fun.y=mean, geom=&quot;point&quot;, size=2) + stat_summary(fun.data = mean_se, geom = &quot;errorbar&quot;) + theme_minimal() + ylab(&quot;Temperature&quot;) + xlab(&quot;Height&quot;) +ggtitle(&quot;AM16-Narada TN03&quot;) AM16 CN01 mclim_AM16_CN01_2018 %&gt;% dplyr::select(time, temp1,temp2,temp3,temp4) %&gt;% dplyr::filter(temp1 &gt;0 &amp; temp2 &gt;0 &amp; temp3 &gt;0 &amp; temp4 &gt; 0 ) %&gt;% dplyr::filter(temp1 &lt;50 &amp; temp2 &lt;50 &amp; temp3 &lt;50 &amp; temp4 &lt; 50 ) %&gt;% gather(variable, value,-time) %&gt;% ggplot( aes(as.factor(variable), value))+ stat_boxplot( aes(as.factor(variable), value), geom=&#39;errorbar&#39;, linetype=1, width=0.5)+ #whiskers geom_boxplot( aes(as.factor(variable), value),outlier.shape=1) + stat_summary(fun.y=mean, geom=&quot;point&quot;, size=2) + stat_summary(fun.data = mean_se, geom = &quot;errorbar&quot;) + theme_minimal() + ylab(&quot;Temperature&quot;) + xlab(&quot;Height&quot;) +ggtitle(&quot;AM16-Narada CN01&quot;) Do Z-Temp profile for AM16 mclim_AM16_TN01_2018_ZT &lt;- mclim_AM16_TN01_2018 mclim_AM16_TN01_2018_ZT$site &lt;- &#39;AM16_TN01&#39; mclim_AM16_TN01_2018_ZT$canopy &lt;- &#39;Closed&#39; mclim_AM16_TN02_2018_ZT &lt;- mclim_AM16_TN02_2018 mclim_AM16_TN02_2018_ZT$site &lt;- &#39;AM16_TN02&#39; mclim_AM16_TN02_2018_ZT$canopy &lt;- &#39;Closed&#39; mclim_AM16_TN03_2018_ZT &lt;- mclim_AM16_TN03_2018 mclim_AM16_TN03_2018_ZT$site &lt;- &#39;AM16_TN03&#39; mclim_AM16_TN03_2018_ZT$canopy &lt;- &#39;Open&#39; mclim_AM16_2018_ZTemp&lt;- rbind(mclim_AM16_TN01_2018_ZT, mclim_AM16_TN02_2018_ZT, mclim_AM16_TN03_2018_ZT ) mclim_AM16_2018_ZTemp %&gt;% dplyr::filter(height &gt; 0 &amp; day &gt;5) %&gt;% dplyr::group_by (site,height ) %&gt;% dplyr::summarise(meant=mean(temp))%&gt;% ggplot( )+ geom_point(aes(meant,height,color=site)) + geom_line(aes(meant,height,color=site)) + #geom_smooth(span = .4,aes(meant,height,color=site)) + theme_minimal() + ylab(&quot;height(m)&quot;) + xlab(&quot;Temperature(°C)&quot;) +ggtitle(&quot;Height-Temp profile (AM16)&quot;) Do Z-Temp profile for AE10 mclim_AE10_TN01_2018_ZT &lt;- mclim_AE10_TN01_2018 mclim_AE10_TN01_2018_ZT$site &lt;- &#39;AE10_TN01&#39; mclim_AE10_TN01_2018_ZT$canopy &lt;- &#39;Open&#39; mclim_AE10_TN02_2018_ZT &lt;- mclim_AE10_TN02_2018 mclim_AE10_TN02_2018_ZT$site &lt;- &#39;AE10_TN02&#39; mclim_AE10_TN02_2018_ZT$canopy &lt;- &#39;Closed&#39; mclim_AE10_TN03_2018_ZT &lt;- mclim_AE10_TN03_2018 mclim_AE10_TN03_2018_ZT$site &lt;- &#39;AE10_TN03&#39; mclim_AE10_TN03_2018_ZT$canopy &lt;- &#39;Closed&#39; mclim_AE10_2018_ZTemp&lt;- rbind(mclim_AE10_TN01_2018_ZT, mclim_AE10_TN02_2018_ZT, mclim_AE10_TN03_2018_ZT ) mclim_AE10_2018_ZTemp %&gt;% dplyr::filter(height &gt; 0 &amp; temp &gt;0 &amp; day &gt;5) %&gt;% dplyr::group_by (site,height ) %&gt;% dplyr::summarise(meant=mean(temp))%&gt;% ggplot( )+ geom_point(aes(meant,height,color=site)) + geom_line(aes(meant,height,color=site)) + theme_minimal() + ylab(&quot;height(m)&quot;) + xlab(&quot;Temperature(°C)&quot;) +ggtitle(&quot;Height-Temp profile (AE10)&quot;) AG05 mclim_AG05_TN01_2018_ZT &lt;- mclim_AG05_TN01_2018 mclim_AG05_TN01_2018_ZT$site &lt;- &#39;AG05_TN01&#39; mclim_AG05_TN01_2018_ZT$canopy &lt;- &#39;Closed&#39; mclim_AG05_TN02_2018_ZT &lt;- mclim_AG05_TN02_2018 mclim_AG05_TN02_2018_ZT$site &lt;- &#39;AG05_TN02&#39; mclim_AG05_TN02_2018_ZT$canopy &lt;- &#39;Closed&#39; mclim_AG05_TN03_2018_ZT &lt;- mclim_AG05_TN03_2018 mclim_AG05_TN03_2018_ZT$site &lt;- &#39;AG05_TN03&#39; mclim_AG05_TN03_2018_ZT$canopy &lt;- &#39;Open&#39; mclim_AG05_2018_ZTemp&lt;- rbind(mclim_AG05_TN01_2018_ZT, mclim_AG05_TN02_2018_ZT, mclim_AG05_TN03_2018_ZT ) mclim_AG05_2018_ZTemp %&gt;% dplyr::filter(height &gt; 0 &amp; temp &gt;0 &amp; day &gt;5) %&gt;% dplyr::group_by (site,height ) %&gt;% dplyr::summarise(meant=mean(temp))%&gt;% ggplot( )+ geom_point(aes(meant,height,color=site)) + geom_line(aes(meant,height,color=site)) + theme_minimal() + ylab(&quot;height(m)&quot;) + xlab(&quot;Temperature(°C)&quot;) +ggtitle(&quot;Height-Temp profile (AG05)&quot;) TO04 mclim_TO04_TN01_2018_ZT &lt;- mclim_TO04_TN01_2018 mclim_TO04_TN01_2018_ZT$site &lt;- &#39;TO04_TN01&#39; mclim_TO04_TN01_2018_ZT$canopy &lt;- &#39;Closed&#39; mclim_TO04_TN02_2018_ZT &lt;- mclim_TO04_TN02_2018 mclim_TO04_TN02_2018_ZT$site &lt;- &#39;TO04_TN02&#39; mclim_TO04_TN02_2018_ZT$canopy &lt;- &#39;Open&#39; mclim_TO04_TN03_2018_ZT &lt;- mclim_TO04_TN03_2018 mclim_TO04_TN03_2018_ZT$site &lt;- &#39;TO04_TN03&#39; mclim_TO04_TN03_2018_ZT$canopy &lt;- &#39;Closed&#39; mclim_TO04_2018_ZTemp&lt;- rbind(mclim_TO04_TN01_2018_ZT, mclim_TO04_TN02_2018_ZT, mclim_TO04_TN03_2018_ZT ) mclim_TO04_2018_ZTemp %&gt;% dplyr::filter(height &gt; 0 &amp; temp &gt;0 &amp; day &gt;5) %&gt;% dplyr::group_by (site,height ) %&gt;% dplyr::summarise(meant=mean(temp))%&gt;% ggplot( )+ geom_point(aes(meant,height,color=site)) + geom_line(aes(meant,height,color=site)) + theme_minimal() + ylab(&quot;height(m)&quot;) + xlab(&quot;Temperature(°C)&quot;) +ggtitle(&quot;Height-Temp profile (TO04)&quot;) Gap and non gap ` TO04 mclim_TO04_2018_ZTemp %&gt;% dplyr::filter(height &gt; 0 &amp; temp &gt;0 &amp; day &gt;5) %&gt;% ggplot( aes(as.factor(canopy), temp))+ stat_boxplot( aes(as.factor(canopy), temp), geom=&#39;errorbar&#39;, linetype=1, width=0.5)+ #whiskers geom_boxplot( aes(as.factor(canopy), temp),outlier.shape=1) + stat_summary(fun.y=mean, geom=&quot;point&quot;, size=2,color=&quot;red&quot;) + stat_summary(fun.data = mean_se, geom = &quot;errorbar&quot;) + theme_minimal() + ylab(&quot;Temperature(°C)&quot;) + xlab(&quot;Canopy&quot;) +ggtitle(&quot;Gap-NonGap profile (TO04)&quot;) AG05 mclim_AG05_2018_ZTemp %&gt;% dplyr::filter(height &gt; 0 &amp; temp &gt;0 &amp; day &gt;5) %&gt;% ggplot( aes(as.factor(canopy), temp))+ stat_boxplot( aes(as.factor(canopy), temp), geom=&#39;errorbar&#39;, linetype=1, width=0.5)+ #whiskers geom_boxplot( aes(as.factor(canopy), temp),outlier.shape=1) + stat_summary(fun.y=mean, geom=&quot;point&quot;, size=2,color=&quot;red&quot;) + stat_summary(fun.data = mean_se, geom = &quot;errorbar&quot;) + theme_minimal() + ylab(&quot;Temperature(°C)&quot;) + xlab(&quot;Canopy&quot;) +ggtitle(&quot;Gap-NonGap profile (AG05)&quot;) AM16 mclim_AM16_2018_ZTemp %&gt;% dplyr::filter(height &gt; 0 &amp; temp &gt;0 &amp; day &gt;5) %&gt;% ggplot( aes(as.factor(canopy), temp))+ stat_boxplot( aes(as.factor(canopy), temp), geom=&#39;errorbar&#39;, linetype=1, width=0.5)+ #whiskers geom_boxplot( aes(as.factor(canopy), temp),outlier.shape=1) + stat_summary(fun.y=mean, geom=&quot;point&quot;, size=2,color=&quot;red&quot;) + stat_summary(fun.data = mean_se, geom = &quot;errorbar&quot;) + theme_minimal() + ylab(&quot;Temperature(°C)&quot;) + xlab(&quot;Canopy&quot;) +ggtitle(&quot;Gap-NonGap profile (AM16)&quot;) AE10 mclim_AE10_2018_ZTemp %&gt;% dplyr::filter(height &gt; 0 &amp; temp &gt;0 &amp; day &gt;5) %&gt;% ggplot( aes(as.factor(canopy), temp))+ stat_boxplot( aes(as.factor(canopy), temp), geom=&#39;errorbar&#39;, linetype=1, width=0.5)+ #whiskers geom_boxplot( aes(as.factor(canopy), temp),outlier.shape=1) + stat_summary(fun.y=mean, geom=&quot;point&quot;, size=2,color=&quot;red&quot;) + stat_summary(fun.data = mean_se, geom = &quot;errorbar&quot;) + theme_minimal() + ylab(&quot;Temperature(°C)&quot;) + xlab(&quot;Canopy&quot;) +ggtitle(&quot;Gap-NonGap profile (AE10)&quot;) Onto Radiation (redo), use AE10-CN01 mclim_AE10_CN01_2018 %&gt;% filter (!is.na(mclim_AE10_CN01_2018$minute) &amp; month %in% c(9) ) %&gt;% filter( day &gt; 9 &amp; day &lt; 15) %&gt;% mutate(solrf = ((solar-39) * 1.8) + ((25 -temp1) * .0012)) %&gt;% group_by(month,day,hr) %&gt;% add_count(wt=3) %&gt;% summarise(m1= mean(solrf)) %&gt;% group_by(day,hr) %&gt;% ggplot() + geom_line(aes(hr,m1,group=day ,color=as.factor(day),linetype = &#39;1.2&#39;),se=F)+ scale_colour_manual(&quot;Solar radiatiion on day&quot;, breaks = c(&quot;10&quot;,&quot;11&quot;, &quot;12&quot;,&quot;13&quot;,&quot;14&quot;), values = brewer.pal(5, &quot;Set1&quot;)) + scale_linetype_manual(&quot;Height(m)&quot;,values=c(&quot;1.2&quot;=1)) + theme_classic() + ggtitle(&quot;Diel Variation in radiation at 1.2m at site AE10 (1450m)&quot;) + xlab(&quot;Hour&quot;) + ylab(&quot;Radiation (W/m^2)&quot;) + labs(colour = &quot;Hour&quot;, subtitle=&quot;9/10/18 - 9/14/19&quot;,caption=&quot;Data Source : http://www.nanoclimate.org&quot;) AM16 mclim_AM16_CN01_2018 %&gt;% filter (!is.na(mclim_AM16_CN01_2018$minute) &amp; month %in% c(9) ) %&gt;% filter( day &gt; 9 &amp; day &lt; 15) %&gt;% mutate(solrf = ((solar-39) * 1.8) + ((25 -temp1) * .0012)) %&gt;% group_by(month,day,hr) %&gt;% add_count(wt=3) %&gt;% summarise(m1= mean(solrf)) %&gt;% group_by(day,hr) %&gt;% ggplot() + geom_line(aes(hr,m1,group=day ,color=as.factor(day),linetype = &#39;1.2&#39;),se=F)+ scale_colour_manual(&quot;Solar radiatiion on day&quot;, breaks = c(&quot;10&quot;,&quot;11&quot;, &quot;12&quot;,&quot;13&quot;,&quot;14&quot;), values = brewer.pal(5, &quot;Set1&quot;)) + scale_linetype_manual(&quot;Height(m)&quot;,values=c(&quot;1.2&quot;=1)) + theme_classic() + ggtitle(&quot;Diel Variation in radiation at 1.2m at site AM16 (1200m)&quot;) + xlab(&quot;Hour&quot;) + ylab(&quot;Radiation (W/m^2)&quot;) + labs(colour = &quot;Hour&quot;, subtitle=&quot;9/10/18 - 9/14/19&quot;,caption=&quot;Data Source : http://www.nanoclimate.org&quot;) AG05 - Missed data mclim_AG05_CN01_2018 %&gt;% filter (!is.na(mclim_AG05_CN01_2018$minute) &amp; month %in% c(9) ) %&gt;% filter( day &gt; 9 &amp; day &lt; 15) %&gt;% mutate(solrf = ((solar-39) * 1.8) + ((25 -temp1) * .0012)) %&gt;% group_by(month,day,hr) %&gt;% add_count(wt=3) %&gt;% summarise(m1= mean(solrf)) %&gt;% group_by(day,hr) %&gt;% ggplot() + geom_line(aes(hr,m1,group=day ,color=as.factor(day),linetype = &#39;1.2&#39;),se=F)+ scale_colour_manual(&quot;Solar radiatiion on day&quot;, breaks = c(&quot;10&quot;,&quot;11&quot;, &quot;12&quot;,&quot;13&quot;,&quot;14&quot;), values = brewer.pal(5, &quot;Set1&quot;)) + scale_linetype_manual(&quot;Height(m)&quot;,values=c(&quot;1.2&quot;=1)) + theme_classic() + ggtitle(&quot;Diel Variation in radiation at 1.2m at site AG05 (950m)&quot;) + xlab(&quot;Hour&quot;) + ylab(&quot;Radiation (W/m^2)&quot;) + labs(colour = &quot;Hour&quot;, subtitle=&quot;9/10/18 - 9/14/19&quot;,caption=&quot;Data Source : http://www.nanoclimate.org&quot;) TO04 mclim_TO04_CN01_2018 %&gt;% filter (!is.na(mclim_TO04_CN01_2018$minute) &amp; month %in% c(9) ) %&gt;% filter( day &gt; 9 &amp; day &lt; 15) %&gt;% mutate(solrf = ((solar-39) * 1.8) + ((25 -temp1) * .0012)) %&gt;% group_by(month,day,hr) %&gt;% add_count(wt=3) %&gt;% summarise(m1= mean(solrf)) %&gt;% group_by(day,hr) %&gt;% ggplot() + geom_line(aes(hr,m1,group=day ,color=as.factor(day),linetype = &#39;1.2&#39;),se=F)+ scale_colour_manual(&quot;Solar radiatiion on day&quot;, breaks = c(&quot;10&quot;,&quot;11&quot;, &quot;12&quot;,&quot;13&quot;,&quot;14&quot;), values = brewer.pal(5, &quot;Set1&quot;)) + scale_linetype_manual(&quot;Height(m)&quot;,values=c(&quot;1.2&quot;=1)) + theme_classic() + ggtitle(&quot;Diel Variation in radiation at 1.2m at site TO04 (650m)&quot;) + xlab(&quot;Hour&quot;) + ylab(&quot;Radiation (W/m^2)&quot;) + labs(colour = &quot;Hour&quot;, subtitle=&quot;9/10/18 - 9/14/19&quot;,caption=&quot;Data Source : http://www.nanoclimate.org&quot;) Box plot of all the stations Does all the sites read the same solar radiation load ? Not really, mclim_TO04_CN01_2018_wrk &lt;- mclim_TO04_CN01_2018 mclim_TO04_CN01_2018_wrk$site &lt;- &#39;TO04&#39; mclim_AM16_CN01_2018_wrk &lt;- mclim_AM16_CN01_2018 mclim_AM16_CN01_2018_wrk$site &lt;- &#39;AM16&#39; mclim_AE10_CN01_2018_wrk &lt;- mclim_AE10_CN01_2018 %&gt;% dplyr::select (-c(segment)) mclim_AE10_CN01_2018_wrk$site &lt;- &#39;AE10&#39; mclim_AG05_CN01_2018_wrk &lt;- mclim_AG05_CN01_2018 mclim_AG05_CN01_2018_wrk$site &lt;- &#39;AG05&#39; mclim_CN01_2018_wrk&lt;- rbind(mclim_TO04_CN01_2018_wrk, mclim_AM16_CN01_2018_wrk, mclim_AE10_CN01_2018_wrk, mclim_AG05_CN01_2018_wrk ) mclim_CN01_2018_wrk %&gt;% dplyr::filter(solar &lt; 750) %&gt;% filter (month %in% c(9) ) %&gt;% filter( day &gt; 9 &amp; day &lt; 15) %&gt;% ggplot( aes(as.factor(site), solar))+ stat_boxplot( aes(as.factor(site), solar), geom=&#39;errorbar&#39;, linetype=1, width=0.5)+ #whiskers geom_boxplot( aes(as.factor(site), solar),outlier.shape=1) + stat_summary(fun.y=mean, geom=&quot;point&quot;, size=2) + stat_summary(fun.data = mean_se, geom = &quot;errorbar&quot;) + theme_minimal() + ylab(&quot;Watts/m^2&quot;) + xlab(&quot;Site&quot;) +ggtitle(&quot;Solar radiation all sites (9/9 to 9/15&quot;) For the entire duration mclim_CN01_2018_wrk %&gt;% dplyr::filter(solar &lt; 750) %&gt;% ggplot( aes(as.factor(site), solar))+ stat_boxplot( aes(as.factor(site), solar), geom=&#39;errorbar&#39;, linetype=1, width=0.5)+ #whiskers geom_boxplot( aes(as.factor(site), solar),outlier.shape=1) + stat_summary(fun.y=mean, geom=&quot;point&quot;, size=2) + stat_summary(fun.data = mean_se, geom = &quot;errorbar&quot;) + theme_minimal() + ylab(&quot;Watts/m^2&quot;) + xlab(&quot;Site&quot;) +ggtitle(&quot;Solar radiation all sites (9/9 to 9/15&quot;) wind mclim_CN01_2018_wrk %&gt;% dplyr::filter(solar &lt; 750) %&gt;% filter (month %in% c(9) ) %&gt;% filter( day &gt; 9 &amp; day &lt; 15) %&gt;% ggplot( aes(as.factor(site), windspeed4))+ stat_boxplot( aes(as.factor(site), windspeed4), geom=&#39;errorbar&#39;, linetype=1, width=0.5)+ #whiskers geom_boxplot( aes(as.factor(site), windspeed4),outlier.shape=1) + stat_summary(fun.y=mean, geom=&quot;point&quot;, size=2) + stat_summary(fun.data = mean_se, geom = &quot;errorbar&quot;) + theme_minimal() + ylab(&quot;km/h&quot;) + xlab(&quot;Site&quot;) +ggtitle(&quot;Wind all sites (9/9 to 9/15) - 0.3&quot;) mclim_CN01_2018_wrk %&gt;% dplyr::filter(solar &lt; 750) %&gt;% filter (month %in% c(9) ) %&gt;% filter( day &gt; 9 &amp; day &lt; 15) %&gt;% ggplot( aes(as.factor(site), windspeed1))+ stat_boxplot( aes(as.factor(site), windspeed1), geom=&#39;errorbar&#39;, linetype=1, width=0.5)+ #whiskers geom_boxplot( aes(as.factor(site), windspeed1),outlier.shape=1) + stat_summary(fun.y=mean, geom=&quot;point&quot;, size=2) + stat_summary(fun.data = mean_se, geom = &quot;errorbar&quot;) + theme_minimal() + ylab(&quot;km/h&quot;) + xlab(&quot;Site&quot;) +ggtitle(&quot;Wind all sites (9/9 to 9/15) - 1.2&quot;) mclim_CN01_2018_wrk %&gt;% dplyr::filter(solar &lt; 750) %&gt;% filter (month %in% c(9) ) %&gt;% filter( day &gt; 9 &amp; day &lt; 15) %&gt;% ggplot( aes(as.factor(site), windspeed2))+ stat_boxplot( aes(as.factor(site), windspeed2), geom=&#39;errorbar&#39;, linetype=1, width=0.5)+ #whiskers geom_boxplot( aes(as.factor(site), windspeed2),outlier.shape=1) + stat_summary(fun.y=mean, geom=&quot;point&quot;, size=2) + stat_summary(fun.data = mean_se, geom = &quot;errorbar&quot;) + theme_minimal() + ylab(&quot;km/h&quot;) + xlab(&quot;Site&quot;) +ggtitle(&quot;Wind all sites (9/9 to 9/15) - 0.9&quot;) mclim_CN01_2018_wrk %&gt;% dplyr::filter(solar &lt; 750) %&gt;% filter (month %in% c(9) ) %&gt;% filter( day &gt; 9 &amp; day &lt; 15) %&gt;% ggplot( aes(as.factor(site), windspeed3))+ stat_boxplot( aes(as.factor(site), windspeed3), geom=&#39;errorbar&#39;, linetype=1, width=0.5)+ #whiskers geom_boxplot( aes(as.factor(site), windspeed3),outlier.shape=1) + stat_summary(fun.y=mean, geom=&quot;point&quot;, size=2) + stat_summary(fun.data = mean_se, geom = &quot;errorbar&quot;) + theme_minimal() + ylab(&quot;km/h&quot;) + xlab(&quot;Site&quot;) +ggtitle(&quot;Wind all sites (9/9 to 9/15) - 0.6&quot;) Temperature Day time inversion ? mclim_CN01_2018_wrk %&gt;% dplyr::filter(temp2 &gt;0 ) %&gt;% filter (month %in% c(9) ) %&gt;% filter( day &gt; 9 &amp; day &lt; 15) %&gt;% filter(hr %in% c(8:15)) %&gt;% ggplot( aes(as.factor(site), temp2))+ stat_boxplot( aes(as.factor(site), temp2), geom=&#39;errorbar&#39;, linetype=1, width=0.5)+ #whiskers geom_boxplot( aes(as.factor(site), temp2),outlier.shape=1) + stat_summary(fun.y=mean, geom=&quot;point&quot;, size=2) + stat_summary(fun.data = mean_se, geom = &quot;errorbar&quot;) + theme_minimal() + ylab(&quot;Temperature(°C) &quot;) + xlab(&quot;Site&quot;) +ggtitle(&quot;Temp(2) at all sites (9/10 to 9/14) - 0.6&quot;) mclim_CN01_2018_wrk %&gt;% dplyr::filter(temp4 &gt;0 ) %&gt;% filter (month %in% c(9) ) %&gt;% filter( day &gt; 9 &amp; day &lt; 15) %&gt;% filter(hr %in% c(8:15)) %&gt;% ggplot( aes(as.factor(site), temp4))+ stat_boxplot( aes(as.factor(site), temp4), geom=&#39;errorbar&#39;, linetype=1, width=0.5)+ #whiskers geom_boxplot( aes(as.factor(site), temp4),outlier.shape=1) + stat_summary(fun.y=mean, geom=&quot;point&quot;, size=2) + stat_summary(fun.data = mean_se, geom = &quot;errorbar&quot;) + theme_minimal() + ylab(&quot;Temperature(°C) &quot;) + xlab(&quot;Site&quot;) +ggtitle(&quot;Temp(4) at all sites (9/10 to 9/14) - 0.6&quot;) Checking stability Way 1 combined_across_MM_and_PP_Long %&gt;% dplyr::filter(day %in% c(7:10)) %&gt;% dplyr::group_by(site,day) %&gt;% dplyr::summarise(dv=max(m1,na.rm = TRUE)- min(m1,na.rm = TRUE),no=n()) %&gt;% ggplot(aes(factor(site), dv, fill = factor(day))) + geom_bar(stat = &quot;identity&quot;, position = &quot;dodge&quot;) + geom_text(aes(label = round(no, 1)), position = position_dodge(0.9), vjust = 1.5, color = &quot;white&quot;) + theme_classic() + theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = .5)) + labs(x=&quot;Site&quot;, y=&quot;Temperature(°C) &quot;,subtitle=&quot;Thermal stability &quot;, caption=&quot;Data Source : nanoclimate.org&quot;) + ggtitle(&quot;Diel variation - 9/7 to 9/10&quot;) Way 2 combined_across_MM_and_PP_Long %&gt;% dplyr::filter(day %in% c(7:10)) %&gt;% dplyr::group_by(site,day) %&gt;% dplyr::summarise(dv=max(m1,na.rm = TRUE)- min(m1,na.rm = TRUE),no=n()) %&gt;% ggplot(aes(day, dv)) + geom_line() + facet_grid(.~ site,scales = &quot;free&quot;) + theme_classic() + theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = .5)) + labs(x=&quot;Day&quot;, y=&quot;Temperature(°C) &quot;,subtitle=&quot;Thermal stability &quot;, caption=&quot;Data Source : nanoclimate.org&quot;) + ggtitle(&quot;Diel variation - 9/7 to 9/10&quot;) Way 3 (chosen) combined_across_MM_and_PP_Long %&gt;% dplyr::filter(day %in% c(7:10)) %&gt;% dplyr::group_by(site,day) %&gt;% dplyr::summarise(dv=max(m1,na.rm = TRUE)- min(m1,na.rm = TRUE),no=n()) %&gt;% ggplot(aes(day, dv,color=site)) + geom_line() + theme_classic() + theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = .5)) + labs(x=&quot;Day&quot;, y=&quot;Temperature(°C) &quot;,subtitle=&quot;Thermal stability &quot;, caption=&quot;Data Source : nanoclimate.org&quot;) + ggtitle(&quot;Diel variation - 9/7 to 9/10&quot;) Differnt dates combined_across_MM_and_PP_Long %&gt;% dplyr::filter(day %in% c(15:20)) %&gt;% dplyr::group_by(site,day) %&gt;% dplyr::summarise(dv=max(m1,na.rm = TRUE)- min(m1,na.rm = TRUE),no=n()) %&gt;% ggplot(aes(day, dv,color=site)) + geom_line() + theme_classic() + theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = .5)) + labs(x=&quot;Day&quot;, y=&quot;Temperature(°C) &quot;,subtitle=&quot;Thermal stability &quot;, caption=&quot;Data Source : nanoclimate.org&quot;) + ggtitle(&quot;Diel variation - 9/15 to 9/20&quot;) combined_across_MM_and_PP_Long %&gt;% dplyr::filter(day %in% c(7:10)) %&gt;% dplyr::group_by(site,day) %&gt;% dplyr::summarise(dv=max(m1,na.rm = TRUE)- min(m1,na.rm = TRUE),no=n()) %&gt;% dplyr::group_by(site) %&gt;% dplyr::summarise(dvt = mean(dv)) %&gt;% ggplot(aes(factor(site), dvt)) + geom_bar(stat = &quot;identity&quot;, position = &quot;dodge&quot;) + theme_classic() + theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = .5)) + labs(x=&quot;Site&quot;, y=&quot;Temperature(°C) &quot;,subtitle=&quot;Thermal stability &quot;, caption=&quot;Data Source : nanoclimate.org&quot;) + ggtitle(&quot;Diel variation - 9/7 to 9/10&quot;) combined_across_MM_and_PP_Long %&gt;% dplyr::filter(day %in% c(7:10)) %&gt;% dplyr::group_by(site,day) %&gt;% dplyr::summarise(dv=max(m1,na.rm = TRUE)- min(m1,na.rm = TRUE),no=n()) %&gt;% ggplot( aes(as.factor(site), dv))+ stat_boxplot( aes(as.factor(site), dv), geom=&#39;errorbar&#39;, linetype=1, width=0.5)+ #whiskers geom_boxplot( aes(as.factor(site), dv),outlier.shape=1) + stat_summary(fun.y=mean, geom=&quot;point&quot;, size=2,color=&quot;red&quot;) + stat_summary(fun.data = mean_se, geom = &quot;errorbar&quot;) + theme_minimal() + ylab(&quot;Temperature(°C) &quot;) + xlab(&quot;Site&quot;) +ggtitle(&quot;DV at all sites (9/7 to 9/10) - 0.6&quot;) combined_across_MM_and_PP_Long %&gt;% dplyr::filter(day %in% c(15:20)) %&gt;% dplyr::group_by(site,day) %&gt;% dplyr::summarise(dv=max(m1,na.rm = TRUE)- min(m1,na.rm = TRUE),no=n()) %&gt;% ggplot( aes(as.factor(site), dv))+ stat_boxplot( aes(as.factor(site), dv), geom=&#39;errorbar&#39;, linetype=1, width=0.5)+ #whiskers geom_boxplot( aes(as.factor(site), dv),outlier.shape=1) + stat_summary(fun.y=mean, geom=&quot;point&quot;, size=2,color=&quot;red&quot;) + stat_summary(fun.data = mean_se, geom = &quot;errorbar&quot;) + theme_minimal() + ylab(&quot;Temperature(°C) &quot;) + xlab(&quot;Site&quot;) +ggtitle(&quot;DV at all sites (9/15 to 9/20) - 0.6&quot;) Existing understanding ( Max and mean temp) combined_across_MM_and_PP_Long %&gt;% dplyr::filter(day %in% c(15:20)) %&gt;% dplyr::group_by(site,day) %&gt;% dplyr::summarise(maxt=max(m1,na.rm = TRUE),mint= min(m1,na.rm = TRUE),no=n()) %&gt;% ggplot( aes(as.factor(site), maxt))+ stat_boxplot( aes(as.factor(site), maxt), geom=&#39;errorbar&#39;, linetype=1, width=0.5)+ #whiskers geom_boxplot( aes(as.factor(site), maxt),outlier.shape=1) + stat_summary(fun.y=mean, geom=&quot;point&quot;, size=2,color=&quot;red&quot;) + stat_summary(fun.data = mean_se, geom = &quot;errorbar&quot;) + theme_minimal() + ylab(&quot;Temperature(°C) &quot;) + xlab(&quot;Site&quot;) +ggtitle(&quot;Max at all sites (9/15 to 9/20) - 0.6&quot;) Data rep combined_across_MM_and_PP_Long %&gt;% filter (month %in% c(9) &amp; !site %in% c(&#39;Longmire_841&#39;,&#39;Sunrise_2097&#39;,&#39;Paradise_1645&#39;) ) %&gt;% ggplot() + geom_line(aes(hr,m1,color = site),se=F)+ facet_grid(. ~ day, scales = &quot;free&quot;) + scale_color_manual(&quot;Site(m)&quot;,values=c(&quot;AE10_1450&quot;=1,&quot;AG05_950&quot;=2,&quot;AM16_1200&quot;=3,&quot;TO04_650&quot;=4,&quot;Paradise_1645&quot;=5,&quot;Sunrise_2097&quot;=6,&quot;Longmire_841&quot;=8)) + theme_classic() + ggtitle(&quot;Diel variation in Temperature at different sites in comparison to micromet&quot;) + xlab(&quot;Hour&quot;) + ylab(&quot;Temperature (°C)&quot;) + labs(colour = &quot;Hour&quot;, subtitle=&quot;1 hr resolution&quot;,caption=&quot;Data Source : http://www.nanoclimate.org&quot;) ## 2-25-2019 Existing understanding ( Min and mean temp) combined_across_MM_and_PP_Long %&gt;% dplyr::filter(day %in% c(15:20,c(7:10))) %&gt;% dplyr::group_by(site,day) %&gt;% dplyr::summarise(meant=mean(m1,na.rm = TRUE),mint= min(m1,na.rm = TRUE),no=n()) %&gt;% ggplot( aes(as.factor(site), mint))+ stat_boxplot( aes(as.factor(site), mint), geom=&#39;errorbar&#39;, linetype=1, width=0.5)+ #whiskers geom_boxplot( aes(as.factor(site), mint),outlier.shape=1) + stat_summary(fun.y=mean, geom=&quot;point&quot;, size=2,color=&quot;red&quot;) + stat_summary(fun.data = mean_se, geom = &quot;errorbar&quot;) + theme_minimal() + ylab(&quot;Temperature(°C) &quot;) + xlab(&quot;Site&quot;) +ggtitle(&quot;Min at all sites (9/7-9/10,9/15-9/20 ) - 0.6&quot;) combined_across_MM_and_PP_Long %&gt;% dplyr::filter(day %in% c(15:20,c(7:10))) %&gt;% dplyr::group_by(site,day) %&gt;% dplyr::summarise(meant=mean(m1,na.rm = TRUE),mint= min(m1,na.rm = TRUE),no=n()) %&gt;% ggplot( aes(as.factor(site), meant))+ stat_boxplot( aes(as.factor(site), meant), geom=&#39;errorbar&#39;, linetype=1, width=0.5)+ #whiskers geom_boxplot( aes(as.factor(site), meant),outlier.shape=1) + stat_summary(fun.y=mean, geom=&quot;point&quot;, size=2,color=&quot;red&quot;) + stat_summary(fun.data = mean_se, geom = &quot;errorbar&quot;) + theme_minimal() + ylab(&quot;Temperature(°C) &quot;) + xlab(&quot;Site&quot;) +ggtitle(&quot;Mean at all sites (9/7-9/10,9/15-9/20 )&quot;) combined_across_MM_and_PP_Long %&gt;% dplyr::filter(day %in% c(15:20,c(7:10))) %&gt;% dplyr::group_by(site,day) %&gt;% dplyr::summarise(maxt=max(m1,na.rm = TRUE),mint= min(m1,na.rm = TRUE),no=n()) %&gt;% ggplot( aes(as.factor(site), maxt))+ stat_boxplot( aes(as.factor(site), maxt), geom=&#39;errorbar&#39;, linetype=1, width=0.5)+ #whiskers geom_boxplot( aes(as.factor(site), maxt),outlier.shape=1) + stat_summary(fun.y=mean, geom=&quot;point&quot;, size=2,color=&quot;red&quot;) + stat_summary(fun.data = mean_se, geom = &quot;errorbar&quot;) + theme_minimal() + ylab(&quot;Temperature(°C) &quot;) + xlab(&quot;Site&quot;) +ggtitle(&quot;Max at all sites (9/7-9/10,9/15-9/20 )&quot;) All three together combined_across_MM_and_PP_Long %&gt;% dplyr::filter(day %in% c(15:20,c(7:10))) %&gt;% dplyr::group_by(site,day) %&gt;% dplyr::summarise(maxt=max(m1,na.rm = TRUE),mint= min(m1,na.rm = TRUE),meant= mean(m1,na.rm = TRUE),no=n()) %&gt;% ggplot( aes(as.factor(site), maxt))+ stat_boxplot( aes(as.factor(site), maxt), geom=&#39;errorbar&#39;, linetype=1, width=0.5)+ #whiskers geom_boxplot( aes(as.factor(site), maxt),outlier.shape=1) + stat_summary(fun.y=mean, geom=&quot;point&quot;, size=2,color=&quot;red&quot;) + stat_summary(fun.data = mean_se, geom = &quot;errorbar&quot;) + theme_minimal() + ylab(&quot;Temperature(°C) &quot;) + xlab(&quot;Site&quot;) +ggtitle(&quot;Max at all sites (9/7-9/10,9/15-9/20 )&quot;) Height plots with temperature AE10 - TN01 mclim_AE10_TN01_2018 %&gt;% dplyr::filter(temp &gt; -10) %&gt;% ggplot(aes(as.factor(height), temp))+ stat_boxplot( aes(as.factor(height), temp), geom=&#39;errorbar&#39;, linetype=1, width=0.5)+ #whiskers geom_boxplot( aes(as.factor(height), temp),outlier.shape=1) + stat_summary(fun.y=mean, geom=&quot;point&quot;, size=2) + stat_summary(fun.data = mean_se, geom = &quot;errorbar&quot;) + theme_minimal() + ylab(&quot;Temperature(°C)&quot;) + xlab(&quot;Height&quot;) +ggtitle(&quot;AE10-Reflections lake TN01&quot;) AE10 - TN02 mclim_AE10_TN02_2018 %&gt;% dplyr::filter(temp &gt; -10) %&gt;% ggplot(aes(as.factor(height), temp))+ stat_boxplot( aes(as.factor(height), temp), geom=&#39;errorbar&#39;, linetype=1, width=0.5)+ #whiskers geom_boxplot( aes(as.factor(height), temp),outlier.shape=1) + stat_summary(fun.y=mean, geom=&quot;point&quot;, size=2) + stat_summary(fun.data = mean_se, geom = &quot;errorbar&quot;) + theme_minimal() + ylab(&quot;Temperature(°C)&quot;) + xlab(&quot;Height&quot;) +ggtitle(&quot;AE10-Reflections lake TN02&quot;) AE10 - TN03 mclim_AE10_TN03_2018 %&gt;% dplyr::filter(temp &gt; -10) %&gt;% ggplot(aes(as.factor(height), temp))+ stat_boxplot( aes(as.factor(height), temp), geom=&#39;errorbar&#39;, linetype=1, width=0.5)+ #whiskers geom_boxplot( aes(as.factor(height), temp),outlier.shape=1) + stat_summary(fun.y=mean, geom=&quot;point&quot;, size=2) + stat_summary(fun.data = mean_se, geom = &quot;errorbar&quot;) + theme_minimal() + ylab(&quot;Temperature(°C)&quot;) + xlab(&quot;Height&quot;) +ggtitle(&quot;AE10-Reflections lake TN03&quot;) AE10 CN01 mclim_AE10_CN01_2018 %&gt;% dplyr::select(time, temp1,temp2,temp3,temp4) %&gt;% dplyr::filter(temp1 &gt;0 &amp; temp2 &gt;0 &amp; temp3 &gt;0 &amp; temp4 &gt; 0 ) %&gt;% dplyr::filter(temp1 &lt;50 &amp; temp2 &lt;50 &amp; temp3 &lt;50 &amp; temp4 &lt; 50 ) %&gt;% gather(variable, value,-time) %&gt;% ggplot( aes(as.factor(variable), value))+ stat_boxplot( aes(as.factor(variable), value), geom=&#39;errorbar&#39;, linetype=1, width=0.5)+ #whiskers geom_boxplot( aes(as.factor(variable), value),outlier.shape=1) + stat_summary(fun.y=mean, geom=&quot;point&quot;, size=2) + stat_summary(fun.data = mean_se, geom = &quot;errorbar&quot;) + theme_minimal() + ylab(&quot;Temperature(°C)&quot;) + xlab(&quot;Height&quot;) +ggtitle(&quot;AE10-Reflections lake CN01&quot;) AG05 TN01 mclim_AG05_TN01_2018 %&gt;% dplyr::filter(temp &gt; -10) %&gt;% ggplot(aes(as.factor(height), temp))+ stat_boxplot( aes(as.factor(height), temp), geom=&#39;errorbar&#39;, linetype=1, width=0.5)+ #whiskers geom_boxplot( aes(as.factor(height), temp),outlier.shape=1) + stat_summary(fun.y=mean, geom=&quot;point&quot;, size=2) + stat_summary(fun.data = mean_se, geom = &quot;errorbar&quot;) + theme_minimal() + ylab(&quot;Temperature(°C)&quot;) + xlab(&quot;Height&quot;) +ggtitle(&quot;AG05-Longmire TN01&quot;) AG05 TN02 mclim_AG05_TN02_2018 %&gt;% dplyr::filter(temp &gt; -10) %&gt;% ggplot(aes(as.factor(height), temp))+ stat_boxplot( aes(as.factor(height), temp), geom=&#39;errorbar&#39;, linetype=1, width=0.5)+ #whiskers geom_boxplot( aes(as.factor(height), temp),outlier.shape=1) + stat_summary(fun.y=mean, geom=&quot;point&quot;, size=2) + stat_summary(fun.data = mean_se, geom = &quot;errorbar&quot;) + theme_minimal() + ylab(&quot;Temperature(°C)&quot;) + xlab(&quot;Height&quot;) +ggtitle(&quot;AG05-Longmire TN02&quot;) AG05 - TN03 mclim_AG05_TN03_2018 %&gt;% dplyr::filter(temp &gt; -10) %&gt;% ggplot(aes(as.factor(height), temp))+ stat_boxplot( aes(as.factor(height), temp), geom=&#39;errorbar&#39;, linetype=1, width=0.5)+ #whiskers geom_boxplot( aes(as.factor(height), temp),outlier.shape=1) + stat_summary(fun.y=mean, geom=&quot;point&quot;, size=2) + stat_summary(fun.data = mean_se, geom = &quot;errorbar&quot;) + theme_minimal() + ylab(&quot;Temperature(°C)&quot;) + xlab(&quot;Height&quot;) +ggtitle(&quot;AG05-Longmire TN03&quot;) AG05 CN01 mclim_AG05_CN01_2018 %&gt;% dplyr::select(time, temp1,temp2,temp3,temp4) %&gt;% dplyr::filter(temp1 &gt;0 &amp; temp2 &gt;0 &amp; temp3 &gt;0 &amp; temp4 &gt; 0 ) %&gt;% dplyr::filter(temp1 &lt;50 &amp; temp2 &lt;50 &amp; temp3 &lt;50 &amp; temp4 &lt; 50 ) %&gt;% gather(variable, value,-time) %&gt;% ggplot( aes(as.factor(variable), value))+ stat_boxplot( aes(as.factor(variable), value), geom=&#39;errorbar&#39;, linetype=1, width=0.5)+ #whiskers geom_boxplot( aes(as.factor(variable), value),outlier.shape=1) + stat_summary(fun.y=mean, geom=&quot;point&quot;, size=2) + stat_summary(fun.data = mean_se, geom = &quot;errorbar&quot;) + theme_minimal() + ylab(&quot;Temperature(°C)&quot;) + xlab(&quot;Height&quot;) +ggtitle(&quot;AG05-longmire CN01&quot;) TO04 TN01 mclim_TO04_TN01_2018 %&gt;% dplyr::filter(temp &gt; -10) %&gt;% ggplot(aes(as.factor(height), temp))+ stat_boxplot( aes(as.factor(height), temp), geom=&#39;errorbar&#39;, linetype=1, width=0.5)+ #whiskers geom_boxplot( aes(as.factor(height), temp),outlier.shape=1) + stat_summary(fun.y=mean, geom=&quot;point&quot;, size=2) + stat_summary(fun.data = mean_se, geom = &quot;errorbar&quot;) + theme_minimal() + ylab(&quot;Temperature(°C)&quot;) + xlab(&quot;Height&quot;) +ggtitle(&quot;TO04-TN01&quot;) mclim_TO04_TN02_2018 %&gt;% dplyr::filter(temp &gt; -10 &amp; height &gt;0) %&gt;% ggplot(aes(as.factor(height), temp))+ stat_boxplot( aes(as.factor(height), temp), geom=&#39;errorbar&#39;, linetype=1, width=0.5)+ #whiskers geom_boxplot( aes(as.factor(height), temp),outlier.shape=1) + stat_summary(fun.y=mean, geom=&quot;point&quot;, size=2) + stat_summary(fun.data = mean_se, geom = &quot;errorbar&quot;) + theme_minimal() + ylab(&quot;Temperature(°C)&quot;) + xlab(&quot;Height&quot;) +ggtitle(&quot;TO04-TN02&quot;) mclim_TO04_TN03_2018 %&gt;% dplyr::filter(temp &gt; -10) %&gt;% ggplot(aes(as.factor(height), temp))+ stat_boxplot( aes(as.factor(height), temp), geom=&#39;errorbar&#39;, linetype=1, width=0.5)+ #whiskers geom_boxplot( aes(as.factor(height), temp),outlier.shape=1) + stat_summary(fun.y=mean, geom=&quot;point&quot;, size=2) + stat_summary(fun.data = mean_se, geom = &quot;errorbar&quot;) + theme_minimal() + ylab(&quot;Temperature(°C)&quot;) + xlab(&quot;Height&quot;) +ggtitle(&quot;TO04-TN03&quot;) CN01 mclim_TO04_CN01_2018 %&gt;% dplyr::select(time, temp1,temp2,temp3,temp4) %&gt;% dplyr::filter(temp1 &gt;0 &amp; temp2 &gt;0 &amp; temp3 &gt;0 &amp; temp4 &gt; 0 ) %&gt;% dplyr::filter(temp1 &lt;50 &amp; temp2 &lt;50 &amp; temp3 &lt;50 &amp; temp4 &lt; 50 ) %&gt;% gather(variable, value,-time) %&gt;% ggplot( aes(as.factor(variable), value))+ stat_boxplot( aes(as.factor(variable), value), geom=&#39;errorbar&#39;, linetype=1, width=0.5)+ #whiskers geom_boxplot( aes(as.factor(variable), value),outlier.shape=1) + stat_summary(fun.y=mean, geom=&quot;point&quot;, size=2) + stat_summary(fun.data = mean_se, geom = &quot;errorbar&quot;) + theme_minimal() + ylab(&quot;Temperature(°C)&quot;) + xlab(&quot;Height&quot;) +ggtitle(&quot;TO04-CN01&quot;) TO04 mclim_TO04_CN01_2018 %&gt;% filter(month %in% c(9)) %&gt;% ggplot() + geom_line( aes(hr,windspeed4,color = &#39;0.3&#39;)) + geom_line( aes(hr,windspeed3,color = &#39;0.6&#39;)) + geom_line( aes(hr,windspeed2,color = &#39;0.9&#39;)) + geom_line( aes(hr,windspeed1,color = &#39;1.2&#39;)) + theme_minimal() + theme(legend.position = c(.9,.9), legend.background = element_rect(color = &quot;grey90&quot;, size = .5, linetype = &quot;dashed&quot;), axis.text.x=element_text(angle=45, hjust=1)) + theme(strip.text.x = element_text(face=&quot;bold&quot;, size=12)) + theme(strip.text.y = element_text(face=&quot;bold&quot;, size=12)) + labs(title=&quot;Wind speed measured by MM Station TO04&quot;,x=&quot;Hour&quot;, y=&quot;km/hr&quot;, tag=&quot;&quot;, colour = &quot;Height (m)&quot;, caption=&quot;Data Source : http://nanoclimate.org&quot;) AG05 mclim_AG05_CN01_2018 %&gt;% filter(month %in% c(9)) %&gt;% ggplot() + geom_line( aes(hr,windspeed4,color = &#39;0.3&#39;)) + geom_line( aes(hr,windspeed3,color = &#39;0.6&#39;)) + geom_line( aes(hr,windspeed2,color = &#39;0.9&#39;)) + geom_line( aes(hr,windspeed1,color = &#39;1.2&#39;)) + theme_minimal() + theme(legend.position = c(.9,.9), legend.background = element_rect(color = &quot;grey90&quot;, size = .5, linetype = &quot;dashed&quot;), axis.text.x=element_text(angle=45, hjust=1)) + theme(strip.text.x = element_text(face=&quot;bold&quot;, size=12)) + theme(strip.text.y = element_text(face=&quot;bold&quot;, size=12)) + labs(title=&quot;Wind speed measured by MM Station AG05&quot;,x=&quot;Hour&quot;, y=&quot;km/hr&quot;, tag=&quot;&quot;, colour = &quot;Height (m)&quot;, caption=&quot;Data Source : http://nanoclimate.org&quot;) mclim_AM16_CN01_2018 %&gt;% filter(month %in% c(9)) %&gt;% ggplot() + geom_line( aes(hr,windspeed4,color = &#39;0.3&#39;)) + geom_line( aes(hr,windspeed3,color = &#39;0.6&#39;)) + geom_line( aes(hr,windspeed2,color = &#39;0.9&#39;)) + geom_line( aes(hr,windspeed1,color = &#39;1.2&#39;)) + theme_minimal() + theme(legend.position = c(.9,.9), legend.background = element_rect(color = &quot;grey90&quot;, size = .5, linetype = &quot;dashed&quot;), axis.text.x=element_text(angle=45, hjust=1)) + theme(strip.text.x = element_text(face=&quot;bold&quot;, size=12)) + theme(strip.text.y = element_text(face=&quot;bold&quot;, size=12)) + labs(title=&quot;Wind speed measured by MM Station AM16&quot;,x=&quot;Hour&quot;, y=&quot;km/hr&quot;, tag=&quot;&quot;, colour = &quot;Height (m)&quot;, caption=&quot;Data Source : http://nanoclimate.org&quot;) mclim_AE10_CN01_2018 %&gt;% filter(month %in% c(9)) %&gt;% ggplot() + geom_line( aes(hr,windspeed4,color = &#39;0.3&#39;)) + geom_line( aes(hr,windspeed3,color = &#39;0.6&#39;)) + geom_line( aes(hr,windspeed2,color = &#39;0.9&#39;)) + geom_line( aes(hr,windspeed1,color = &#39;1.2&#39;)) + theme_minimal() + theme(legend.position = c(.9,.9), legend.background = element_rect(color = &quot;grey90&quot;, size = .5, linetype = &quot;dashed&quot;), axis.text.x=element_text(angle=45, hjust=1)) + theme(strip.text.x = element_text(face=&quot;bold&quot;, size=12)) + theme(strip.text.y = element_text(face=&quot;bold&quot;, size=12)) + labs(title=&quot;Wind speed measured by MM Station AE10&quot;,x=&quot;Hour&quot;, y=&quot;km/hr&quot;, tag=&quot;&quot;, colour = &quot;Height (m)&quot;, caption=&quot;Data Source : http://nanoclimate.org&quot;) 8.37 2-26-2019 Wind across 4 elevations at different heights mw1 &lt;- mclim_AE10_CN01_2018 %&gt;% filter(month %in% c(9,10) &amp; time &gt; date(&#39;2018-09-05&#39;)) %&gt;% ggplot() + geom_line( aes(time,windspeed4,color = &#39;0.3&#39;)) + geom_line( aes(time,windspeed3,color = &#39;0.6&#39;)) + geom_line( aes(time,windspeed2,color = &#39;0.9&#39;)) + geom_line( aes(time,windspeed1,color = &#39;1.2&#39;)) + theme_minimal() + theme(legend.position = c(.1,.8), legend.background = element_rect(color = &quot;grey90&quot;, size = .5, linetype = &quot;dashed&quot;), axis.text.x=element_text(angle=45, hjust=1)) + theme(strip.text.x = element_text(face=&quot;bold&quot;, size=12)) + theme(strip.text.y = element_text(face=&quot;bold&quot;, size=12)) + scale_y_continuous(limits = c(0, 4),breaks = c(0,1,2,3,4)) + labs(title=&quot;AE10&quot;,x=&quot;Date&quot;, y=&quot;km/hr&quot;, tag=&quot;&quot;, colour = &quot;Height (m)&quot;) mw2 &lt;- mclim_AM16_CN01_2018 %&gt;% filter(month %in% c(9,10) &amp; time &gt; date(&#39;2018-09-05&#39;)) %&gt;% ggplot() + geom_line( aes(time,windspeed4,color = &#39;0.3&#39;)) + geom_line( aes(time,windspeed3,color = &#39;0.6&#39;)) + geom_line( aes(time,windspeed2,color = &#39;0.9&#39;)) + geom_line( aes(time,windspeed1,color = &#39;1.2&#39;)) + theme_minimal() + theme(legend.position=&quot;none&quot;, legend.background = element_rect(color = &quot;grey90&quot;, size = .5, linetype = &quot;dashed&quot;), axis.text.x=element_text(angle=45, hjust=1)) + theme(strip.text.x = element_text(face=&quot;bold&quot;, size=12)) + theme(strip.text.y = element_text(face=&quot;bold&quot;, size=12)) + scale_y_continuous(limits = c(0, 4),breaks = c(0,1,2,3,4)) + labs(title=&quot;AM16&quot;,x=&quot;Date&quot;, y=&quot;km/hr&quot;, tag=&quot;&quot;, colour = &quot;Height (m)&quot;) mw3 &lt;- mclim_AG05_CN01_2018 %&gt;% filter(month %in% c(9,10) &amp; time &gt; date(&#39;2018-09-05&#39;)) %&gt;% ggplot() + geom_line( aes(time,windspeed4,color = &#39;0.3&#39;)) + geom_line( aes(time,windspeed3,color = &#39;0.6&#39;)) + geom_line( aes(time,windspeed2,color = &#39;0.9&#39;)) + geom_line( aes(time,windspeed1,color = &#39;1.2&#39;)) + theme_minimal() + ylim(0,4) + theme(legend.position=&quot;none&quot;, legend.background = element_rect(color = &quot;grey90&quot;, size = .5, linetype = &quot;dashed&quot;), axis.text.x=element_text(angle=45, hjust=1)) + theme(strip.text.x = element_text(face=&quot;bold&quot;, size=12)) + theme(strip.text.y = element_text(face=&quot;bold&quot;, size=12)) + scale_y_continuous(limits = c(0, 4),breaks = c(0,1,2,3,4)) + labs(title=&quot;AG05&quot;,x=&quot;Date&quot;, y=&quot;km/hr&quot;, tag=&quot;&quot;, colour = &quot;Height (m)&quot;) ## Scale for &#39;y&#39; is already present. Adding another scale for &#39;y&#39;, which ## will replace the existing scale. mw4 &lt;- mclim_TO04_CN01_2018 %&gt;% filter(month %in% c(9,10) &amp; time &gt; date(&#39;2018-09-05&#39;)) %&gt;% ggplot() + geom_line( aes(time,windspeed4,color = &#39;0.3&#39;)) + geom_line( aes(time,windspeed3,color = &#39;0.6&#39;)) + geom_line( aes(time,windspeed2,color = &#39;0.9&#39;)) + geom_line( aes(time,windspeed1,color = &#39;1.2&#39;)) + theme_minimal() + theme(legend.position=&quot;none&quot;, legend.background = element_rect(color = &quot;grey90&quot;, size = .5, linetype = &quot;dashed&quot;), axis.text.x=element_text(angle=45, hjust=1)) + theme(strip.text.x = element_text(face=&quot;bold&quot;, size=12)) + theme(strip.text.y = element_text(face=&quot;bold&quot;, size=12)) + scale_y_continuous(limits = c(0, 4),breaks = c(0,1,2,3,4)) + labs(title=&quot;TO04&quot;,x=&quot;Date&quot;, y=&quot;km/hr&quot;, tag=&quot;&quot;, colour = &quot;Height (m)&quot;) library(cowplot) ## ## Attaching package: &#39;cowplot&#39; ## The following object is masked from &#39;package:ggpubr&#39;: ## ## get_legend ## The following object is masked from &#39;package:ggplot2&#39;: ## ## ggsave main_row_wind_ts &lt;- plot_grid(mw1,mw2,mw3,mw4, align = &quot;v&quot;, nrow = 1) plot_grid(main_row_wind_ts ,nrow = 1) Wind at four heights , but hourly mw1 &lt;- mclim_AE10_CN01_2018 %&gt;% filter(month %in% c(9,10) &amp; time &gt; date(&#39;2018-09-05&#39;)) %&gt;% ggplot() + geom_smooth(method=&quot;loess&quot; ,aes(hr,windspeed4,color = &#39;0.3&#39;),span = 0.8,n=10) + geom_smooth(method=&quot;loess&quot; ,aes(hr,windspeed3,color = &#39;0.6&#39;),span = 0.8,n=10) + geom_smooth(method=&quot;loess&quot; ,aes(hr,windspeed2,color = &#39;0.9&#39;),span = 0.8,n=10) + geom_smooth(method=&quot;loess&quot; ,aes(hr,windspeed1,color = &#39;1.2&#39;),span = 0.8,n=10) + theme_minimal() + theme(legend.position = c(.1,.8), legend.background = element_rect(color = &quot;grey90&quot;, size = .5, linetype = &quot;dashed&quot;), axis.text.x=element_text(angle=45, hjust=1)) + theme(strip.text.x = element_text(face=&quot;bold&quot;, size=12)) + theme(strip.text.y = element_text(face=&quot;bold&quot;, size=12)) + labs(title=&quot;AE10&quot;,x=&quot;Hour&quot;, y=&quot;km/hr&quot;, tag=&quot;&quot;, colour = &quot;Height (m)&quot;) mw2 &lt;- mclim_AM16_CN01_2018 %&gt;% filter(month %in% c(9,10) &amp; time &gt; date(&#39;2018-09-05&#39;)) %&gt;% ggplot() + geom_smooth(method=&quot;loess&quot; ,aes(hr,windspeed4,color = &#39;0.3&#39;),span = 0.8,n=10) + geom_smooth(method=&quot;loess&quot; ,aes(hr,windspeed3,color = &#39;0.6&#39;),span = 0.8,n=10) + geom_smooth(method=&quot;loess&quot; ,aes(hr,windspeed2,color = &#39;0.9&#39;),span = 0.8,n=10) + geom_smooth(method=&quot;loess&quot; ,aes(hr,windspeed1,color = &#39;1.2&#39;),span = 0.8,n=10) + theme_minimal() + theme(legend.position=&quot;none&quot;, legend.background = element_rect(color = &quot;grey90&quot;, size = .5, linetype = &quot;dashed&quot;), axis.text.x=element_text(angle=45, hjust=1)) + theme(strip.text.x = element_text(face=&quot;bold&quot;, size=12)) + theme(strip.text.y = element_text(face=&quot;bold&quot;, size=12)) + labs(title=&quot;AM16&quot;,x=&quot;Hour&quot;, y=&quot;km/hr&quot;, tag=&quot;&quot;, colour = &quot;Height (m)&quot;) mw3 &lt;- mclim_AG05_CN01_2018 %&gt;% filter(month %in% c(9,10) &amp; time &gt; date(&#39;2018-09-05&#39;)) %&gt;% ggplot() + geom_smooth(method=&quot;loess&quot; ,aes(hr,windspeed4,color = &#39;0.3&#39;),span = 0.8,n=10) + geom_smooth(method=&quot;loess&quot; ,aes(hr,windspeed3,color = &#39;0.6&#39;),span = 0.8,n=10) + geom_smooth(method=&quot;loess&quot; ,aes(hr,windspeed2,color = &#39;0.9&#39;),span = 0.8,n=10) + geom_smooth(method=&quot;loess&quot; ,aes(hr,windspeed1,color = &#39;1.2&#39;),span = 0.8,n=10) + theme_minimal() + theme(legend.position=&quot;none&quot;, legend.background = element_rect(color = &quot;grey90&quot;, size = .5, linetype = &quot;dashed&quot;), axis.text.x=element_text(angle=45, hjust=1)) + theme(strip.text.x = element_text(face=&quot;bold&quot;, size=12)) + theme(strip.text.y = element_text(face=&quot;bold&quot;, size=12)) + labs(title=&quot;AG05&quot;,x=&quot;Hour&quot;, y=&quot;km/hr&quot;, tag=&quot;&quot;, colour = &quot;Height (m)&quot;) mw4 &lt;- mclim_TO04_CN01_2018 %&gt;% filter(month %in% c(9,10) &amp; time &gt; date(&#39;2018-09-05&#39;)) %&gt;% ggplot() + geom_smooth(method=&quot;loess&quot; ,aes(hr,windspeed4,color = &#39;0.3&#39;),span = 0.8,n=10) + geom_smooth(method=&quot;loess&quot; ,aes(hr,windspeed3,color = &#39;0.6&#39;),span = 0.8,n=10) + geom_smooth(method=&quot;loess&quot; ,aes(hr,windspeed2,color = &#39;0.9&#39;),span = 0.8,n=10) + geom_smooth(method=&quot;loess&quot; ,aes(hr,windspeed1,color = &#39;1.2&#39;),span = 0.8,n=10) + theme_minimal() + theme(legend.position=&quot;none&quot;, legend.background = element_rect(color = &quot;grey90&quot;, size = .5, linetype = &quot;dashed&quot;), axis.text.x=element_text(angle=45, hjust=1)) + theme(strip.text.x = element_text(face=&quot;bold&quot;, size=12)) + theme(strip.text.y = element_text(face=&quot;bold&quot;, size=12)) + labs(title=&quot;TO04&quot;,x=&quot;Hour&quot;, y=&quot;km/hr&quot;, tag=&quot;&quot;, colour = &quot;Height (m)&quot;) library(cowplot) main_row_wind_hr &lt;- plot_grid(mw1,mw2,mw3,mw4, align = &quot;v&quot;, nrow = 1) plot_grid(main_row_wind_hr ,nrow = 1) Solar radiation at 4 different heights Wind across 4 elevations at different elevations , one height mw1 &lt;- mclim_AE10_CN01_2018 %&gt;% filter(month %in% c(9,10) &amp; time &gt; date(&#39;2018-09-05&#39;)) %&gt;% mutate(solrf = ((solar-39) * 1.8) + ((25 -temp1) * .0012)) %&gt;% ggplot() + geom_line( aes(time,solrf,color = &#39;1.2&#39;)) + theme_minimal() + theme(legend.position = c(.3,.8), legend.background = element_rect(color = &quot;grey90&quot;, size = .5, linetype = &quot;dashed&quot;), axis.text.x=element_text(angle=45, hjust=1)) + theme(strip.text.x = element_text(face=&quot;bold&quot;, size=12)) + theme(strip.text.y = element_text(face=&quot;bold&quot;, size=12)) + scale_y_continuous(limits = c(0, 600),breaks = c(0,50,100,150,200,250,300,350,400,450,500,550,600)) + labs(title=&quot;AE10&quot;,x=&quot;Date&quot;, y=&quot;Watts/m^2&quot;, tag=&quot;&quot;, colour = &quot;Height (m)&quot;) mw2 &lt;- mclim_AM16_CN01_2018 %&gt;% filter(month %in% c(9,10) &amp; time &gt; date(&#39;2018-09-05&#39;)) %&gt;% mutate(solrf = ((solar-39) * 1.8) + ((25 -temp1) * .0012)) %&gt;% ggplot() + geom_line( aes(time,solrf,color = &#39;1.2&#39;)) + theme_minimal() + theme(legend.position=&quot;none&quot;, legend.background = element_rect(color = &quot;grey90&quot;, size = .5, linetype = &quot;dashed&quot;), axis.text.x=element_text(angle=45, hjust=1)) + theme(strip.text.x = element_text(face=&quot;bold&quot;, size=12)) + theme(strip.text.y = element_text(face=&quot;bold&quot;, size=12)) + scale_y_continuous(limits = c(0, 600),breaks = c(0,50,100,150,200,250,300,350,400,450,500,550,600)) + labs(title=&quot;AM16&quot;,x=&quot;Date&quot;, y=&quot;Watts/m^2&quot;, tag=&quot;&quot;, colour = &quot;Height (m)&quot;) mw3 &lt;- mclim_AG05_CN01_2018 %&gt;% filter(month %in% c(9,10) &amp; time &gt; date(&#39;2018-09-05&#39;)) %&gt;% mutate(solrf = ((solar-39) * 1.8) + ((25 -temp1) * .0012)) %&gt;% ggplot() + geom_line( aes(time,solrf,color = &#39;1.2&#39;)) + theme_minimal() + ylim(0,4) + theme(legend.position=&quot;none&quot;, legend.background = element_rect(color = &quot;grey90&quot;, size = .5, linetype = &quot;dashed&quot;), axis.text.x=element_text(angle=45, hjust=1)) + theme(strip.text.x = element_text(face=&quot;bold&quot;, size=12)) + theme(strip.text.y = element_text(face=&quot;bold&quot;, size=12)) + scale_y_continuous(limits = c(0, 600),breaks = c(0,50,100,150,200,250,300,350,400,450,500,550,600)) + labs(title=&quot;AG05&quot;,x=&quot;Date&quot;, y=&quot;Watts/m^2&quot;, tag=&quot;&quot;, colour = &quot;Height (m)&quot;) ## Scale for &#39;y&#39; is already present. Adding another scale for &#39;y&#39;, which ## will replace the existing scale. mw4 &lt;- mclim_TO04_CN01_2018 %&gt;% filter(month %in% c(9,10) &amp; time &gt; date(&#39;2018-09-05&#39;)) %&gt;% mutate(solrf = ((solar-39) * 1.8) + ((25 -temp1) * .0012)) %&gt;% ggplot() + geom_line( aes(time,solrf,color = &#39;1.2&#39;)) + theme_minimal() + theme(legend.position=&quot;none&quot;, legend.background = element_rect(color = &quot;grey90&quot;, size = .5, linetype = &quot;dashed&quot;), axis.text.x=element_text(angle=45, hjust=1)) + theme(strip.text.x = element_text(face=&quot;bold&quot;, size=12)) + theme(strip.text.y = element_text(face=&quot;bold&quot;, size=12)) + scale_y_continuous(limits = c(0, 600),breaks = c(0,50,100,150,200,250,300,350,400,450,500,550,600)) + labs(title=&quot;TO04&quot;,x=&quot;Date&quot;, y=&quot;Watts/m^2&quot;, tag=&quot;&quot;, colour = &quot;Height (m)&quot;) library(cowplot) main_row_ts &lt;- plot_grid(mw1,mw2,mw3,mw4, align = &quot;v&quot;, nrow = 1) plot_grid(main_row_ts ,nrow = 1) 8.38 2-27-2019 Need to see spread of solar radation by hour, and do we see prolonged period of illumination? I believe the reduced solar radiation penetration reflects on the distribution and nature of understory vegetation. Most of the understories are varied, and the ones are prominent in the confiers are very dry, and the ones which are close to water exhibit ferns, and similar kind of bog loving vegetation (personal observation). Its also possible that they are adapted to reduced avaliability of radiation. Hourly radiation load mw1 &lt;- mclim_AE10_CN01_2018 %&gt;% filter(month %in% c(9,10) &amp; time &gt; date(&#39;2018-09-05&#39;)) %&gt;% mutate(solrf = ((solar-39) * 1.8) + ((25 -temp1) * .0012)) %&gt;% ggplot() + geom_line( aes(hr,solrf,color = &#39;1.2&#39;)) + theme_minimal() + theme(legend.position = &quot;none&quot;, legend.background = element_rect(color = &quot;grey90&quot;, size = .5, linetype = &quot;dashed&quot;), axis.text.x=element_text(angle=45, hjust=1)) + theme(strip.text.x = element_text(face=&quot;bold&quot;, size=12)) + theme(strip.text.y = element_text(face=&quot;bold&quot;, size=12)) + scale_y_continuous(limits = c(0, 600),breaks = c(0,50,100,150,200,250,300,350,400,450,500,550,600)) + labs(title=&quot;AE10&quot;,x=&quot;Date&quot;, y=&quot;Watts/m^2&quot;, tag=&quot;&quot;, colour = &quot;Height (m)&quot;) mw2 &lt;- mclim_AM16_CN01_2018 %&gt;% filter(month %in% c(9,10) &amp; time &gt; date(&#39;2018-09-05&#39;)) %&gt;% mutate(solrf = ((solar-39) * 1.8) + ((25 -temp1) * .0012)) %&gt;% ggplot() + geom_line( aes(hr,solrf,color = &#39;1.2&#39;)) + theme_minimal() + theme(legend.position=&quot;none&quot;, legend.background = element_rect(color = &quot;grey90&quot;, size = .5, linetype = &quot;dashed&quot;), axis.text.x=element_text(angle=45, hjust=1)) + theme(strip.text.x = element_text(face=&quot;bold&quot;, size=12)) + theme(strip.text.y = element_text(face=&quot;bold&quot;, size=12)) + scale_y_continuous(limits = c(0, 600),breaks = c(0,50,100,150,200,250,300,350,400,450,500,550,600)) + labs(title=&quot;AM16&quot;,x=&quot;Date&quot;, y=&quot;Watts/m^2&quot;, tag=&quot;&quot;, colour = &quot;Height (m)&quot;) mw3 &lt;- mclim_AG05_CN01_2018 %&gt;% filter(month %in% c(9,10) &amp; time &gt; date(&#39;2018-09-05&#39;)) %&gt;% mutate(solrf = ((solar-39) * 1.8) + ((25 -temp1) * .0012)) %&gt;% ggplot() + geom_line( aes(hr,solrf,color = &#39;1.2&#39;)) + theme_minimal() + ylim(0,4) + theme(legend.position=&quot;none&quot;, legend.background = element_rect(color = &quot;grey90&quot;, size = .5, linetype = &quot;dashed&quot;), axis.text.x=element_text(angle=45, hjust=1)) + theme(strip.text.x = element_text(face=&quot;bold&quot;, size=12)) + theme(strip.text.y = element_text(face=&quot;bold&quot;, size=12)) + scale_y_continuous(limits = c(0, 600),breaks = c(0,50,100,150,200,250,300,350,400,450,500,550,600)) + labs(title=&quot;AG05&quot;,x=&quot;Date&quot;, y=&quot;Watts/m^2&quot;, tag=&quot;&quot;, colour = &quot;Height (m)&quot;) ## Scale for &#39;y&#39; is already present. Adding another scale for &#39;y&#39;, which ## will replace the existing scale. mw4 &lt;- mclim_TO04_CN01_2018 %&gt;% filter(month %in% c(9,10) &amp; time &gt; date(&#39;2018-09-05&#39;)) %&gt;% mutate(solrf = ((solar-39) * 1.8) + ((25 -temp1) * .0012)) %&gt;% ggplot() + geom_line( aes(hr,solrf,color = &#39;1.2&#39;)) + theme_minimal() + theme(legend.position=&quot;none&quot;, legend.background = element_rect(color = &quot;grey90&quot;, size = .5, linetype = &quot;dashed&quot;), axis.text.x=element_text(angle=45, hjust=1)) + theme(strip.text.x = element_text(face=&quot;bold&quot;, size=12)) + theme(strip.text.y = element_text(face=&quot;bold&quot;, size=12)) + scale_y_continuous(limits = c(0, 600),breaks = c(0,50,100,150,200,250,300,350,400,450,500,550,600)) + labs(title=&quot;TO04&quot;,x=&quot;Date&quot;, y=&quot;Watts/m^2&quot;, tag=&quot;&quot;, colour = &quot;Height (m)&quot;) library(cowplot) main_row &lt;- plot_grid(mw1,mw2,mw3,mw4, align = &quot;v&quot;, nrow = 1) plot_grid(main_row ,nrow = 1) Find the duration as literature says that topical forests receive 5-10 mins, and temperates should be an hour. I believe, this should be qualified with the opening. mw1 &lt;- mclim_AE10_CN01_2018 %&gt;% filter(month %in% c(9,10) &amp; time &gt; date(&#39;2018-09-05&#39;)) %&gt;% mutate(solrf = ((solar-39) * 1.8) + ((25 -temp1) * .0012)) %&gt;% mutate(hm = as.POSIXct( paste(hr,minute,sep = &#39;:&#39;) , format = &quot;%H:%M&quot;)) %&gt;% mutate(hms = hms::as.hms(hm)) %&gt;% ggplot() + #geom_line( aes(hr,solrf,color = &#39;1.2&#39;)) + geom_point(aes(hms,solrf,color = &#39;1.2&#39;)) + theme_minimal() + theme(legend.position = &quot;none&quot;, legend.background = element_rect(color = &quot;grey90&quot;, size = .5, linetype = &quot;dashed&quot;), axis.text.x=element_text(angle=90, hjust=1)) + scale_y_continuous(limits = c(0, 600),breaks = c(0,50,100,150,200,250,300,350,400,450,500,550,600)) + scale_x_time(labels=date_format(&quot;%H:%M&quot;)) + labs(title=&quot;AE10&quot;,x=&quot;Hour&quot;, y=&quot;Watts/m^2&quot;, tag=&quot;&quot;, colour = &quot;Height (m)&quot;) mw2 &lt;- mclim_AM16_CN01_2018 %&gt;% filter(month %in% c(9,10) &amp; time &gt; date(&#39;2018-09-05&#39;)) %&gt;% mutate(solrf = ((solar-39) * 1.8) + ((25 -temp1) * .0012)) %&gt;% mutate(hm = as.POSIXct( paste(hr,minute,sep = &#39;:&#39;) , format = &quot;%H:%M&quot;)) %&gt;% mutate(hms = hms::as.hms(hm)) %&gt;% ggplot() + #geom_line( aes(hr,solrf,color = &#39;1.2&#39;)) + geom_point(aes(hms,solrf,color = &#39;1.2&#39;)) + theme_minimal() + theme(legend.position = &quot;none&quot;, legend.background = element_rect(color = &quot;grey90&quot;, size = .5, linetype = &quot;dashed&quot;), axis.text.x=element_text(angle=90, hjust=1)) + scale_y_continuous(limits = c(0, 600),breaks = c(0,50,100,150,200,250,300,350,400,450,500,550,600)) + scale_x_time(labels=date_format(&quot;%H:%M&quot;)) + labs(title=&quot;AM16&quot;,x=&quot;Hour&quot;, y=&quot;Watts/m^2&quot;, tag=&quot;&quot;, colour = &quot;Height (m)&quot;) mw3 &lt;- mclim_AG05_CN01_2018 %&gt;% filter(month %in% c(9,10) &amp; time &gt; date(&#39;2018-09-05&#39;)) %&gt;% mutate(solrf = ((solar-39) * 1.8) + ((25 -temp1) * .0012)) %&gt;% mutate(hm = as.POSIXct( paste(hr,minute,sep = &#39;:&#39;) , format = &quot;%H:%M&quot;)) %&gt;% mutate(hms = hms::as.hms(hm)) %&gt;% ggplot() + #geom_line( aes(hr,solrf,color = &#39;1.2&#39;)) + geom_point(aes(hms,solrf,color = &#39;1.2&#39;)) + theme_minimal() + theme(legend.position = &quot;none&quot;, legend.background = element_rect(color = &quot;grey90&quot;, size = .5, linetype = &quot;dashed&quot;), axis.text.x=element_text(angle=90, hjust=1)) + scale_y_continuous(limits = c(0, 600),breaks = c(0,50,100,150,200,250,300,350,400,450,500,550,600)) + scale_x_time(labels=date_format(&quot;%H:%M&quot;)) + labs(title=&quot;AG05&quot;,x=&quot;Hour&quot;, y=&quot;Watts/m^2&quot;, tag=&quot;&quot;, colour = &quot;Height (m)&quot;) mw4 &lt;- mclim_TO04_CN01_2018 %&gt;% filter(month %in% c(9,10) &amp; time &gt; date(&#39;2018-09-05&#39;)) %&gt;% mutate(solrf = ((solar-39) * 1.8) + ((25 -temp1) * .0012)) %&gt;% mutate(hm = as.POSIXct( paste(hr,minute,sep = &#39;:&#39;) , format = &quot;%H:%M&quot;)) %&gt;% mutate(hms = hms::as.hms(hm)) %&gt;% ggplot() + #geom_line( aes(hr,solrf,color = &#39;1.2&#39;)) + geom_point(aes(hms,solrf,color = &#39;1.2&#39;)) + theme_minimal() + theme(legend.position = &quot;none&quot;, legend.background = element_rect(color = &quot;grey90&quot;, size = .5, linetype = &quot;dashed&quot;), axis.text.x=element_text(angle=90, hjust=1)) + scale_y_continuous(limits = c(0, 600),breaks = c(0,50,100,150,200,250,300,350,400,450,500,550,600)) + scale_x_time(labels=date_format(&quot;%H:%M&quot;)) + labs(title=&quot;TO04&quot;,x=&quot;Hour&quot;, y=&quot;Watts/m^2&quot;, tag=&quot;&quot;, colour = &quot;Height (m)&quot;) library(cowplot) main_row_hr &lt;- plot_grid(mw1,mw2,mw3,mw4, align = &quot;v&quot;, nrow = 1) plot_grid(main_row_hr ,nrow = 1) Histogram mw1 &lt;- mclim_AE10_CN01_2018 %&gt;% filter(month %in% c(9,10) &amp; time &gt; date(&#39;2018-09-05&#39;)) %&gt;% mutate(solrf = ((solar-39) * 1.8) + ((25 -temp1) * .0012)) %&gt;% mutate(hm = as.POSIXct( paste(hr,minute,sep = &#39;:&#39;) , format = &quot;%H:%M&quot;)) %&gt;% mutate(hms = hms::as.hms(hm)) %&gt;% ggplot() + #geom_line( aes(hr,solrf,color = &#39;1.2&#39;)) + geom_histogram(aes(solrf)) + theme_minimal() + theme(legend.position = &quot;none&quot;, legend.background = element_rect(color = &quot;grey90&quot;, size = .5, linetype = &quot;dashed&quot;), axis.text.x=element_text(angle=90, hjust=1)) + scale_y_continuous(limits = c(0, 600),breaks = c(0,50,100,150,200,250,300,350,400,450,500,550,600)) + labs(title=&quot;AE10&quot;,x=&quot;Watts/m^2&quot;, y=&quot;Count&quot;, tag=&quot;&quot;, colour = &quot;&quot;) mw2 &lt;- mclim_AM16_CN01_2018 %&gt;% filter(month %in% c(9,10) &amp; time &gt; date(&#39;2018-09-05&#39;)) %&gt;% mutate(solrf = ((solar-39) * 1.8) + ((25 -temp1) * .0012)) %&gt;% mutate(hm = as.POSIXct( paste(hr,minute,sep = &#39;:&#39;) , format = &quot;%H:%M&quot;)) %&gt;% mutate(hms = hms::as.hms(hm)) %&gt;% ggplot() + #geom_line( aes(hr,solrf,color = &#39;1.2&#39;)) + geom_histogram(aes(solrf)) + theme_minimal() + theme(legend.position = &quot;none&quot;, legend.background = element_rect(color = &quot;grey90&quot;, size = .5, linetype = &quot;dashed&quot;), axis.text.x=element_text(angle=90, hjust=1)) + scale_y_continuous(limits = c(0, 600),breaks = c(0,50,100,150,200,250,300,350,400,450,500,550,600)) + labs(title=&quot;AM16&quot;,x=&quot;Watts/m^2&quot;, y=&quot;Count&quot;, tag=&quot;&quot;, colour = &quot;&quot;) mw3 &lt;- mclim_AG05_CN01_2018 %&gt;% filter(month %in% c(9,10) &amp; time &gt; date(&#39;2018-09-05&#39;)) %&gt;% mutate(solrf = ((solar-39) * 1.8) + ((25 -temp1) * .0012)) %&gt;% mutate(hm = as.POSIXct( paste(hr,minute,sep = &#39;:&#39;) , format = &quot;%H:%M&quot;)) %&gt;% mutate(hms = hms::as.hms(hm)) %&gt;% ggplot() + #geom_line( aes(hr,solrf,color = &#39;1.2&#39;)) + geom_histogram(aes(solrf)) + theme_minimal() + theme(legend.position = &quot;none&quot;, legend.background = element_rect(color = &quot;grey90&quot;, size = .5, linetype = &quot;dashed&quot;), axis.text.x=element_text(angle=90, hjust=1)) + scale_y_continuous(limits = c(0, 600),breaks = c(0,50,100,150,200,250,300,350,400,450,500,550,600)) + labs(title=&quot;AG05&quot;, x=&quot;Watts/m^2&quot;, y=&quot;Count&quot;, tag=&quot;&quot;, colour = &quot;&quot;) mw4 &lt;- mclim_TO04_CN01_2018 %&gt;% filter(month %in% c(9,10) &amp; time &gt; date(&#39;2018-09-05&#39;)) %&gt;% mutate(solrf = ((solar-39) * 1.8) + ((25 -temp1) * .0012)) %&gt;% mutate(hm = as.POSIXct( paste(hr,minute,sep = &#39;:&#39;) , format = &quot;%H:%M&quot;)) %&gt;% mutate(hms = hms::as.hms(hm)) %&gt;% ggplot() + #geom_line( aes(hr,solrf,color = &#39;1.2&#39;)) + geom_histogram(aes(solrf)) + theme_minimal() + theme(legend.position = &quot;none&quot;, legend.background = element_rect(color = &quot;grey90&quot;, size = .5, linetype = &quot;dashed&quot;), axis.text.x=element_text(angle=90, hjust=1)) + scale_y_continuous(limits = c(0, 600),breaks = c(0,50,100,150,200,250,300,350,400,450,500,550,600)) + labs(title=&quot;TO04&quot;,x=&quot;Watts/m^2&quot;, y=&quot;Count&quot;, tag=&quot;&quot;, colour = &quot;&quot;) library(cowplot) main_row_hst &lt;- plot_grid(mw1,mw2,mw3,mw4, align = &quot;v&quot;, nrow = 1) ## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`. ## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`. ## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`. ## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`. plot_grid(main_row_hst ,nrow = 1) 8.39 3-1-2019 Combined Panel Solar title &lt;- ggdraw() + draw_label(&quot;Solar conditions for MM sites understories&quot;, fontface=&#39;bold&#39;) plot_grid(title, main_row_ts,main_row_hr, main_row_hst, nrow = 4, labels = c(&quot;&quot;, &quot;A&quot;,&quot;B&quot;, &quot;C&quot;), rel_heights = c(0.2, 1,.8, .8)) Wind mw1 &lt;- mclim_AE10_CN01_2018 %&gt;% filter(month %in% c(9,10) &amp; time &gt; date(&#39;2018-09-05&#39;)) %&gt;% mutate(hm = as.POSIXct( paste(hr,minute,sep = &#39;:&#39;) , format = &quot;%H:%M&quot;)) %&gt;% mutate(hms = hms::as.hms(hm)) %&gt;% ggplot() + geom_smooth(method=&quot;loess&quot; ,aes(hms,windspeed4,color = &#39;0.3&#39;),span = 0.8,n=10) + geom_smooth(method=&quot;loess&quot; ,aes(hms,windspeed3,color = &#39;0.6&#39;),span = 0.8,n=10) + geom_smooth(method=&quot;loess&quot; ,aes(hms,windspeed2,color = &#39;0.9&#39;),span = 0.8,n=10) + geom_smooth(method=&quot;loess&quot; ,aes(hms,windspeed1,color = &#39;1.2&#39;),span = 0.8,n=10) + theme_minimal() + theme(legend.position = c(.1,.8), legend.background = element_rect(color = &quot;grey90&quot;, size = .5, linetype = &quot;dashed&quot;), axis.text.x=element_text(angle=45, hjust=1)) + theme(strip.text.x = element_text(face=&quot;bold&quot;, size=12)) + theme(strip.text.y = element_text(face=&quot;bold&quot;, size=12)) + labs(title=&quot;AE10&quot;,x=&quot;Hour&quot;, y=&quot;km/hr&quot;, tag=&quot;&quot;, colour = &quot;Height (m)&quot;) mw2 &lt;- mclim_AM16_CN01_2018 %&gt;% filter(month %in% c(9,10) &amp; time &gt; date(&#39;2018-09-05&#39;)) %&gt;% mutate(hm = as.POSIXct( paste(hr,minute,sep = &#39;:&#39;) , format = &quot;%H:%M&quot;)) %&gt;% mutate(hms = hms::as.hms(hm)) %&gt;% ggplot() + geom_smooth(method=&quot;loess&quot; ,aes(hms,windspeed4,color = &#39;0.3&#39;),span = 0.8,n=10) + geom_smooth(method=&quot;loess&quot; ,aes(hms,windspeed3,color = &#39;0.6&#39;),span = 0.8,n=10) + geom_smooth(method=&quot;loess&quot; ,aes(hms,windspeed2,color = &#39;0.9&#39;),span = 0.8,n=10) + geom_smooth(method=&quot;loess&quot; ,aes(hms,windspeed1,color = &#39;1.2&#39;),span = 0.8,n=10) + theme_minimal() + theme(legend.position=&quot;none&quot;, legend.background = element_rect(color = &quot;grey90&quot;, size = .5, linetype = &quot;dashed&quot;), axis.text.x=element_text(angle=45, hjust=1)) + theme(strip.text.x = element_text(face=&quot;bold&quot;, size=12)) + theme(strip.text.y = element_text(face=&quot;bold&quot;, size=12)) + labs(title=&quot;AM16&quot;,x=&quot;Hour&quot;, y=&quot;km/hr&quot;, tag=&quot;&quot;, colour = &quot;Height (m)&quot;) mw3 &lt;- mclim_AG05_CN01_2018 %&gt;% filter(month %in% c(9,10) &amp; time &gt; date(&#39;2018-09-05&#39;)) %&gt;% mutate(hm = as.POSIXct( paste(hr,minute,sep = &#39;:&#39;) , format = &quot;%H:%M&quot;)) %&gt;% mutate(hms = hms::as.hms(hm)) %&gt;% ggplot() + geom_smooth(method=&quot;loess&quot; ,aes(hms,windspeed4,color = &#39;0.3&#39;),span = 0.8,n=10) + geom_smooth(method=&quot;loess&quot; ,aes(hms,windspeed3,color = &#39;0.6&#39;),span = 0.8,n=10) + geom_smooth(method=&quot;loess&quot; ,aes(hms,windspeed2,color = &#39;0.9&#39;),span = 0.8,n=10) + geom_smooth(method=&quot;loess&quot; ,aes(hms,windspeed1,color = &#39;1.2&#39;),span = 0.8,n=10) + theme_minimal() + theme(legend.position=&quot;none&quot;, legend.background = element_rect(color = &quot;grey90&quot;, size = .5, linetype = &quot;dashed&quot;), axis.text.x=element_text(angle=45, hjust=1)) + theme(strip.text.x = element_text(face=&quot;bold&quot;, size=12)) + theme(strip.text.y = element_text(face=&quot;bold&quot;, size=12)) + labs(title=&quot;AG05&quot;,x=&quot;Hour&quot;, y=&quot;km/hr&quot;, tag=&quot;&quot;, colour = &quot;Height (m)&quot;) mw4 &lt;- mclim_TO04_CN01_2018 %&gt;% filter(month %in% c(9,10) &amp; time &gt; date(&#39;2018-09-05&#39;)) %&gt;% mutate(hm = as.POSIXct( paste(hr,minute,sep = &#39;:&#39;) , format = &quot;%H:%M&quot;)) %&gt;% mutate(hms = hms::as.hms(hm)) %&gt;% ggplot() + geom_smooth(method=&quot;loess&quot; ,aes(hms,windspeed4,color = &#39;0.3&#39;),span = 0.8,n=10) + geom_smooth(method=&quot;loess&quot; ,aes(hms,windspeed3,color = &#39;0.6&#39;),span = 0.8,n=10) + geom_smooth(method=&quot;loess&quot; ,aes(hms,windspeed2,color = &#39;0.9&#39;),span = 0.8,n=10) + geom_smooth(method=&quot;loess&quot; ,aes(hms,windspeed1,color = &#39;1.2&#39;),span = 0.8,n=10) + theme_minimal() + theme(legend.position=&quot;none&quot;, legend.background = element_rect(color = &quot;grey90&quot;, size = .5, linetype = &quot;dashed&quot;), axis.text.x=element_text(angle=45, hjust=1)) + theme(strip.text.x = element_text(face=&quot;bold&quot;, size=12)) + theme(strip.text.y = element_text(face=&quot;bold&quot;, size=12)) + labs(title=&quot;TO04&quot;,x=&quot;Hour&quot;, y=&quot;km/hr&quot;, tag=&quot;&quot;, colour = &quot;Height (m)&quot;) library(cowplot) main_row_wind_hms &lt;- plot_grid(mw1,mw2,mw3,mw4, align = &quot;v&quot;, nrow = 1) plot_grid(main_row_wind_hms ,nrow = 1) title &lt;- ggdraw() + draw_label(&quot;Wind conditions for MM sites understories&quot;, fontface=&#39;bold&#39;) plot_grid(title, main_row_wind_ts,main_row_wind_hr, main_row_wind_hms, nrow = 4, labels = c(&quot;&quot;, &quot;A&quot;,&quot;B&quot;, &quot;C&quot;), rel_heights = c(0.2, 1,.8, .8)) 8.40 3-3-2019 Temperature stability assessment, different heights i.e. vertically. First raw plots mw1 &lt;- mclim_AE10_CN01_2018 %&gt;% filter(month %in% c(9,10) &amp; time &gt; date(&#39;2018-09-05&#39;)) %&gt;% ggplot() + geom_line( aes(time,temp4,color = &#39;0.3&#39;)) + geom_line( aes(time,temp3,color = &#39;0.6&#39;)) + geom_line( aes(time,temp2,color = &#39;0.9&#39;)) + geom_line( aes(time,temp1,color = &#39;1.2&#39;)) + theme_minimal() + theme(legend.position = c(.1,.8), legend.background = element_rect(color = &quot;grey90&quot;, size = .5, linetype = &quot;dashed&quot;), axis.text.x=element_text(angle=45, hjust=1)) + theme(strip.text.x = element_text(face=&quot;bold&quot;, size=12)) + theme(strip.text.y = element_text(face=&quot;bold&quot;, size=12)) + scale_y_continuous(limits = c(-1,30 ),breaks = c(-1,5,10,15,20,25,30)) + labs(title=&quot;AE10&quot;,x=&quot;Date&quot;, y=&quot;Temperature(°C)&quot;, tag=&quot;&quot;, colour = &quot;Height (m)&quot;) mw2 &lt;- mclim_AM16_CN01_2018 %&gt;% filter(month %in% c(9,10) &amp; time &gt; date(&#39;2018-09-05&#39;)) %&gt;% ggplot() + geom_line( aes(time,temp4,color = &#39;0.3&#39;)) + geom_line( aes(time,temp3,color = &#39;0.6&#39;)) + geom_line( aes(time,temp2,color = &#39;0.9&#39;)) + geom_line( aes(time,temp1,color = &#39;1.2&#39;)) + theme_minimal() + theme(legend.position=&quot;none&quot;, legend.background = element_rect(color = &quot;grey90&quot;, size = .5, linetype = &quot;dashed&quot;), axis.text.x=element_text(angle=45, hjust=1)) + theme(strip.text.x = element_text(face=&quot;bold&quot;, size=12)) + theme(strip.text.y = element_text(face=&quot;bold&quot;, size=12)) + scale_y_continuous(limits = c(-1,30 ),breaks = c(-1,5,10,15,20,25,30)) + labs(title=&quot;AM16&quot;,x=&quot;Date&quot;, y=&quot;Temperature(°C)&quot;, tag=&quot;&quot;, colour = &quot;Height (m)&quot;) mw3 &lt;- mclim_AG05_CN01_2018 %&gt;% filter(month %in% c(9,10) &amp; time &gt; date(&#39;2018-09-05&#39;)) %&gt;% ggplot() + geom_line( aes(time,temp4,color = &#39;0.3&#39;)) + geom_line( aes(time,temp3,color = &#39;0.6&#39;)) + geom_line( aes(time,temp2,color = &#39;0.9&#39;)) + geom_line( aes(time,temp1,color = &#39;1.2&#39;)) + theme_minimal() + ylim(0,4) + theme(legend.position=&quot;none&quot;, legend.background = element_rect(color = &quot;grey90&quot;, size = .5, linetype = &quot;dashed&quot;), axis.text.x=element_text(angle=45, hjust=1)) + theme(strip.text.x = element_text(face=&quot;bold&quot;, size=12)) + theme(strip.text.y = element_text(face=&quot;bold&quot;, size=12)) + scale_y_continuous(limits = c(-1,30 ),breaks = c(-1,5,10,15,20,25,30)) + labs(title=&quot;AG05&quot;,x=&quot;Date&quot;, y=&quot;km/hr&quot;, tag=&quot;&quot;, colour = &quot;Height (m)&quot;) ## Scale for &#39;y&#39; is already present. Adding another scale for &#39;y&#39;, which ## will replace the existing scale. mw4 &lt;- mclim_TO04_CN01_2018 %&gt;% filter(month %in% c(9,10) &amp; time &gt; date(&#39;2018-09-05&#39;)) %&gt;% ggplot() + geom_line( aes(time,temp4,color = &#39;0.3&#39;)) + geom_line( aes(time,temp3,color = &#39;0.6&#39;)) + geom_line( aes(time,temp2,color = &#39;0.9&#39;)) + geom_line( aes(time,temp1,color = &#39;1.2&#39;)) + theme_minimal() + theme(legend.position=&quot;none&quot;, legend.background = element_rect(color = &quot;grey90&quot;, size = .5, linetype = &quot;dashed&quot;), axis.text.x=element_text(angle=45, hjust=1)) + theme(strip.text.x = element_text(face=&quot;bold&quot;, size=12)) + theme(strip.text.y = element_text(face=&quot;bold&quot;, size=12)) + scale_y_continuous(limits = c(-1,30 ),breaks = c(-1,5,10,15,20,25,30)) + labs(title=&quot;TO04&quot;,x=&quot;Date&quot;, y=&quot;Temperature(°C)&quot;, tag=&quot;&quot;, colour = &quot;Height (m)&quot;) library(cowplot) main_row_temp_ts &lt;- plot_grid(mw1,mw2,mw3,mw4, align = &quot;v&quot;, nrow = 1) plot_grid(main_row_temp_ts ,nrow = 1) Diel variation by height (dots) mw1 &lt;- mclim_AE10_CN01_2018 %&gt;% filter(month %in% c(9,10) &amp; time &gt; date(&#39;2018-09-05&#39;)) %&gt;% dplyr::group_by(month,day) %&gt;% dplyr::summarise(mtpoint3 = max(temp4) - min(temp4), mtpoint6 = max(temp3) - min(temp3), mtpoint9 = max(temp2) - min(temp2), mtpoint12 = max(temp1) - min(temp1)) %&gt;% mutate(md = as.POSIXct( paste(month,day,sep = &#39;-&#39;) , format = &quot;%m-%d&quot;)) %&gt;% ggplot() + geom_point( aes(md,mtpoint3,color = &#39;0.3&#39;)) + geom_point( aes(md,mtpoint6,color = &#39;0.6&#39;)) + geom_point( aes(md,mtpoint9,color = &#39;0.9&#39;)) + geom_point( aes(md,mtpoint12,color = &#39;1.2&#39;)) + theme_minimal() + theme(legend.position = c(.1,.8), legend.background = element_rect(color = &quot;grey90&quot;, size = .5, linetype = &quot;dashed&quot;), axis.text.x=element_text(angle=45, hjust=1)) + theme(strip.text.x = element_text(face=&quot;bold&quot;, size=12)) + theme(strip.text.y = element_text(face=&quot;bold&quot;, size=12)) + scale_y_continuous(limits = c(-1,30 ),breaks = c(-1,5,10,15,20,25,30)) + labs(title=&quot;AE10&quot;,x=&quot;Date&quot;, y=&quot;Temperature(°C)&quot;, tag=&quot;&quot;, colour = &quot;Height (m)&quot;) mw2 &lt;- mclim_AM16_CN01_2018 %&gt;% filter(month %in% c(9,10) &amp; time &gt; date(&#39;2018-09-05&#39;)) %&gt;% dplyr::group_by(month,day) %&gt;% dplyr::summarise(mtpoint3 = max(temp4) - min(temp4), mtpoint6 = max(temp3) - min(temp3), mtpoint9 = max(temp2) - min(temp2), mtpoint12 = max(temp1) - min(temp1)) %&gt;% mutate(md = as.POSIXct( paste(month,day,sep = &#39;-&#39;) , format = &quot;%m-%d&quot;)) %&gt;% ggplot() + geom_point( aes(md,mtpoint3,color = &#39;0.3&#39;)) + geom_point( aes(md,mtpoint6,color = &#39;0.6&#39;)) + geom_point( aes(md,mtpoint9,color = &#39;0.9&#39;)) + geom_point( aes(md,mtpoint12,color = &#39;1.2&#39;)) + theme_minimal() + theme(legend.position=&quot;none&quot;, legend.background = element_rect(color = &quot;grey90&quot;, size = .5, linetype = &quot;dashed&quot;), axis.text.x=element_text(angle=45, hjust=1)) + theme(strip.text.x = element_text(face=&quot;bold&quot;, size=12)) + theme(strip.text.y = element_text(face=&quot;bold&quot;, size=12)) + scale_y_continuous(limits = c(-1,30 ),breaks = c(-1,5,10,15,20,25,30)) + labs(title=&quot;AM16&quot;,x=&quot;Date&quot;, y=&quot;Temperature(°C)&quot;, tag=&quot;&quot;, colour = &quot;Height (m)&quot;) mw3 &lt;- mclim_AG05_CN01_2018 %&gt;% filter(month %in% c(9,10) &amp; time &gt; date(&#39;2018-09-05&#39;)) %&gt;% dplyr::group_by(month,day) %&gt;% dplyr::summarise(mtpoint3 = max(temp4) - min(temp4), mtpoint6 = max(temp3) - min(temp3), mtpoint9 = max(temp2) - min(temp2), mtpoint12 = max(temp1) - min(temp1)) %&gt;% mutate(md = as.POSIXct( paste(month,day,sep = &#39;-&#39;) , format = &quot;%m-%d&quot;)) %&gt;% ggplot() + geom_point( aes(md,mtpoint3,color = &#39;0.3&#39;)) + geom_point( aes(md,mtpoint6,color = &#39;0.6&#39;)) + geom_point( aes(md,mtpoint9,color = &#39;0.9&#39;)) + geom_point( aes(md,mtpoint12,color = &#39;1.2&#39;)) + theme_minimal() + ylim(0,4) + theme(legend.position=&quot;none&quot;, legend.background = element_rect(color = &quot;grey90&quot;, size = .5, linetype = &quot;dashed&quot;), axis.text.x=element_text(angle=45, hjust=1)) + theme(strip.text.x = element_text(face=&quot;bold&quot;, size=12)) + theme(strip.text.y = element_text(face=&quot;bold&quot;, size=12)) + scale_y_continuous(limits = c(-1,30 ),breaks = c(-1,5,10,15,20,25,30)) + labs(title=&quot;AG05&quot;,x=&quot;Date&quot;, y=&quot;km/hr&quot;, tag=&quot;&quot;, colour = &quot;Height (m)&quot;) ## Scale for &#39;y&#39; is already present. Adding another scale for &#39;y&#39;, which ## will replace the existing scale. mw4 &lt;- mclim_TO04_CN01_2018 %&gt;% filter(month %in% c(9,10) &amp; time &gt; date(&#39;2018-09-05&#39;)) %&gt;% dplyr::group_by(month,day) %&gt;% dplyr::summarise(mtpoint3 = max(temp4) - min(temp4), mtpoint6 = max(temp3) - min(temp3), mtpoint9 = max(temp2) - min(temp2), mtpoint12 = max(temp1) - min(temp1)) %&gt;% mutate(md = as.POSIXct( paste(month,day,sep = &#39;-&#39;) , format = &quot;%m-%d&quot;)) %&gt;% ggplot() + geom_point( aes(md,mtpoint3,color = &#39;0.3&#39;)) + geom_point( aes(md,mtpoint6,color = &#39;0.6&#39;)) + geom_point( aes(md,mtpoint9,color = &#39;0.9&#39;)) + geom_point( aes(md,mtpoint12,color = &#39;1.2&#39;)) + theme_minimal() + theme(legend.position=&quot;none&quot;, legend.background = element_rect(color = &quot;grey90&quot;, size = .5, linetype = &quot;dashed&quot;), axis.text.x=element_text(angle=45, hjust=1)) + theme(strip.text.x = element_text(face=&quot;bold&quot;, size=12)) + theme(strip.text.y = element_text(face=&quot;bold&quot;, size=12)) + scale_y_continuous(limits = c(-1,30 ),breaks = c(-1,5,10,15,20,25,30)) + labs(title=&quot;TO04&quot;,x=&quot;Date&quot;, y=&quot;Temperature(°C)&quot;, tag=&quot;&quot;, colour = &quot;Height (m)&quot;) library(cowplot) main_row_temp_ts &lt;- plot_grid(mw1,mw2,mw3,mw4, align = &quot;v&quot;, nrow = 1) plot_grid(main_row_temp_ts ,nrow = 1) Add lines mw1 &lt;- mclim_AE10_CN01_2018 %&gt;% filter(month %in% c(9,10) &amp; time &gt; date(&#39;2018-09-05&#39;)) %&gt;% dplyr::group_by(month,day) %&gt;% dplyr::summarise(mtpoint3 = max(temp4) - min(temp4), mtpoint6 = max(temp3) - min(temp3), mtpoint9 = max(temp2) - min(temp2), mtpoint12 = max(temp1) - min(temp1)) %&gt;% mutate(md = as.POSIXct( paste(month,day,sep = &#39;-&#39;) , format = &quot;%m-%d&quot;)) %&gt;% ggplot() + geom_line( aes(md,mtpoint3,color = &#39;0.3&#39;)) + geom_line( aes(md,mtpoint6,color = &#39;0.6&#39;)) + geom_line( aes(md,mtpoint9,color = &#39;0.9&#39;)) + geom_line( aes(md,mtpoint12,color = &#39;1.2&#39;)) + theme_minimal() + theme(legend.position = c(.1,.8), legend.background = element_rect(color = &quot;grey90&quot;, size = .5, linetype = &quot;dashed&quot;), axis.text.x=element_text(angle=45, hjust=1)) + theme(strip.text.x = element_text(face=&quot;bold&quot;, size=12)) + theme(strip.text.y = element_text(face=&quot;bold&quot;, size=12)) + scale_y_continuous(limits = c(-1,30 ),breaks = c(-1,5,10,15,20,25,30)) + labs(title=&quot;AE10&quot;,x=&quot;Date&quot;, y=&quot;Temperature(°C)&quot;, tag=&quot;&quot;, colour = &quot;Height (m)&quot;) mw2 &lt;- mclim_AM16_CN01_2018 %&gt;% filter(month %in% c(9,10) &amp; time &gt; date(&#39;2018-09-05&#39;)) %&gt;% dplyr::group_by(month,day) %&gt;% dplyr::summarise(mtpoint3 = max(temp4) - min(temp4), mtpoint6 = max(temp3) - min(temp3), mtpoint9 = max(temp2) - min(temp2), mtpoint12 = max(temp1) - min(temp1)) %&gt;% mutate(md = as.POSIXct( paste(month,day,sep = &#39;-&#39;) , format = &quot;%m-%d&quot;)) %&gt;% ggplot() + geom_line( aes(md,mtpoint3,color = &#39;0.3&#39;)) + geom_line( aes(md,mtpoint6,color = &#39;0.6&#39;)) + geom_line( aes(md,mtpoint9,color = &#39;0.9&#39;)) + geom_line( aes(md,mtpoint12,color = &#39;1.2&#39;)) + theme_minimal() + theme(legend.position=&quot;none&quot;, legend.background = element_rect(color = &quot;grey90&quot;, size = .5, linetype = &quot;dashed&quot;), axis.text.x=element_text(angle=45, hjust=1)) + theme(strip.text.x = element_text(face=&quot;bold&quot;, size=12)) + theme(strip.text.y = element_text(face=&quot;bold&quot;, size=12)) + scale_y_continuous(limits = c(-1,30 ),breaks = c(-1,5,10,15,20,25,30)) + labs(title=&quot;AM16&quot;,x=&quot;Date&quot;, y=&quot;Temperature(°C)&quot;, tag=&quot;&quot;, colour = &quot;Height (m)&quot;) mw3 &lt;- mclim_AG05_CN01_2018 %&gt;% filter(month %in% c(9,10) &amp; time &gt; date(&#39;2018-09-05&#39;)) %&gt;% dplyr::group_by(month,day) %&gt;% dplyr::summarise(mtpoint3 = max(temp4) - min(temp4), mtpoint6 = max(temp3) - min(temp3), mtpoint9 = max(temp2) - min(temp2), mtpoint12 = max(temp1) - min(temp1)) %&gt;% mutate(md = as.POSIXct( paste(month,day,sep = &#39;-&#39;) , format = &quot;%m-%d&quot;)) %&gt;% ggplot() + geom_line( aes(md,mtpoint3,color = &#39;0.3&#39;)) + geom_line( aes(md,mtpoint6,color = &#39;0.6&#39;)) + geom_line( aes(md,mtpoint9,color = &#39;0.9&#39;)) + geom_line( aes(md,mtpoint12,color = &#39;1.2&#39;)) + theme_minimal() + ylim(0,4) + theme(legend.position=&quot;none&quot;, legend.background = element_rect(color = &quot;grey90&quot;, size = .5, linetype = &quot;dashed&quot;), axis.text.x=element_text(angle=45, hjust=1)) + theme(strip.text.x = element_text(face=&quot;bold&quot;, size=12)) + theme(strip.text.y = element_text(face=&quot;bold&quot;, size=12)) + scale_y_continuous(limits = c(-1,30 ),breaks = c(-1,5,10,15,20,25,30)) + labs(title=&quot;AG05&quot;,x=&quot;Date&quot;, y=&quot;km/hr&quot;, tag=&quot;&quot;, colour = &quot;Height (m)&quot;) ## Scale for &#39;y&#39; is already present. Adding another scale for &#39;y&#39;, which ## will replace the existing scale. mw4 &lt;- mclim_TO04_CN01_2018 %&gt;% filter(month %in% c(9,10) &amp; time &gt; date(&#39;2018-09-05&#39;)) %&gt;% dplyr::group_by(month,day) %&gt;% dplyr::summarise(mtpoint3 = max(temp4) - min(temp4), mtpoint6 = max(temp3) - min(temp3), mtpoint9 = max(temp2) - min(temp2), mtpoint12 = max(temp1) - min(temp1)) %&gt;% mutate(md = as.POSIXct( paste(month,day,sep = &#39;-&#39;) , format = &quot;%m-%d&quot;)) %&gt;% ggplot() + geom_line( aes(md,mtpoint3,color = &#39;0.3&#39;)) + geom_line( aes(md,mtpoint6,color = &#39;0.6&#39;)) + geom_line( aes(md,mtpoint9,color = &#39;0.9&#39;)) + geom_line( aes(md,mtpoint12,color = &#39;1.2&#39;)) + theme_minimal() + theme(legend.position=&quot;none&quot;, legend.background = element_rect(color = &quot;grey90&quot;, size = .5, linetype = &quot;dashed&quot;), axis.text.x=element_text(angle=45, hjust=1)) + theme(strip.text.x = element_text(face=&quot;bold&quot;, size=12)) + theme(strip.text.y = element_text(face=&quot;bold&quot;, size=12)) + scale_y_continuous(limits = c(-1,30 ),breaks = c(-1,5,10,15,20,25,30)) + labs(title=&quot;TO04&quot;,x=&quot;Date&quot;, y=&quot;Temperature(°C)&quot;, tag=&quot;&quot;, colour = &quot;Height (m)&quot;) library(cowplot) main_row_temp_ts &lt;- plot_grid(mw1,mw2,mw3,mw4, align = &quot;v&quot;, nrow = 1) plot_grid(main_row_temp_ts ,nrow = 1) Quantify it elevation with mw11 &lt;- mclim_AE10_CN01_2018 %&gt;% filter(month %in% c(9,10) &amp; time &gt; date(&#39;2018-09-05&#39;)) %&gt;% dplyr::group_by(month,day) %&gt;% dplyr::summarise(mtpoint3 = max(temp4) - min(temp4), mtpoint6 = max(temp3) - min(temp3), mtpoint9 = max(temp2) - min(temp2), mtpoint12 = max(temp1) - min(temp1)) %&gt;% mutate(md = as.POSIXct( paste(month,day,sep = &#39;-&#39;) , format = &quot;%m-%d&quot;)) %&gt;% mutate(elevation = 1450 ) %&gt;% dplyr::select(c(&#39;mtpoint3&#39;,&#39;mtpoint6&#39;,&#39;mtpoint9&#39;,&#39;mtpoint12&#39;,&#39;elevation&#39;)) %&gt;% as.data.frame() ## Adding missing grouping variables: `month` mw21 &lt;- mclim_AM16_CN01_2018 %&gt;% filter(month %in% c(9,10) &amp; time &gt; date(&#39;2018-09-05&#39;)) %&gt;% dplyr::group_by(month,day) %&gt;% dplyr::summarise(mtpoint3 = max(temp4) - min(temp4), mtpoint6 = max(temp3) - min(temp3), mtpoint9 = max(temp2) - min(temp2), mtpoint12 = max(temp1) - min(temp1)) %&gt;% mutate(md = as.POSIXct( paste(month,day,sep = &#39;-&#39;) , format = &quot;%m-%d&quot;)) %&gt;% mutate(elevation = 1200 ) %&gt;% dplyr::select(c(&#39;mtpoint3&#39;,&#39;mtpoint6&#39;,&#39;mtpoint9&#39;,&#39;mtpoint12&#39;,&#39;elevation&#39;)) %&gt;% as.data.frame() ## Adding missing grouping variables: `month` mw31 &lt;- mclim_AG05_CN01_2018 %&gt;% filter(month %in% c(9,10) &amp; time &gt; date(&#39;2018-09-05&#39;)) %&gt;% dplyr::group_by(month,day) %&gt;% dplyr::summarise(mtpoint3 = max(temp4) - min(temp4), mtpoint6 = max(temp3) - min(temp3), mtpoint9 = max(temp2) - min(temp2), mtpoint12 = max(temp1) - min(temp1)) %&gt;% mutate(md = as.POSIXct( paste(month,day,sep = &#39;-&#39;) , format = &quot;%m-%d&quot;)) %&gt;% mutate(elevation = 900 ) %&gt;% dplyr::select(c(&#39;mtpoint3&#39;,&#39;mtpoint6&#39;,&#39;mtpoint9&#39;,&#39;mtpoint12&#39;,&#39;elevation&#39;)) %&gt;% as.data.frame() ## Adding missing grouping variables: `month` mw41 &lt;- mclim_TO04_CN01_2018 %&gt;% filter(month %in% c(9,10) &amp; time &gt; date(&#39;2018-09-05&#39;)) %&gt;% dplyr::group_by(month,day) %&gt;% filter(temp4 != -127 &amp; temp1 != -127 &amp; temp3 != -127 &amp; temp2 != -127) %&gt;% dplyr::summarise(mtpoint3 = max(temp4) - min(temp4), mtpoint6 = max(temp3) - min(temp3), mtpoint9 = max(temp2) - min(temp2), mtpoint12 = max(temp1) - min(temp1)) %&gt;% mutate(md = as.POSIXct( paste(month,day,sep = &#39;-&#39;) , format = &quot;%m-%d&quot;)) %&gt;% mutate(elevation = 680 ) %&gt;% dplyr::select(c(&#39;mtpoint3&#39;,&#39;mtpoint6&#39;,&#39;mtpoint9&#39;,&#39;mtpoint12&#39;,&#39;elevation&#39;)) %&gt;% as.data.frame() ## Adding missing grouping variables: `month` mwdveleva &lt;- rbind(mw11,mw21,mw31,mw41) library(reshape2) ## ## Attaching package: &#39;reshape2&#39; ## The following object is masked from &#39;package:tidyr&#39;: ## ## smiths mwdvelevamd &lt;- melt(mwdveleva, id.vars = c(&quot;month&quot;, &quot;elevation&quot;)) data_summary &lt;- function(data, varname, groupnames){ require(plyr) summary_func &lt;- function(x, col){ c(mean = mean(x[[col]], na.rm=TRUE), sd = sd(x[[col]], na.rm=TRUE)) } data_sum&lt;-ddply(data, groupnames, .fun=summary_func, varname) data_sum &lt;- rename(data_sum, c(&quot;mean&quot; = varname)) return(data_sum) } df2 &lt;- data_summary(mwdvelevamd, varname=&quot;value&quot;, groupnames=c(&quot;variable&quot;, &quot;elevation&quot;)) ## Loading required package: plyr ## ------------------------------------------------------------------------- ## You have loaded plyr after dplyr - this is likely to cause problems. ## If you need functions from both plyr and dplyr, please load plyr first, then dplyr: ## library(plyr); library(dplyr) ## ------------------------------------------------------------------------- ## ## Attaching package: &#39;plyr&#39; ## The following object is masked from &#39;package:ggpubr&#39;: ## ## mutate ## The following objects are masked from &#39;package:plotly&#39;: ## ## arrange, mutate, rename, summarise ## The following object is masked from &#39;package:lubridate&#39;: ## ## here ## The following objects are masked from &#39;package:dplyr&#39;: ## ## arrange, count, desc, failwith, id, mutate, rename, summarise, ## summarize ## The following object is masked from &#39;package:purrr&#39;: ## ## compact p&lt;- ggplot(df2, aes(x=elevation, y=value, group=variable, color=variable)) + geom_line() + geom_point()+ geom_errorbar(aes(ymin=value-sd, ymax=value+sd), width=.2, position=position_dodge(0.05)) print(p) TO elevation looks funny, lets do selective days mw11 &lt;- mclim_AE10_CN01_2018 %&gt;% filter(month %in% c(9,10) &amp; time &gt; date(&#39;2018-09-05&#39;)) %&gt;% dplyr::filter(day %in% c(15:20,c(7:10))) %&gt;% dplyr::group_by(month,day) %&gt;% dplyr::summarise(mtpoint3 = max(temp4) - min(temp4), mtpoint6 = max(temp3) - min(temp3), mtpoint9 = max(temp2) - min(temp2), mtpoint12 = max(temp1) - min(temp1)) %&gt;% mutate(md = as.POSIXct( paste(month,day,sep = &#39;-&#39;) , format = &quot;%m-%d&quot;)) %&gt;% mutate(elevation = 1450 ) %&gt;% dplyr::select(c(&#39;mtpoint3&#39;,&#39;mtpoint6&#39;,&#39;mtpoint9&#39;,&#39;mtpoint12&#39;,&#39;elevation&#39;)) %&gt;% as.data.frame() ## Adding missing grouping variables: `month` mw21 &lt;- mclim_AM16_CN01_2018 %&gt;% filter(month %in% c(9,10) &amp; time &gt; date(&#39;2018-09-05&#39;)) %&gt;% dplyr::filter(day %in% c(15:20,c(7:10))) %&gt;% dplyr::group_by(month,day) %&gt;% dplyr::summarise(mtpoint3 = max(temp4) - min(temp4), mtpoint6 = max(temp3) - min(temp3), mtpoint9 = max(temp2) - min(temp2), mtpoint12 = max(temp1) - min(temp1)) %&gt;% mutate(md = as.POSIXct( paste(month,day,sep = &#39;-&#39;) , format = &quot;%m-%d&quot;)) %&gt;% mutate(elevation = 1200 ) %&gt;% dplyr::select(c(&#39;mtpoint3&#39;,&#39;mtpoint6&#39;,&#39;mtpoint9&#39;,&#39;mtpoint12&#39;,&#39;elevation&#39;)) %&gt;% as.data.frame() ## Adding missing grouping variables: `month` mw31 &lt;- mclim_AG05_CN01_2018 %&gt;% filter(month %in% c(9,10) &amp; time &gt; date(&#39;2018-09-05&#39;)) %&gt;% dplyr::filter(day %in% c(15:20,c(7:10))) %&gt;% dplyr::group_by(month,day) %&gt;% dplyr::summarise(mtpoint3 = max(temp4) - min(temp4), mtpoint6 = max(temp3) - min(temp3), mtpoint9 = max(temp2) - min(temp2), mtpoint12 = max(temp1) - min(temp1)) %&gt;% mutate(md = as.POSIXct( paste(month,day,sep = &#39;-&#39;) , format = &quot;%m-%d&quot;)) %&gt;% mutate(elevation = 900 ) %&gt;% dplyr::select(c(&#39;mtpoint3&#39;,&#39;mtpoint6&#39;,&#39;mtpoint9&#39;,&#39;mtpoint12&#39;,&#39;elevation&#39;)) %&gt;% as.data.frame() ## Adding missing grouping variables: `month` mw41 &lt;- mclim_TO04_CN01_2018 %&gt;% filter(month %in% c(9,10) &amp; time &gt; date(&#39;2018-09-05&#39;)) %&gt;% dplyr::filter(day %in% c(15:20,c(7:10))) %&gt;% filter(temp4 != -127 &amp; temp1 != -127 &amp; temp3 != -127 &amp; temp2 != -127) %&gt;% dplyr::group_by(month,day) %&gt;% dplyr::summarise(mtpoint3 = max(temp4,na.rm = TRUE) - min(temp4,na.rm = TRUE), mtpoint6 = max(temp3,na.rm = TRUE) - min(temp3,na.rm = TRUE), mtpoint9 = max(temp2,na.rm = TRUE) - min(temp2,na.rm = TRUE), mtpoint12 = max(temp1,na.rm = TRUE) - min(temp1,na.rm = TRUE)) %&gt;% mutate(md = as.POSIXct( paste(month,day,sep = &#39;-&#39;) , format = &quot;%m-%d&quot;)) %&gt;% mutate(elevation = 680 ) %&gt;% dplyr::select(c(&#39;mtpoint3&#39;,&#39;mtpoint6&#39;,&#39;mtpoint9&#39;,&#39;mtpoint12&#39;,&#39;elevation&#39;)) %&gt;% as.data.frame() ## Adding missing grouping variables: `month` mwdveleva &lt;- rbind(mw11,mw21,mw31,mw41) library(reshape2) mwdvelevamd &lt;- melt(mwdveleva, id.vars = c(&quot;month&quot;, &quot;elevation&quot;)) data_summary &lt;- function(data, varname, groupnames){ require(plyr) summary_func &lt;- function(x, col){ c(mean = mean(x[[col]], na.rm=TRUE), sd = sd(x[[col]], na.rm=TRUE)) } data_sum&lt;-ddply(data, groupnames, .fun=summary_func, varname) data_sum &lt;- rename(data_sum, c(&quot;mean&quot; = varname)) return(data_sum) } df2 &lt;- data_summary(mwdvelevamd, varname=&quot;value&quot;, groupnames=c(&quot;variable&quot;, &quot;elevation&quot;)) p&lt;- ggplot(df2, aes(x=elevation, y=value, group=variable, color=variable)) + geom_line() + geom_point()+ geom_errorbar(aes(ymin=value-sd, ymax=value+sd), width=.9, position=position_dodge(0.05)) + scale_color_manual(&quot;Height from ground (m)&quot;, labels = c(&quot;.3&quot;, &quot;.6&quot;,&quot;.9&quot;,&quot;1.2&quot;), values=c(&quot;mtpoint3&quot;=1,&quot;mtpoint6&quot;=2,&quot;mtpoint9&quot;=3,&quot;mtpoint12&quot;=4)) + labs(title=&quot;Thermal stability&quot;,x=&quot;Elevation (m)&quot;, y=&quot;Temperature(°C)&quot;, tag=&quot;&quot;, colour = &quot;Height (m)&quot;) print(p) Skip first elevation and see df2 %&gt;% dplyr::filter(elevation &gt; 800) %&gt;% ggplot( aes(x=elevation, y=value, group=variable, color=variable)) + geom_line() + geom_point()+ geom_errorbar(aes(ymin=value-sd, ymax=value+sd), width=.2, position=position_dodge(0.1)) 8.41 3-9-2019 Lets not calculate the SE ggplot(mwdvelevamd, aes(elevation, value, fill=variable)) + stat_summary(geom = &quot;bar&quot;, fun.y = mean, position = &quot;dodge&quot;) + stat_summary(geom = &quot;errorbar&quot;, fun.data = mean_se, position = &quot;dodge&quot;) + scale_fill_manual(&quot;Height from ground (m)&quot;, labels = c(&quot;.3&quot;, &quot;.6&quot;,&quot;.9&quot;,&quot;1.2&quot;), values=c(&quot;mtpoint3&quot;=1,&quot;mtpoint6&quot;=2,&quot;mtpoint9&quot;=3,&quot;mtpoint12&quot;=4)) + labs(title=&quot;Thermal stability&quot;,x=&quot;Elevation (m)&quot;, y=&quot;Temperature(°C)&quot;, tag=&quot;&quot;, colour = &quot;Height (m)&quot;) pdata &lt;- mwdvelevamd %&gt;% dplyr::group_by(elevation, variable) %&gt;% dplyr::summarise(new = list(mean_se(value))) %&gt;% unnest(new) pdata %&gt;% ggplot(aes(elevation, y = y, fill = variable)) + geom_col(position = &quot;dodge&quot;) + geom_errorbar(aes(ymin = ymin, ymax = ymax), position = &quot;dodge&quot;) + scale_fill_manual(&quot;Height from ground (m)&quot;, labels = c(&quot;.3&quot;, &quot;.6&quot;,&quot;.9&quot;,&quot;1.2&quot;), values=c(&quot;mtpoint3&quot;=1,&quot;mtpoint6&quot;=2,&quot;mtpoint9&quot;=3,&quot;mtpoint12&quot;=4) ) + labs(title=&quot;Thermal stability&quot;,x=&quot;Elevation (m)&quot;, y=&quot;Temperature(°C)&quot;, tag=&quot;&quot;, colour = &quot;Height (m)&quot;) So, we agree, at least in gaps we have stability increases by height from the ground. facet_grid(. ~ day, scales = “free”) levels(pdata$elevation) &lt;- c(&quot;680m&quot;, &quot;900m&quot;, &quot;1200m&quot;,&quot;1450m&quot;) pdata %&gt;% ggplot(aes(elevation, y = y, fill = variable)) + geom_col(position = &quot;dodge&quot;) + geom_errorbar(aes(ymin = ymin, ymax = ymax), position = &quot;dodge&quot;) + facet_grid(. ~ elevation, scales = &quot;free&quot;) + scale_fill_manual(&quot;Height from ground (m)&quot;, labels = c(&quot;.3&quot;, &quot;.6&quot;,&quot;.9&quot;,&quot;1.2&quot;), values=c(&quot;mtpoint3&quot;=1,&quot;mtpoint6&quot;=2,&quot;mtpoint9&quot;=3,&quot;mtpoint12&quot;=4) ) + labs(title=&quot;Thermal stability&quot;,x=&quot;Elevation (m)&quot;, y=&quot;Diel variation(°C)&quot;, tag=&quot;&quot;, colour = &quot;Height (m)&quot;) + theme(axis.title.x=element_blank(), axis.text.x=element_blank(), axis.ticks.x=element_blank()) 8.42 3-10-2019 Could we explore if there is alinear relationship, why ? because temp and elevation has a linear relationship dpata &lt;- pdata dpata$height &lt;- 0 dpata[dpata$variable==&#39;mtpoint3&#39;,]$height&lt;- 0.3 dpata[dpata$variable==&#39;mtpoint6&#39;,]$height&lt;- 0.6 dpata[dpata$variable==&#39;mtpoint9&#39;,]$height = 0.9 dpata[dpata$variable==&#39;mtpoint12&#39;,]$height = 1.2 reg &lt;- lm(y ~ elevation + height,data=dpata) summary(reg) ## ## Call: ## lm(formula = y ~ elevation + height, data = dpata) ## ## Residuals: ## Min 1Q Median 3Q Max ## -1.8394 -0.5185 0.2689 0.5435 1.4804 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 7.0309504 1.0545024 6.668 1.55e-05 *** ## elevation -0.0019109 0.0008257 -2.314 0.0377 * ## height -0.6461513 0.7195237 -0.898 0.3855 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 0.9653 on 13 degrees of freedom ## Multiple R-squared: 0.3216, Adjusted R-squared: 0.2172 ## F-statistic: 3.081 on 2 and 13 DF, p-value: 0.08031 So, looks like my prediction is supported, only partially, the elevation does seem to influence diel variation , it makes sense, less vegetation ? or more so, change in the understory cover ? Lets visualize the plot dpata %&gt;% ggplot(aes(elevation,y,color=as.factor(height))) + geom_point() + labs(title=&quot;Thermal stability&quot;,x=&quot;Elevation (m)&quot;, y=&quot;Diel variation(°C)&quot;, tag=&quot;&quot;, colour = &quot;Height (m)&quot;) 8.43 3-12-2019 Gap and Non- gap analysis #Combine all the nodes All_sites &lt;- rbind(mclim_AE10_2018_ZTemp, mclim_AG05_2018_ZTemp, mclim_AM16_2018_ZTemp, mclim_TO04_2018_ZTemp) All_sites_odata &lt;- All_sites %&gt;% dplyr::group_by(site, height) %&gt;% dplyr::summarise(new = list(mean_se(temp))) %&gt;% unnest(new) All_sites_odata$elevation &lt;- 0 All_sites_odata[All_sites_odata$site == &#39;TO04_TN01&#39;,]$elevation&lt;- 680 All_sites_odata[All_sites_odata$site == &#39;TO04_TN02&#39;,]$elevation&lt;- 680 All_sites_odata[All_sites_odata$site == &#39;TO04_TN03&#39;,]$elevation&lt;- 680 All_sites_odata[All_sites_odata$site == &#39;AG05_TN01&#39;,]$elevation&lt;- 900 All_sites_odata[All_sites_odata$site == &#39;AG05_TN02&#39;,]$elevation&lt;- 900 All_sites_odata[All_sites_odata$site == &#39;AG05_TN03&#39;,]$elevation&lt;- 900 All_sites_odata[All_sites_odata$site == &#39;AM16_TN01&#39;,]$elevation&lt;- 1200 All_sites_odata[All_sites_odata$site == &#39;AM16_TN02&#39;,]$elevation&lt;- 1200 All_sites_odata[All_sites_odata$site == &#39;AM16_TN03&#39;,]$elevation&lt;- 1200 All_sites_odata[All_sites_odata$site == &#39;AE10_TN01&#39;,]$elevation&lt;- 1450 All_sites_odata[All_sites_odata$site == &#39;AE10_TN02&#39;,]$elevation&lt;- 1450 All_sites_odata[All_sites_odata$site == &#39;AE10_TN03&#39;,]$elevation&lt;- 1450 All_sites_odata$site&lt;- factor(All_sites_odata$site, levels = c(&quot;TO04_TN01&quot;, &quot;TO04_TN02&quot;, &quot;TO04_TN03&quot;, &quot;AG05_TN01&quot; , &quot;AG05_TN02&quot; ,&quot;AG05_TN03&quot;, &quot;AM16_TN01&quot;, &quot;AM16_TN02&quot;, &quot;AM16_TN03&quot;, &quot;AE10_TN01&quot;, &quot;AE10_TN02&quot; ,&quot;AE10_TN03&quot; )) All_sites_odata %&gt;% mutate(hc = as.factor(height)) %&gt;% dplyr::filter(height &gt; 0) %&gt;% dplyr::filter(y &gt; -20) %&gt;% ggplot(aes(site, y = y, fill = hc)) + geom_col(position = &quot;dodge&quot;) + facet_grid(. ~ elevation, scales = &quot;free&quot;) + theme_minimal() + theme( legend.background = element_rect(color = &quot;grey90&quot;, size = .5, linetype = &quot;dashed&quot;), axis.text.x=element_text(angle=45, hjust=1)) + geom_errorbar(aes(ymin = ymin, ymax = ymax), position = &quot;dodge&quot;) + scale_fill_manual(&quot;Height from ground (m)&quot;, labels = c(&quot;0.3&quot;, &quot;0.6&quot;,&quot;0.9&quot;,&quot;1.2&quot;), values=c(&quot;0.3&quot;=1,&quot;0.6&quot;=2,&quot;0.9&quot;=3,&quot;1.2&quot;=4) ) + labs(title=&quot;Variability of temperatures in the understories&quot;,x=&quot;Site&quot;, y=&quot;Temperature(°C)&quot;, tag=&quot;&quot;, colour = &quot;Height (m)&quot;) Alternate, explore how it varies with in a site All_sites_odata %&gt;% mutate(hc = log(height)) %&gt;% dplyr::filter(height &gt; 0) %&gt;% dplyr::filter(y &gt; -20) %&gt;% ggplot(aes(x=y, y = height)) + geom_point() + geom_smooth(method = &#39;lm&#39;, se = FALSE) + facet_grid(. ~ site, scales = &quot;free&quot;) + theme_minimal() + theme( legend.background = element_rect(color = &quot;grey90&quot;, size = .5, linetype = &quot;dashed&quot;), axis.text.x=element_text(angle=45, hjust=1)) + labs(title=&quot;Variability of temperatures in the understories with height&quot;,y=&quot;Height (m)&quot;, x=&quot;Temperature(°C)&quot;, tag=&quot;&quot;, colour = &quot;&quot;) Maybe what we need is pure profiles of day and night Day - inversion, Night -lapse Lets look at one dayfirst All_sites$site&lt;- factor(All_sites$site, levels = c(&quot;TO04_TN01&quot;, &quot;TO04_TN02&quot;, &quot;TO04_TN03&quot;, &quot;AG05_TN01&quot; , &quot;AG05_TN02&quot; ,&quot;AG05_TN03&quot;, &quot;AM16_TN01&quot;, &quot;AM16_TN02&quot;, &quot;AM16_TN03&quot;, &quot;AE10_TN01&quot;, &quot;AE10_TN02&quot; ,&quot;AE10_TN03&quot; )) All_sites %&gt;% mutate(hc = log(height)) %&gt;% dplyr::filter(height &gt; 0 &amp; hr %in% c(1:24) &amp; day %in% c(7) &amp; month %in% c(9)) %&gt;% dplyr::filter(temp &gt; -20) %&gt;% ggplot(aes(y=temp, x = height,color=factor(height))) + geom_point() + geom_smooth(method = &#39;lm&#39;, se = FALSE) + facet_grid(. ~ site, scales = &quot;free&quot;) + theme_minimal() + theme( legend.background = element_rect(color = &quot;grey90&quot;, size = .5, linetype = &quot;dashed&quot;), axis.text.x=element_text(angle=45, hjust=1)) + labs(title=&quot;Variability of temperatures in the understories with height - Sept 7th 2018&quot;,x=&quot;Height (m)&quot;, y=&quot;Temperature(°C)&quot;, tag=&quot;&quot;, colour = &quot;Height&quot;) All_sites %&gt;% mutate(hc = log(height)) %&gt;% dplyr::filter(height &gt; 0 &amp; hr %in% c(1:24) &amp; day %in% c(7) &amp; month %in% c(9)) %&gt;% dplyr::filter(temp &gt; -20) %&gt;% ggplot(aes(y=temp, x = hr,color=factor(height))) + # geom_point() + geom_smooth(method = &#39;loess&#39;, se = FALSE) + facet_grid(. ~ site, scales = &quot;free&quot;) + theme_minimal() + theme( legend.background = element_rect(color = &quot;grey90&quot;, size = .5, linetype = &quot;dashed&quot;), axis.text.x=element_text(angle=45, hjust=1)) + labs(title=&quot;Diurnal Variability of temperatures in the understories with height - Sept 7th 2018&quot;,x=&quot;Hour&quot;, y=&quot;Temperature(°C)&quot;, tag=&quot;&quot;, colour = &quot;Height&quot;) Is the vertical difference in temp significant ? Lets visualize the plot All_sites_odata_filter &lt;- All_sites_odata %&gt;% mutate(hc = as.factor(height)) %&gt;% dplyr::filter(height &gt; 0) %&gt;% dplyr::filter(y &gt; -20) %&gt;% as.data.frame() reg_all &lt;- lm(y ~ height,data=All_sites_odata_filter) summary(reg_all) ## ## Call: ## lm(formula = y ~ height, data = All_sites_odata_filter) ## ## Residuals: ## Min 1Q Median 3Q Max ## -2.8436 -1.3134 -0.2192 1.7059 3.1144 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 9.3511 0.5946 15.726 &lt;2e-16 *** ## height -0.1818 0.7326 -0.248 0.805 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 1.67 on 45 degrees of freedom ## Multiple R-squared: 0.001367, Adjusted R-squared: -0.02083 ## F-statistic: 0.06158 on 1 and 45 DF, p-value: 0.8051 So, the difference in temp at differnt heights not signifcant So, lets see if at two heights , is it relevant (0.3 and 1.2) All_sites_odata_filter_height &lt;- All_sites_odata %&gt;% mutate(hc = as.factor(height)) %&gt;% dplyr::filter(height &gt; 0 &amp; height %in% c(0.3,1.2)) %&gt;% dplyr::filter(y &gt; -20) %&gt;% as.data.frame() reg_all_height &lt;- lm(y ~ height,data=All_sites_odata_filter_height) summary(reg_all_height) ## ## Call: ## lm(formula = y ~ height, data = All_sites_odata_filter_height) ## ## Residuals: ## Min 1Q Median 3Q Max ## -2.9091 -1.3841 -0.3997 1.6528 2.5243 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 9.37822 0.71522 13.112 1.4e-11 *** ## height -0.05403 0.83389 -0.065 0.949 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 1.798 on 21 degrees of freedom ## Multiple R-squared: 0.0001999, Adjusted R-squared: -0.04741 ## F-statistic: 0.004198 on 1 and 21 DF, p-value: 0.9489 Look at how Gaps compare across elevations #Combine all the nodes All_sites_odata_canopy &lt;- All_sites %&gt;% dplyr::group_by(site, canopy) %&gt;% dplyr::summarise(new = list(mean_se(temp))) %&gt;% unnest(new) All_sites_odata_canopy$elevation &lt;- 0 All_sites_odata_canopy[All_sites_odata_canopy$site == &#39;TO04_TN01&#39;,]$elevation&lt;- 680 All_sites_odata_canopy[All_sites_odata_canopy$site == &#39;TO04_TN02&#39;,]$elevation&lt;- 680 All_sites_odata_canopy[All_sites_odata_canopy$site == &#39;TO04_TN03&#39;,]$elevation&lt;- 680 All_sites_odata_canopy[All_sites_odata_canopy$site == &#39;AG05_TN01&#39;,]$elevation&lt;- 900 All_sites_odata_canopy[All_sites_odata_canopy$site == &#39;AG05_TN02&#39;,]$elevation&lt;- 900 All_sites_odata_canopy[All_sites_odata_canopy$site == &#39;AG05_TN03&#39;,]$elevation&lt;- 900 All_sites_odata_canopy[All_sites_odata_canopy$site == &#39;AM16_TN01&#39;,]$elevation&lt;- 1200 All_sites_odata_canopy[All_sites_odata_canopy$site == &#39;AM16_TN02&#39;,]$elevation&lt;- 1200 All_sites_odata_canopy[All_sites_odata_canopy$site == &#39;AM16_TN03&#39;,]$elevation&lt;- 1200 All_sites_odata_canopy[All_sites_odata_canopy$site == &#39;AE10_TN01&#39;,]$elevation&lt;- 1450 All_sites_odata_canopy[All_sites_odata_canopy$site == &#39;AE10_TN02&#39;,]$elevation&lt;- 1450 All_sites_odata_canopy[All_sites_odata_canopy$site == &#39;AE10_TN03&#39;,]$elevation&lt;- 1450 All_sites_odata_canopy$site&lt;- factor(All_sites_odata_canopy$site, levels = c(&quot;TO04_TN01&quot;, &quot;TO04_TN02&quot;, &quot;TO04_TN03&quot;, &quot;AG05_TN01&quot; , &quot;AG05_TN02&quot; ,&quot;AG05_TN03&quot;, &quot;AM16_TN01&quot;, &quot;AM16_TN02&quot;, &quot;AM16_TN03&quot;, &quot;AE10_TN01&quot;, &quot;AE10_TN02&quot; ,&quot;AE10_TN03&quot; )) All_sites_odata_canopy %&gt;% dplyr::filter(y &gt; -20) %&gt;% ggplot(aes(site, y = y, fill = canopy)) + geom_col(position = &quot;dodge&quot;) + facet_grid(. ~ elevation, scales = &quot;free&quot;) + theme_minimal() + theme( legend.background = element_rect(color = &quot;grey90&quot;, size = .5, linetype = &quot;dashed&quot;), axis.text.x=element_text(angle=45, hjust=1)) + geom_errorbar(aes(ymin = ymin, ymax = ymax), position = &quot;dodge&quot;) + scale_fill_manual(&quot;Type&quot;, labels = c(&quot;Open&quot;, &quot;Closed&quot;), values=c(&quot;Open&quot;=1,&quot;Closed&quot;=2) ) + labs(title=&quot;Variability of temperatures in the understories (Gap vs Non Gap)&quot;,x=&quot;Site&quot;, y=&quot;Temperature(°C)&quot;, tag=&quot;&quot;, colour = &quot;Canopy&quot;) Very close, is it significant ? All_sites_odata_canopy_filter &lt;- All_sites_odata_canopy %&gt;% dplyr::filter(y &gt; -20) %&gt;% as.data.frame() reg_all_canopy &lt;- lm(y ~ elevation + canopy ,data=All_sites_odata_canopy_filter) summary(reg_all_canopy) ## ## Call: ## lm(formula = y ~ elevation + canopy, data = All_sites_odata_canopy_filter) ## ## Residuals: ## Min 1Q Median 3Q Max ## -0.7039 -0.3317 -0.1295 0.3520 0.9986 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 14.7380226 0.6723109 21.921 1.98e-08 *** ## elevation -0.0050539 0.0006085 -8.306 3.33e-05 *** ## canopyOpen -0.7660311 0.3813530 -2.009 0.0794 . ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 0.5509 on 8 degrees of freedom ## Multiple R-squared: 0.8962, Adjusted R-squared: 0.8702 ## F-statistic: 34.53 on 2 and 8 DF, p-value: 0.0001161 How about changes in elevation because of canopy ? All_sites_odata_canopy_filter &lt;- All_sites_odata_canopy %&gt;% dplyr::filter(y &gt; -20) %&gt;% as.data.frame() reg_all_canopy &lt;- lm(y ~ elevation * canopy ,data=All_sites_odata_canopy_filter) summary(reg_all_canopy) ## ## Call: ## lm(formula = y ~ elevation * canopy, data = All_sites_odata_canopy_filter) ## ## Residuals: ## Min 1Q Median 3Q Max ## -0.27886 -0.22793 -0.18959 0.08614 1.06496 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 14.2923986 0.6536613 21.865 1.06e-07 *** ## elevation -0.0046325 0.0005958 -7.775 0.000109 *** ## canopyOpen 1.6378303 1.4271211 1.148 0.288820 ## elevation:canopyOpen -0.0025346 0.0014612 -1.735 0.126392 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 0.4925 on 7 degrees of freedom ## Multiple R-squared: 0.9274, Adjusted R-squared: 0.8963 ## F-statistic: 29.8 on 3 and 7 DF, p-value: 0.0002332 Nada How about just canopy All_sites_odata_canopy_filter &lt;- All_sites_odata_canopy %&gt;% dplyr::filter(y &gt; -20) %&gt;% as.data.frame() reg_all_canopy &lt;- lm(y ~ canopy ,data=All_sites_odata_canopy_filter) summary(reg_all_canopy) ## ## Call: ## lm(formula = y ~ canopy, data = All_sites_odata_canopy_filter) ## ## Residuals: ## Min 1Q Median 3Q Max ## -2.0971 -1.1924 0.4897 1.5175 1.7946 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 9.3936 0.5696 16.491 4.94e-08 *** ## canopyOpen -0.1048 1.0908 -0.096 0.926 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 1.611 on 9 degrees of freedom ## Multiple R-squared: 0.001025, Adjusted R-squared: -0.11 ## F-statistic: 0.009234 on 1 and 9 DF, p-value: 0.9256 All_sites_odata_canopy %&gt;% dplyr::filter(y &gt; -20) %&gt;% ggplot() + aes(elevation,y,color=canopy) + geom_point() + geom_smooth(method = &#39;auto&#39;, se = FALSE) + scale_color_manual(&quot;&quot;, labels = c(&quot;Dense Canopy&quot;, &quot;Gap&quot;), # values=c(&quot;Open&quot;=1,&quot;Closed&quot;=2) )+ values= c(&quot;green&quot;, &quot;orange&quot;) ) + labs(title=&quot;Variability of temperatures in Gap vs Dense Canopy&quot;,x=&quot;Elevation (m)&quot;, y=&quot;Temperature(°C)&quot;, tag=&quot;&quot;, colour = &quot;&quot;) ## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39; 8.44 3-21-2019 All_sites %&gt;% mutate(hc = log(height)) %&gt;% dplyr::filter(height &gt; 0 &amp; hr %in% c(1:24) &amp; month %in% c(9)) %&gt;% dplyr::filter(temp &gt; -20) %&gt;% ggplot(aes(canopy, height, fill = temp)) + geom_tile(colour = &quot;white&quot;) + facet_grid(day~hr) + scale_fill_gradient(low=&quot;green&quot;, high=&quot;red&quot;) + labs(x=&quot;Canopy&quot;, y=&quot;&quot;, title = &quot;Time-Series Heatmap&quot;, subtitle=&quot;Gap-Non Gap Analysis&quot;, fill=&quot;Temperature(°C)&quot;) + theme_minimal() + theme( legend.background = element_rect(color = &quot;grey90&quot;, size = .5, linetype = &quot;dashed&quot;), axis.text.x=element_text(angle=45, hjust=1)) Todo - Diel temperature variation in gaps and non-gaps. Lets look at temperature variation at library(gganimate) ## ## Attaching package: &#39;gganimate&#39; ## The following object is masked from &#39;package:raster&#39;: ## ## animate library(av) library(gifski) animate_allsites &lt;- All_sites %&gt;% mutate(hc = log(height)) %&gt;% dplyr::filter(height &gt; 0 &amp; hr %in% c(1:24) &amp; month %in% c(9)) %&gt;% dplyr::filter(temp &gt; -20) %&gt;% as.data.frame() plot_allsites &lt;- ggplot(animate_allsites,aes(y=temp, x = hr,color=factor(height))) + # geom_point() + geom_smooth(method = &#39;loess&#39;, se = FALSE) + facet_grid(. ~ site, scales = &quot;free&quot;) + theme_minimal() + theme( legend.background = element_rect(color = &quot;grey90&quot;, size = .5, linetype = &quot;dashed&quot;), axis.text.x=element_text(angle=45, hjust=1)) + labs(title=&quot;Diurnal Variability of temperatures in the understories with height - {current_frame} Sept 2018&quot;,x=&quot;Hour&quot;, y=&quot;Temperature(°C)&quot;, tag=&quot;&quot;, colour = &quot;Height&quot;) anim_pp &lt;- plot_allsites + transition_manual(day) +ease_aes(&#39;cubic-in-out&#39;) + enter_fade() + exit_shrink() animate( anim_pp + enter_fade() + exit_fly(y_loc = 1), renderer = av_renderer() ) ## nframes and fps adjusted to match transition All_sites %&gt;% mutate(hc = log(height)) %&gt;% dplyr::filter(height &gt; 0 &amp; hr %in% c(1:24) &amp; day %in% c(10) &amp; month %in% c(9)) %&gt;% dplyr::filter(temp &gt; -20) %&gt;% ggplot(aes(y=temp, x = hr,color=factor(height))) + # geom_point() + geom_smooth(method = &#39;loess&#39;, se = FALSE) + facet_grid(. ~ site, scales = &quot;free&quot;) + theme_minimal() + theme( legend.background = element_rect(color = &quot;grey90&quot;, size = .5, linetype = &quot;dashed&quot;), axis.text.x=element_text(angle=45, hjust=1)) + labs(title=&quot;Diurnal Variability of temperatures in the understories with height - Sept 7th 2018&quot;,x=&quot;Hour&quot;, y=&quot;Temperature(°C)&quot;, tag=&quot;&quot;, colour = &quot;Height&quot;) ## 5-23-2019 Max Temperatures library(tidyverse) All_sites %&gt;% mutate(hc = log(height)) %&gt;% dplyr::filter(height &gt; 0 &amp; hr %in% c(1:24)) %&gt;% dplyr::filter(temp &gt; -20) %&gt;% dplyr::group_by(canopy,month,day) %&gt;% dplyr::summarise(min_temp= min(temp), max_temp = max(temp), mean_temp = mean(temp)) %&gt;% dplyr::mutate(dt_d = lubridate::ymd(paste(&#39;2018&#39;,month,day,sep = &#39;-&#39;))) %&gt;% ggplot(aes(y=max_temp, x = dt_d ,color=canopy)) + geom_point() + geom_line() + theme_minimal() + theme( legend.background = element_rect(color = &quot;grey90&quot;, size = .5, linetype = &quot;dashed&quot;), axis.text.x=element_text(angle=45, hjust=1)) + labs(title=&quot;Max temperature between open and dense canopies&quot;,x=&quot;Hour&quot;, y=&quot;Temperature(°C)&quot;, tag=&quot;&quot;, colour = &quot;&quot;) Min library(tidyverse) All_sites %&gt;% mutate(hc = log(height)) %&gt;% dplyr::filter(height &gt; 0 &amp; hr %in% c(1:24)) %&gt;% dplyr::filter(temp &gt; -20) %&gt;% dplyr::group_by(canopy,month,day) %&gt;% dplyr::summarise(min_temp= min(temp), max_temp = max(temp), mean_temp = mean(temp)) %&gt;% dplyr::mutate(dt_d = lubridate::ymd(paste(&#39;2018&#39;,month,day,sep = &#39;-&#39;))) %&gt;% ggplot(aes(y=min_temp, x = dt_d ,color=canopy)) + geom_point() + geom_line() + theme_minimal() + theme( legend.background = element_rect(color = &quot;grey90&quot;, size = .5, linetype = &quot;dashed&quot;), axis.text.x=element_text(angle=45, hjust=1)) + labs(title=&quot;Min temperature between open and dense canopies&quot;,x=&quot;Hour&quot;, y=&quot;Temperature(°C)&quot;, tag=&quot;&quot;, colour = &quot;&quot;) Mean library(tidyverse) All_sites %&gt;% mutate(hc = log(height)) %&gt;% dplyr::filter(height &gt; 0 &amp; hr %in% c(1:24)) %&gt;% dplyr::filter(temp &gt; -20) %&gt;% dplyr::group_by(canopy,month,day) %&gt;% dplyr::summarise(min_temp= min(temp), max_temp = max(temp), mean_temp = mean(temp)) %&gt;% dplyr::mutate(dt_d = lubridate::ymd(paste(&#39;2018&#39;,month,day,sep = &#39;-&#39;))) %&gt;% ggplot(aes(y=mean_temp, x = dt_d ,color=canopy)) + geom_point() + geom_line() + theme_minimal() + theme( legend.background = element_rect(color = &quot;grey90&quot;, size = .5, linetype = &quot;dashed&quot;), axis.text.x=element_text(angle=45, hjust=1)) + labs(title=&quot;Mean temperature between open and dense canopies&quot;,x=&quot;Hour&quot;, y=&quot;Temperature(°C)&quot;, tag=&quot;&quot;, colour = &quot;&quot;) Violin plot - With significance test library(ggpubr) allsites_sigf &lt;- All_sites %&gt;% mutate(hc = log(height)) %&gt;% dplyr::filter(height &gt; 0 &amp; hr %in% c(1:24)) %&gt;% dplyr::filter(temp &gt; -20) %&gt;% dplyr::group_by(canopy,month,day) %&gt;% dplyr::summarise(min_temp= min(temp), max_temp = max(temp), mean_temp = mean(temp)) %&gt;% dplyr::mutate(dt_d = lubridate::ymd(paste(&#39;2018&#39;,month,day,sep = &#39;-&#39;))) %&gt;% as.data.frame() my_comparisons &lt;- list( c(&quot;Closed&quot;, &quot;Open&quot;) ) ggviolin(allsites_sigf, x = &quot;canopy&quot;, y = &quot;mean_temp&quot;, fill = &quot;canopy&quot;, palette = c(&quot;#00AFBB&quot;,&quot;#E7B800&quot;), add = &quot;boxplot&quot;, add.params = list(fill = &quot;white&quot;))+ stat_compare_means(comparisons = my_comparisons, label = &quot;p.signif&quot;)+ # Add significance levels stat_compare_means(label.y = 50) + labs(title=&quot;Mean temperature between open and dense canopies&quot;,x=&quot;Hour&quot;, y=&quot;Temperature(°C)&quot;, tag=&quot;&quot;, colour = &quot;&quot;) my_comparisons &lt;- list( c(&quot;Closed&quot;, &quot;Open&quot;) ) ggviolin(allsites_sigf, x = &quot;canopy&quot;, y = &quot;min_temp&quot;, fill = &quot;canopy&quot;, palette = c(&quot;#00AFBB&quot;,&quot;#E7B800&quot;), add = &quot;boxplot&quot;, add.params = list(fill = &quot;white&quot;))+ stat_compare_means(comparisons = my_comparisons, label = &quot;p.signif&quot;)+ # Add significance levels stat_compare_means(label.y = 50) + labs(title=&quot;Min temperature between open and dense canopies&quot;,x=&quot;Hour&quot;, y=&quot;Temperature(°C)&quot;, tag=&quot;&quot;, colour = &quot;&quot;) my_comparisons &lt;- list( c(&quot;Closed&quot;, &quot;Open&quot;) ) ggviolin(allsites_sigf, x = &quot;canopy&quot;, y = &quot;max_temp&quot;, fill = &quot;canopy&quot;, palette = c(&quot;#00AFBB&quot;,&quot;#E7B800&quot;), add = &quot;boxplot&quot;, add.params = list(fill = &quot;white&quot;))+ stat_compare_means(comparisons = my_comparisons, label = &quot;p.signif&quot;)+ # Add significance levels stat_compare_means(label.y = 50) + labs(title=&quot;Max temperature between open and dense canopies&quot;,x=&quot;Hour&quot;, y=&quot;Temperature(°C)&quot;, tag=&quot;&quot;, colour = &quot;&quot;) Check by elevation allsites_sigf_site &lt;- All_sites %&gt;% mutate(hc = log(height)) %&gt;% dplyr::filter(height &gt; 0 &amp; hr %in% c(1:24)) %&gt;% dplyr::filter(temp &gt; -20) %&gt;% dplyr::group_by(site,canopy,month,day) %&gt;% dplyr::summarise(min_temp= min(temp), max_temp = max(temp), mean_temp = mean(temp)) %&gt;% dplyr::mutate(dt_d = lubridate::ymd(paste(&#39;2018&#39;,month,day,sep = &#39;-&#39;))) %&gt;% as.data.frame() model = lm(max_temp ~ site + canopy + site:canopy, data = allsites_sigf_site) summary(model) ## ## Call: ## lm(formula = max_temp ~ site + canopy + site:canopy, data = allsites_sigf_site) ## ## Residuals: ## Min 1Q Median 3Q Max ## -10.797 -4.277 -1.659 3.501 22.084 ## ## Coefficients: (11 not defined because of singularities) ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 17.0813 1.2909 13.233 &lt;2e-16 *** ## siteTO04_TN02 0.8191 1.8064 0.453 0.6507 ## siteTO04_TN03 1.1084 1.7037 0.651 0.5160 ## siteAG05_TN01 0.7098 1.9482 0.364 0.7160 ## siteAG05_TN02 -2.3266 1.9192 -1.212 0.2268 ## siteAG05_TN03 -1.3438 1.8928 -0.710 0.4785 ## siteAM16_TN01 2.1074 2.5410 0.829 0.4078 ## siteAM16_TN02 -0.9152 1.9482 -0.470 0.6390 ## siteAE10_TN01 -1.6913 1.9801 -0.854 0.3940 ## siteAE10_TN02 -4.4713 1.8685 -2.393 0.0176 * ## siteAE10_TN03 -4.0242 1.8685 -2.154 0.0324 * ## canopyOpen NA NA NA NA ## siteTO04_TN02:canopyOpen NA NA NA NA ## siteTO04_TN03:canopyOpen NA NA NA NA ## siteAG05_TN01:canopyOpen NA NA NA NA ## siteAG05_TN02:canopyOpen NA NA NA NA ## siteAG05_TN03:canopyOpen NA NA NA NA ## siteAM16_TN01:canopyOpen NA NA NA NA ## siteAM16_TN02:canopyOpen NA NA NA NA ## siteAE10_TN01:canopyOpen NA NA NA NA ## siteAE10_TN02:canopyOpen NA NA NA NA ## siteAE10_TN03:canopyOpen NA NA NA NA ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 6.191 on 209 degrees of freedom ## Multiple R-squared: 0.09684, Adjusted R-squared: 0.05363 ## F-statistic: 2.241 on 10 and 209 DF, p-value: 0.01676 "]
]
